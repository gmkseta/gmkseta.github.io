{"componentChunkName":"component---src-templates-post-jsx","path":"/op-ssh/","result":{"data":{"site":{"siteMetadata":{"title":"Seongjun Kim Blog"}},"markdownRemark":{"id":"471fd508-4593-5513-aaed-79bff70247a9","excerpt":"ssh key를 비밀번호 없이 사용하는 경우가 많았다. 혹은 항상 쓰던 비밀번호를 썼다. 회사, 개인, 사이드플젝, 외주 등 각각 ssh-key를 따로 관리했는데 비밀번호를 안 쓰는 것에 죄책감을 느끼기 시작함 만약 노트북이 열린 채로 털리면 터미널 히스토리 보고 서버 접속 가능할 듯? 1password를 결제해서 쓰고 있는데 1password cli를 …","html":"<ul>\n<li>ssh key를 비밀번호 없이 사용하는 경우가 많았다. 혹은 항상 쓰던 비밀번호를 썼다.</li>\n<li>회사, 개인, 사이드플젝, 외주 등 각각 ssh-key를 따로 관리했는데 비밀번호를 안 쓰는 것에 죄책감을 느끼기 시작함</li>\n<li>만약 노트북이 열린 채로 털리면 터미널 히스토리 보고 서버 접속 가능할 듯?</li>\n<li>1password를 결제해서 쓰고 있는데 1password cli를 사용해서 어떻게 못 할까?</li>\n</ul>\n<p>라는 니즈에서 스크립트를 짜놓고 작년부터 썼는데 이제 글로 옮겨적기</p>\n<h2>1password 란?</h2>\n<ul>\n<li>1password는 패스워드를 관리하는 프로그램이다.</li>\n<li>패스워드 및 각종 신용카드 정보나 민감한 개인 정보들을 관리하고 쉽게 사용할 수 있다.</li>\n<li>mac, window, android, iphone, 크롬 확장프로그램, cli에서도 사용 가능하다.</li>\n<li>모든 사이트의 비밀번호를 다르게 사용해도 1password를 사용해서 auto complete를 할 수 있다.</li>\n</ul>\n<h2>Need to be installed - expect, op</h2>\n<ul>\n<li>1password cli ( op ), jq, expect 가 설치되어있어야 한다.</li>\n</ul>\n<h3>expect</h3>\n<ul>\n<li><strong>macos</strong> - 맥에선 원래 expect가 설치 되어있다. ㅎㅎ</li>\n<li><strong>ubuntu</strong> - <code class=\"language-text\">sudo apt-get install expect</code></li>\n</ul>\n<h3>1password command line</h3>\n<ul>\n<li><a href=\"https://1password.com/downloads/command-line/\">1password cli</a> 에서 설치!</li>\n</ul>\n<h3>jq</h3>\n<ul>\n<li><code class=\"language-text\">brew install jq</code></li>\n</ul>\n<h2>ssh-key 저장해두기</h2>\n<ol>\n<li>비밀번호를 굉장히 복잡하게 설정하거나 1password으로 만들어냅니다.</li>\n<li><code class=\"language-text\">ssh-keygen</code> 을 통해 ssh-key를 하나 생성하고 비밀번호를 1.의 비밀번호로 설정합니다.</li>\n<li>\n<p>1password에 저장합니다.</p>\n<ul>\n<li>public key와 private key도 저장해두면 pc가 뿌셔져도 괜찮습니다.</li>\n<li><strong>tags를 꼭 ssh-key 로 해둡니다.</strong></li>\n</ul>\n</li>\n</ol>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/373f7f610b98e04f0b66bae7eb741b5c/79586/2021-12-05-20-09-58.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 90.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAADR0lEQVQ4y6VUyW7TQBh2SZpuHBASdEkTxx5v493O2jpbl7RFRRQkrlhCQlzLnUfgAeABOLdISJxB4sKTVDkhcQPG/vlnmpQuBw5E+hTHnnzzLf9Ykgq1UkK1xxaVn1fW1FRXjJSafuracerQEK+DVCdOSnU7dUw7JTU9JbKeajUjNVQrpYbzzDbcF5ZuD3b7+xJ+inLSaH7vdnsQujHgIjAUAoFtQ933wTUMIJUKtFsJuDQGzw6gEbbAtTxAUjAJFdAU4ysASNLcjES8sH3WS/aQoP5bLhO2NdxmD4+eMpkOmeIM2brZY82owY7TQ9ZptFnkNxg6QZgMSX/hNyhV8gXVFaTZ4hwJ7GCctBMI3DirldW8++Q4H7w6yZeOPuQLj07z4v77vLUxyt+9eZknnc089ps5kuTohoNxV0TWzgkLt4ok8urj7cEudBqbmbyuwVY3gYPRCKpVFww9AEI8MDUHqO6DbXjAFWGOU3CloE4JS6jQo8G4tzkA3w4zvptJLNBrOpgqZqSaoMkaBE4E2/0RdDs9aNc3wHdCkXnoxcw1fVCrE8LZQomEbjTeGY6gFXcyHjYSi8BFQQh+TQ0Xy2gLYk6EriD269COOywK61CrqdMMSwQJhELH8jLH9EST1wltQdgBS7Mv7KIq/pxZpg2KMillfm6BIMk49hs8m8yj/g1CbBS/qVDHN3TQInfCN8ENGMV8LywXZooEcxhvtrq4yM84MSe9TEhkA3b6BvQ2bNjuqRC5OJuyNX0uWr4ohWcYOH8tI+kNhdzewS6Fg50EhomKGRJQKqZYw2fxCmFp9rzl7kZflIJqudKrGeJYuKaOJWiwO2zDIOkDd9TD/+CpYedjNCGUpBnSiFrjB3uH0IxaWT1sipHgqv5myNWgiqolZtHDKXB51jTA9h0kvKSQl4IWx3y2MPQMyXOMIEfC6UkQp2J6MrCgHNVfxlXLd+/cVVHuGbeITf3GFhnuzCYLmaFY4sxOMSnhAnjv54TwsyBcmF/UMLMfmJ8YCf4muV7Kv2DiSKGjb4JwafH2vdXl8lvEx9X7ayeVsnwqr9dO8fdpeWVdYG2lLHB+fQMneP/T6vLaayS8xV+IM4gSYuk/UbSILf0BLDa8CC2SAsYAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='2021 12 05 20 09 58' title='2021 12 05 20 09 58' src='/static/373f7f610b98e04f0b66bae7eb741b5c/ca1dc/2021-12-05-20-09-58.png' srcset='/static/373f7f610b98e04f0b66bae7eb741b5c/e7570/2021-12-05-20-09-58.png 170w,\n/static/373f7f610b98e04f0b66bae7eb741b5c/f46e7/2021-12-05-20-09-58.png 340w,\n/static/373f7f610b98e04f0b66bae7eb741b5c/ca1dc/2021-12-05-20-09-58.png 680w,\n/static/373f7f610b98e04f0b66bae7eb741b5c/79586/2021-12-05-20-09-58.png 932w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy'>\n  </a>\n    </span></p>\n<h2>script</h2>\n<ul>\n<li>아래 스크립트를 아무 곳에나 잘 위치 시키고 ( 나는 <code class=\"language-text\">~/.custom/op_ssh.sh</code> 로 해뒀음)</li>\n<li>\n<p>실행 권한을 준다.</p>\n<ul>\n<li><code class=\"language-text\">chmod +x 파일명.sh</code></li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">alias</code> 를 설정한다.</p>\n<ul>\n<li><code class=\"language-text\">alias op_ssh=~/.custom/op_ssh.sh</code></li>\n</ul>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">#!/bin/bash\n\nif [ $# -eq 0 ]; then\n  echo &quot;ssh path 경로 없음&quot;\nelse\n  ssh_path=&quot;${1}&quot;\n  title=&quot;$(echo $ssh_path | tr &#39;/&#39; &#39;\\n&#39; | tail -n1)&quot;\n  uuid=$(op list items --tags ssh-key | jq --arg title &quot;$title&quot; &#39;.[] | select(.overview.title == $title).uuid&#39; | sed -e &#39;s/^&quot;//&#39; -e &#39;s/&quot;$//&#39;)\n  if [ -z &quot;$uuid&quot; ]; then\n    echo &quot;Need 1password Sign In&quot;\n  else\n    password=$(op get item $uuid | jq &#39;.details.sections[1].fields[] | select(.t == &quot;password&quot;).v&#39; | sed -e &#39;s/^&quot;//&#39; -e &#39;s/&quot;$//&#39;)\n    expect &lt;&lt;EOL\n  spawn ssh-add $ssh_path\n  expect &quot;Enter passphrase for *&quot;\n  send &quot;$password&quot;\n  send &quot;\\n&quot;\n  expect &quot;Identity added: *&quot;\nEOL\n  fi\nfi</code></pre></div>\n<h2>사용</h2>\n<ul>\n<li>op cli 로그인을 한다.</li>\n<li>로그인 하고자하는 키의 경로를 매개변수로 두고 커맨드 실행</li>\n</ul>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/171f3c7ee35a98e2681d789dc73cbb64/59080/2021-12-05-20-31-19.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxklEQVQY012Q2w6CMBBEqwISFBF5IPET8AYqbQEtN43x/z9oXIoX4sOk2+72dKbMFgUCIRHIEkFxg5dWmCYFzEOuZcU5pnGB8U6CRSnYhv8UcYy3HBbNO2cF63gB8/MaoWoIdse6fFL9wCprsZQN5mkJO7nA2Gd0UfTAjzQwhbETmJBG1DfpYeZfW4RXhQVXcMmdTyBP1LSv9Pqp3QG8Uw/mGmh2KcidRX3mCIXZKadI4js81GQvyYGk+JmWPvuL332N/Qa+AFrFc+Gw+s4qAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='2021 12 05 20 31 19' title='2021 12 05 20 31 19' src='/static/171f3c7ee35a98e2681d789dc73cbb64/ca1dc/2021-12-05-20-31-19.png' srcset='/static/171f3c7ee35a98e2681d789dc73cbb64/e7570/2021-12-05-20-31-19.png 170w,\n/static/171f3c7ee35a98e2681d789dc73cbb64/f46e7/2021-12-05-20-31-19.png 340w,\n/static/171f3c7ee35a98e2681d789dc73cbb64/ca1dc/2021-12-05-20-31-19.png 680w,\n/static/171f3c7ee35a98e2681d789dc73cbb64/59080/2021-12-05-20-31-19.png 893w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy'>\n  </a>\n    </span></p>\n<h2>next?</h2>\n<ol>\n<li>gist 올려두고 자동화</li>\n<li>1password 비밀번호 입력도 불편하다, touch id로 안 되나?</li>\n</ol>","frontmatter":{"title":"1password + ssh key password","date":"December 05, 2021","update":"December 05, 2021","tags":["linux","terminal"],"series":null},"fields":{"slug":"/op-ssh/","readingTime":{"minutes":1.795}}},"seriesList":{"edges":[{"node":{"id":"15b51d30-c078-53de-a25e-48039f097339","fields":{"slug":"/3-mount/"},"frontmatter":{"title":"Ubuntu 에서 (외장) 하드디스크 사용하기 "}}},{"node":{"id":"ae390cb5-0f32-5525-9ffc-204ebb1321a2","fields":{"slug":"/4-pgconnectbad/"},"frontmatter":{"title":"PG:ConnectionBad - could not connect to server: Connection refused"}}},{"node":{"id":"ecda0f77-0b85-5ca7-b7e1-02b52c277c4d","fields":{"slug":"/23-InfraStructureAsCode/"},"frontmatter":{"title":"Infrastructure as code"}}},{"node":{"id":"0106d6fa-95ca-57ce-b105-a61ccc1bfe48","fields":{"slug":"/26-difference-between-binary-semaphore-and-mutex/"},"frontmatter":{"title":"Binary Semaphore vs Mutex"}}},{"node":{"id":"9b992cd0-63e6-58c6-9932-8635b1c6296f","fields":{"slug":"/sudo-with-touch-id/"},"frontmatter":{"title":"터미널에서 비밀번호 말고 touch id로 sudo 쓰기"}}},{"node":{"id":"8dfb02e2-4517-5ee9-8a31-a3558811607e","fields":{"slug":"/gh-pages-cname/"},"frontmatter":{"title":"gh-pages, custom domain(cname) 적용 안 될 때 (gatsby-gh-pages-action)"}}},{"node":{"id":"471fd508-4593-5513-aaed-79bff70247a9","fields":{"slug":"/op-ssh/"},"frontmatter":{"title":"1password + ssh key password"}}},{"node":{"id":"e310aca0-ac3a-5c50-a84e-cacf6da37a52","fields":{"slug":"/https-and-ssl/"},"frontmatter":{"title":"HTTPS 와 SSL"}}},{"node":{"id":"dd1d3e00-4e08-55dc-9e58-b09bb83c5961","fields":{"slug":"/https-and-ssl-2/"},"frontmatter":{"title":"HTTPS 와 SSL - 2"}}},{"node":{"id":"75217705-7603-5d83-8492-2112ee48b14b","fields":{"slug":"/single-point-of-failure/"},"frontmatter":{"title":"단일 장애 지점(SPOF)이란? Single Point of Failure"}}},{"node":{"id":"1661f2df-49ed-52ff-a108-89ffa05b6889","fields":{"slug":"/rate-limit/"},"frontmatter":{"title":"처리율 제한 Rate Limit"}}}]},"previous":{"fields":{"slug":"/week-48-2021-retrospective/"},"frontmatter":{"title":"48 주차 회고 [2021]"}},"next":{"fields":{"slug":"/https-and-ssl/"},"frontmatter":{"title":"HTTPS 와 SSL"}}},"pageContext":{"id":"471fd508-4593-5513-aaed-79bff70247a9","series":null,"previousPostId":"e0658714-609f-55e5-9763-7cb313d5e021","nextPostId":"e310aca0-ac3a-5c50-a84e-cacf6da37a52"}},"staticQueryHashes":[]}