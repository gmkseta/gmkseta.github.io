<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[RSS Feed of Seongjun Kim Blog]]></title><description><![CDATA[안녕하세요 개발자 김성준입니다.]]></description><link>https://blog.seongjun.kr</link><generator>GatsbyJS</generator><lastBuildDate>Sat, 29 Jan 2022 15:37:03 GMT</lastBuildDate><item><title><![CDATA[처리율 제한 Rate Limit]]></title><description><![CDATA[처리율 제한 장치(rate limiter)란? 클라이언트 또는 서비스가 보내는 트래픽의 처리율을 제어하기 위한 장치이다. 특정 기간 내에 전송되는 클라이언트의 요청 횟수를 제한한다. 요청 횟수가 임계치(threshold…]]></description><link>https://blog.seongjun.kr/rate-limit/</link><guid isPermaLink="false">https://blog.seongjun.kr/rate-limit/</guid><pubDate>Thu, 27 Jan 2022 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;처리율 제한 장치(rate limiter)란?&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;클라이언트 또는 서비스가 보내는 트래픽의 처리율을 제어하기 위한 장치이다.&lt;/li&gt;
&lt;li&gt;특정 기간 내에 전송되는 클라이언트의 요청 횟수를 제한한다.&lt;/li&gt;
&lt;li&gt;요청 횟수가 임계치(threshold)를 넘어서면 추가로 도달한 모든 호출은 처리가 중단(block)된다.&lt;/li&gt;
&lt;li&gt;오픈 API나 외부에 특정 API를 제공하는 서비스의 경우 시간당 몇 회 호출이나 하루에 몇 회 호출 등의 제한을 걸어두곤 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;왜 처리율 제한이 필요한가??&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;DoS(Denial of Service) 공격에 의한 자원 고갈을 방지할 수 있다. 과한 트래픽으로 부터 서비스를 보호한다.&lt;/li&gt;
&lt;li&gt;비용을 절감한다. 추가 요청에 대한 처리를 제한하면 서버를 많이 두지 않아도 되고, 우선순위가 높은 API에 더 많은 자원을 할당할 수 있다.&lt;/li&gt;
&lt;li&gt;초과하는 횟수에 따라 과금하는 비즈니스 모델로 활용이 가능하다.&lt;/li&gt;
&lt;li&gt;서버 과부하를 막는다. 봇애서 오는 트래픽이나 사용자의 잘못된 이용 패턴으로 유발된 트래픽을 걸러내는데 사용 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;처리율 제한 장치의 위치&lt;/h2&gt;
&lt;h3&gt;서버에서의 처리율 제한&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;처리하고자 하는 조건에 따라 서버측에서 제한을 건다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;미들웨어에서의 처리율 제한&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;미들웨어에서 API 서버로 가는 요청을 통제한다.&lt;/li&gt;
&lt;li&gt;요청이 너무 많이오면 429 code (Too many requests)를 리턴해준다.
&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/333dc2330da8567438164c222d2c4c3f/3b5a6/2022-01-28-01-14-01.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 38.23529411764706%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABaUlEQVQoz32RyU4CQRRF+QQXLpCZ7q6i6W6aQcQQwQiiICYyKA4xIGpiBJSt7ogfYIy4wR1+Av7g9XURmSQuXmp6Oe/eWzaJBSFxKjZfSkCD0yvjqFRFNpeH26dA5hr8TJ3v5TNFZ9sUoIMHDcgEsvZMNWB3enHVvEWpcgyH2z+5t1arb1GEALpIxV6hiK/hEJ+DAeKJJGRSoZsxAak3rgl4gpVVO9qdR3yPRqjXm/BKHEEjTBB1zqFQyFQdN3f3aD0/wVhPY6t4Cs0wwYIhgnRxdnGJgGYivZPFbr6MbKUhINbdYmQTy9GNJOKZLHgoBi2ZhqqHwUlFu9VBtXYuenQzQsMjMHMFcBpoAf3LFRpglItCoftkjmq1hte3d/R6L+j3P7B/cCjsW4CAFgIjiLVXyNmfDGcP4heVcX6JZApaKIrOQxdlytDhkcT72OLyD/kD/IX65IAIfc3lQ2o7g02KwCOxKfCf+gHAJ/2Bn7+NJgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 28 01 14 01&apos; title=&apos;2022 01 28 01 14 01&apos; src=&apos;/static/333dc2330da8567438164c222d2c4c3f/ca1dc/2022-01-28-01-14-01.png&apos; srcset=&apos;/static/333dc2330da8567438164c222d2c4c3f/e7570/2022-01-28-01-14-01.png 170w,
/static/333dc2330da8567438164c222d2c4c3f/f46e7/2022-01-28-01-14-01.png 340w,
/static/333dc2330da8567438164c222d2c4c3f/ca1dc/2022-01-28-01-14-01.png 680w,
/static/333dc2330da8567438164c222d2c4c3f/02d09/2022-01-28-01-14-01.png 1020w,
/static/333dc2330da8567438164c222d2c4c3f/3b5a6/2022-01-28-01-14-01.png 1302w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;클라이언트에서의 처리율 제한 장치&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;클라이언트의 요청은 쉽게 위변조가 가능해서 안정적으로 처리율 제한을 걸 수 없다.&lt;/li&gt;
&lt;li&gt;하지만 꼭 클라이언트가 어플이나 브라우저가 아닌 서버일 수 있음 (소비자)&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;제공자는 그냥 거절하면 그만이지만 클라이언트에서는 다양한 방법을 사용 가능&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;다시 요청할 수 있을 때까지 대기&lt;/li&gt;
&lt;li&gt;일정 시간 기다린 후 그때도 통과를 못한다면 타임아웃 처리&lt;/li&gt;
&lt;li&gt;요청 취소&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;처리율 제한 알고리즘&lt;/h2&gt;
&lt;h3&gt;1. Token Bucket&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;토큰 버킷은 지정된 용량을 갖는 컨테이너이고, 이 버킷에는 설정된 양의 토큰이 주기적으로 채워진다.&lt;/li&gt;
&lt;li&gt;토큰이 꽉 차있으면 더 이상 토큰은 추가되지 않는다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;요청이 들어오면 버킷에 토큰이 있는지 확인한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;충분한 토큰이 있으면 하나의 토큰을 버리고 요청을 처리한다.&lt;/li&gt;
&lt;li&gt;토큰이 없으면 요청은 버려진다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 527px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/1cc7996c1013ac315d00112420a7f797/c6c03/2022-01-28-01-53-33.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 57.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAABe0lEQVQoz4WS207CQBCG+zy+jYm+iC+gMfEBvPPGhFuvjDGBaAViYqBCQSDQMwtt6YGlLQotWNhu3VJCQDH8F5vM4ZvM7AwV72q5XEA44oWarLQd6EQIxThRvE/UH0+SZ/QeXKuSGDiK/9dvGEdRGGM13xJzbJ9ueq8ipNvf7nQVwwfg+Wze14R3unB9eXFzfrUMwkG27rDdVd0DcNJkV7yrlU/rzIlhlohpa892P5+OQLRYLDZfsANjjMhrDj4K90dvT8ef4wkxg8DnBY7n+XanI0qSbdmE3wsnJUmsxWaBUk6dCCFd04AiizyvKLJt28SzhvGqm9U68HA4dF13NguWKA7DaPrl+qNena0wVZazRjXVNB2PLI8ozad839d1nTAAAI7jZFmWJKkHFNBXG+UXJnPWYIqPdDFTat1WhFy1CS1T03RVVcfjMbXdMITQsqzUdBwHgO4s8JPLQUiDDrDhJAjWl7A9cxiGJNswDM/zNrXWC4iSufYeyQ88GWomdNw9wgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 28 01 53 33&apos; title=&apos;2022 01 28 01 53 33&apos; src=&apos;/static/1cc7996c1013ac315d00112420a7f797/c6c03/2022-01-28-01-53-33.png&apos; srcset=&apos;/static/1cc7996c1013ac315d00112420a7f797/e7570/2022-01-28-01-53-33.png 170w,
/static/1cc7996c1013ac315d00112420a7f797/f46e7/2022-01-28-01-53-33.png 340w,
/static/1cc7996c1013ac315d00112420a7f797/c6c03/2022-01-28-01-53-33.png 527w&apos; sizes=&apos;(max-width: 527px) 100vw, 527px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;가장 간단하고 보편적으로 쓰인다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;통상적으로 엔드포인트마다 별도의 버킷을 둔다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IP별로 처리율을 제한하고 싶다면 IP주소마다 버킷을 하나씩 할당한다.&lt;/li&gt;
&lt;li&gt;시스템의 처리율을 제한하고 싶다면 모든 요청이 하나의 버킷을 공유하도록 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;버킷의 크기, 토큰 공급률을 인자로 받는다&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;장점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;구현이 쉽다.&lt;/li&gt;
&lt;li&gt;메모리 사용 측면에서도 효율적이다.&lt;/li&gt;
&lt;li&gt;짧은 시간에 집중되는 트래픽도 처리 가능하다. 버킷에 남은 토큰이 있기만 하면 요청은 시스템에 전달된다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;단점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;버킷의 크기와 토큰 공급률이라는 인자를 적절하게 튜닝하는게 까다롭다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;2. Leaky Bucket&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;요청이 도착하면 큐가 가득 차 있는지 본다. 빈 자리가 있는 경우에는 큐에 요청을 추가한다.&lt;/li&gt;
&lt;li&gt;큐가 가득 차 있는 경우에는 새 요청은 버린다.&lt;/li&gt;
&lt;li&gt;지정된 시간마다 큐에서 요청을 꺼내어 처리한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 573px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c976af7710e154f9f8207106653cc4a2/f5c00/2022-01-28-02-35-24.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAACP0lEQVQoz11Sy27TUBDNH/R3yi8gIVYsUNUIqoAQK1giJMprgRASCJZlhfIBCLWblkoWhKICpWpIaWw3jWOTxI1fiR3f3PdwbSdp4Ui+Gs3MmTnjmZKUEgBqtZppmsqQ/yLzJPHpqRPaR9Lt/RcqqS9N04WFhUqlomxKKcwhpQAJI3xrfeXSxkXgwCVXNJ4jIwdB4DhOtVrVNE3Zg8EgjuMwDKMcTHCgUN5cWty4oLK54EXPAiXV1vM8VQljrDhuv9/tdnVdb7VOLKtNBYMJXF2/svghIwsQnJGoezyOBlPZhVopBOFiOMFwDipbqb1fu7eslYGpQcBw9eX3l599Ws3I8+mzEkJGhM/mzf15hHrDgWl3GvWeqZ/8qjumgfo94HzWWdCUjSOStONIGQlLmBKcdcrYKE1a7Vbr+PiP49i2bZoGY3QqO8CBj33EUULTEUnHNEUMediLSFSURgOXUlbImY4jxJQcktAYGVRgCUwCUS8SE3NkzsmxbcUo04IZJoISEEzmqyqEuch/V99/tV17o+283K69/qx5k3DeCvk+JbP9KwdSBzA7kiJj79Re+/7z7d7B2o/9Hcs4+2cAfr/zfPfF6teHj3efPtl59GDz7qHbOFvV9BJBeBRJyC5BLY8QtbtMXhC6dz7evqFdu7lZXtkqX99a+mZ9OSMXYEIGWAjOm82jo2azXj8YjuK8NGB3jDpRYvlJJ5xYvsw3WhqfQ5Ik2TNO0AxpOg05brehHzbbht42G8bvaDRUp/kXPe3/axeybU4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 28 02 35 24&apos; title=&apos;2022 01 28 02 35 24&apos; src=&apos;/static/c976af7710e154f9f8207106653cc4a2/f5c00/2022-01-28-02-35-24.png&apos; srcset=&apos;/static/c976af7710e154f9f8207106653cc4a2/e7570/2022-01-28-02-35-24.png 170w,
/static/c976af7710e154f9f8207106653cc4a2/f46e7/2022-01-28-02-35-24.png 340w,
/static/c976af7710e154f9f8207106653cc4a2/f5c00/2022-01-28-02-35-24.png 573w&apos; sizes=&apos;(max-width: 573px) 100vw, 573px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;토큰 버킷 알고리즘과 비슷하지만 요청 처리율이 고정되어있다.&lt;/li&gt;
&lt;li&gt;보통 FIFO로 구현한다.&lt;/li&gt;
&lt;li&gt;버킷 크기, 처리율을 인자로 받는다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;장점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;큐의 크기가 제한되어 있어 사용량 측면에서 효율적이다.&lt;/li&gt;
&lt;li&gt;고정된 처리율을 갖고 있으므로 안정적인 출력이 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;단점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;단시간에 많은 트래픽이 몰리는 경우 큐에는 오래된 요청들이 쌓이게 되고, 그 요청들을 제때 처리 못하면 최신 요청들이 버려진다.&lt;/li&gt;
&lt;li&gt;버킷 크기, 처리율을 튜닝하기 까다롭다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;3. Fixed Window Counter&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;타임라인을 고정된 간격의 window로 나누고 각 window마다 counter 를 붙인다.&lt;/li&gt;
&lt;li&gt;요청이 접수될 때마다 이 counter값은 1씩 증가한다.&lt;/li&gt;
&lt;li&gt;이 counter 값이 threshold 에 도달하면 새로운 요청은 새 윈도가 열릴 때까지 버려진다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/dba47f04028679510399b1455fbdd827/0ea77/2022-01-28-03-00-13.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 43.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABLElEQVQoz42SwU6EMBCGeUpfwLNPsWdvPoEnE5/BaOJBjYeNXjSc3C0babelsMBCS+G3BdkAi1kn/ClM04+Zf+rBRtM06NeD3DdOR3+2D++vDZQlmuUbTByDS4nYSlqlaQrOOZIkQV3XR2e9YcIYA601dG1gshx4tUARYROGCIIAlNIWSghBaHMngaWtKrEV5bsMK7bB4uUa74GPiHEwxlqgk6uwKIqRVWOgc6t7YJrur9syxsXTFT7lGhHlIAFpoa5Vp6HnRx7Wv5Bn+oHzx0tIlWK7j3F2v8CS+eAbihVZH1oWQmA6zAmwS3ztQtz4d8h0gdzq1n9AmAmofdEOw7WplGo1O8iph7pUkN8cynppqgoJFaiU/td1mQW6tW/fvTs/nb+j+znwbQ76A0o0uhLEjHqxAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 28 03 00 13&apos; title=&apos;2022 01 28 03 00 13&apos; src=&apos;/static/dba47f04028679510399b1455fbdd827/ca1dc/2022-01-28-03-00-13.png&apos; srcset=&apos;/static/dba47f04028679510399b1455fbdd827/e7570/2022-01-28-03-00-13.png 170w,
/static/dba47f04028679510399b1455fbdd827/f46e7/2022-01-28-03-00-13.png 340w,
/static/dba47f04028679510399b1455fbdd827/ca1dc/2022-01-28-03-00-13.png 680w,
/static/dba47f04028679510399b1455fbdd827/0ea77/2022-01-28-03-00-13.png 682w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c10fe531c043135f1ef95137823d76c4/aa4b8/2022-01-29-22-12-32.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 72.35294117647058%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABvklEQVQ4y5WTCXObMBCF8///V2Z6ZOI4TpzxUdvBF2CMACFxCb4Kh7Q+UifdGSENe2jf09sbOmua5rBXZYlar8iWS7S3gGKLThzcaIOXuKwDwV427CJNXdcnua3dHBc8/LZB8umR+McdpfMAqk8e9xn7L4zsmniCqVezDqs/hf5dsHNImRKke9orjmI5R3N+vijYWtlClpJUx2glrcOQ55q8yClNSaosVBuqdWbBmOsdHhBXFbLfI/n2nXz2E9J7VHjHcDtg6D7xvNoxdmsWfm5zrnDIEeRs5xPO51TSty0HmCIgygRCh8S6IFI1Km+OqLoCud3be0WhEKV66/qUwW6vP3+UA4dFQWplU26sXLzXg2xU7OBFW3zpsd6FhGmDLxTGmK/JJh302d/eUix7Fv8juegx8p55sWvshoy3hpWVzXu3H3N45ijt4yjfp47Ehaz+SzYtjJaz9v5k4WA23huHHZFNJ5XaVJ9PyvvoJdMJajRCuxPKbEYSDHH2cxzxyswN2IqGTaC+OHpWW3o8Iu49kC8H6ODejt6Q+X7Kr2DCIoiZ7wxubC6oOC3YfU95rK3mJJmdkA8G8Cj2b85vRfRDQ9t6VTsAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 29 22 12 32&apos; title=&apos;2022 01 29 22 12 32&apos; src=&apos;/static/c10fe531c043135f1ef95137823d76c4/ca1dc/2022-01-29-22-12-32.png&apos; srcset=&apos;/static/c10fe531c043135f1ef95137823d76c4/e7570/2022-01-29-22-12-32.png 170w,
/static/c10fe531c043135f1ef95137823d76c4/f46e7/2022-01-29-22-12-32.png 340w,
/static/c10fe531c043135f1ef95137823d76c4/ca1dc/2022-01-29-22-12-32.png 680w,
/static/c10fe531c043135f1ef95137823d76c4/aa4b8/2022-01-29-22-12-32.png 995w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;매 초마다 할당량 이상이 오면 초과분은 버려진다.&lt;/li&gt;
&lt;li&gt;이 알고리즘의 가장 큰 문제는 경계 시간대에 몰리면 window에 할당된 양보다 더 많은 요청이 처리될 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;장점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;메모리 효율이 좋다.&lt;/li&gt;
&lt;li&gt;이해하기 쉽다.&lt;/li&gt;
&lt;li&gt;window가 닫히는 시점에 카운터를 초기화하는 방식은 특정한 트래픽 패턴을 처리하기에 적합하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;단점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;경계에서 일시적으로 많은 트래픽이 몰리는 경우 기대했던 시스템의 처리 한도보다 많은 양의 요청을 처리해야한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;4. Sliding Window Log&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;요청의 타임스탬프를 레디스의 sorted set같은 캐시에 보관한다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;새 요청이 오면 만료된 타임스탬프는 제거한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;만료된 타임스탬프는 그 값이 현재 윈도의 시작 시점보다 오래된 타임스탬프를 말한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;새 요청의 타임스탬프를 로그에 추가한다.&lt;/li&gt;
&lt;li&gt;로그의 크기가 허용치보다 같거나 작으면 요청을 시스템에 전달한다. 그렇지 않은 경우에는 처리를 거부한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/d9f10adf306f051c11bde8d24bd2f0b7/95234/2022-01-29-22-14-39.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 26.47058823529412%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAtUlEQVQY03VQWw7EIAjs/a/ZfmwTW9/aKjoLJt10X5MQwgjjwARG7x2fuLhSCpxzsNbiOA786r/X01VIbtRgjIH3fnA5Z2itQUSgWrHv++AEj3XFsixorb2JvgQrVWxmQwgBOSXEFGGsGc6Ih4jbRDzxm8AqBcWC9E9Qci55ZAkdNHz0kOfMjvU8I7K7k9dOOcHzR4Hjy+G96K2j8moSwo1VeaCySOU7knCVoJwaoiffV3ruGk9+/og/7URqcgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 29 22 14 39&apos; title=&apos;2022 01 29 22 14 39&apos; src=&apos;/static/d9f10adf306f051c11bde8d24bd2f0b7/ca1dc/2022-01-29-22-14-39.png&apos; srcset=&apos;/static/d9f10adf306f051c11bde8d24bd2f0b7/e7570/2022-01-29-22-14-39.png 170w,
/static/d9f10adf306f051c11bde8d24bd2f0b7/f46e7/2022-01-29-22-14-39.png 340w,
/static/d9f10adf306f051c11bde8d24bd2f0b7/ca1dc/2022-01-29-22-14-39.png 680w,
/static/d9f10adf306f051c11bde8d24bd2f0b7/02d09/2022-01-29-22-14-39.png 1020w,
/static/d9f10adf306f051c11bde8d24bd2f0b7/95234/2022-01-29-22-14-39.png 1079w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;3의 경계에 편향한 트래픽에서의 문제를 대응하기 위한 알고리즘이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;장점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;어느 순간의 윈도를 보더라도 허용되는 요청의 개수는 시스템의 처리율 한도를 넘지 않는다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;단점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;각 요청에 대한 타임스탬프를 보관하기 때문에 메모리를 많이 사용한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;5. Sliding Window Counters&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;현재 윈도에서의 요청 수 + 직전 윈도에서의 요청 수 * 이동 윈도와 겹치는 비율&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/fba85e1e8786931e8c5ae6b4c40eb41e/78d47/2022-01-30-00-05-46.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 34.11764705882353%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuElEQVQoz5VRQQ6CMBD0/6/SBOPBhMSDB0kkHkgRPCi0hTZtdyxGoKIkMkmz7ezsdNtdIQARDfFjdaRzoMd9PL9zU6ymRCiioEgLgVsU/dTNGoYdSikHvmlaKG2gfVr6vbV21vTLsBeVVYGEnXAuU2T5EXVxgKkTKJ7BBRf/bXitc+ySLfaXGKyMIdkGnK19u+lotsTQOQshOYwz4KKCakXHgjy/aCig8Smt/y9j7Csqrfv07EA6PAGxgCbiZj0MHwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 30 00 05 46&apos; title=&apos;2022 01 30 00 05 46&apos; src=&apos;/static/fba85e1e8786931e8c5ae6b4c40eb41e/ca1dc/2022-01-30-00-05-46.png&apos; srcset=&apos;/static/fba85e1e8786931e8c5ae6b4c40eb41e/e7570/2022-01-30-00-05-46.png 170w,
/static/fba85e1e8786931e8c5ae6b4c40eb41e/f46e7/2022-01-30-00-05-46.png 340w,
/static/fba85e1e8786931e8c5ae6b4c40eb41e/ca1dc/2022-01-30-00-05-46.png 680w,
/static/fba85e1e8786931e8c5ae6b4c40eb41e/78d47/2022-01-30-00-05-46.png 800w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;고정 윈도 카운터 알고리즘과 슬라이딩 윈도를 결합한 알고리즘&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;장점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;이전 시간대의 평균 처리율에 따라 현재 윈도의 상태를 계산하므로 짧은 시간에 몰리는 트래픽에도 잘 대응한다.&lt;/li&gt;
&lt;li&gt;메모리 효율이 좋다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;단점&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;직전시간대에 도착한 요청이 균등하게 분포되어 있다고 가정한 상태에서 추정치를 계산하므로 다소 느슨하다.&lt;/li&gt;
&lt;li&gt;하지만 그렇게 심각한 문제는 아님&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Redis를 이용한 구현 생각해보기&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;특정 기간에 n회 라는 제한&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;api가 여러개라면 api의 종류를 key로 넣는다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;api:posts&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;유저별로 개수를 제한한다면 user id 를 넣는다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;api:posts:123 &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;특정 기간의정보. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;윈도를 어떻게 설정할 것이냐에 따라 키가 달라짐&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;5분마다 n회라면?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;api:posts:123:202201271005&lt;/li&gt;
&lt;li&gt;api:posts:123:202201271010&lt;/li&gt;
&lt;li&gt;api:posts:123:202201271015&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;value 는 호출 수&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://engineering.linecorp.com/ko/blog/high-throughput-distributed-rate-limiter/&quot;&gt;https://engineering.linecorp.com/ko/blog/high-throughput-distributed-rate-limiter/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://dev.to/swyx/networking-essentials-rate-limiting-and-traffic-shaping-43ii&quot;&gt;https://dev.to/swyx/networking-essentials-rate-limiting-and-traffic-shaping-43ii&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://hechao.li/2018/06/25/Rate-Limiter-Part1/&quot;&gt;https://hechao.li/2018/06/25/Rate-Limiter-Part1/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[단일 장애 지점(SPOF)이란? Single Point of Failure]]></title><description><![CDATA[단일 장애 지점(Single Point Of Failure)이란? 시스템 구성 요소 중에서, 동작하지 않으면 전체 시스템이 중단되는 요소를 말한다. 이중화가 되어있지 않은 요소라면 SPOF일 가능성이 높다. 장애회복성을 위해서 SPOF…]]></description><link>https://blog.seongjun.kr/single-point-of-failure/</link><guid isPermaLink="false">https://blog.seongjun.kr/single-point-of-failure/</guid><pubDate>Tue, 25 Jan 2022 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;단일 장애 지점(Single Point Of Failure)이란?&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;시스템 구성 요소 중에서, 동작하지 않으면 전체 시스템이 중단되는 요소를 말한다.&lt;/li&gt;
&lt;li&gt;이중화가 되어있지 않은 요소라면 SPOF일 가능성이 높다.&lt;/li&gt;
&lt;li&gt;장애회복성을 위해서 SPOF가 없어야한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;SPOF의 예시&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;단일 서버&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;하나의 API 서버에 하나의 DB 서버를 사용하고 있는 상황
&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c24ad1d9dfaed148b1ee8f541eeaef2b/06066/2022-01-25-19-23-17.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 23.52941176470588%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABGUlEQVQY0z1QzUrDQBjMWwiV/Gx2s83mp2mTmqRiLU0hhaL0VhA8qhUED3rSmz32IdqX8CF8q/HLlu1hYL/5ZoeZz+IyQgfRj9G7dHDRc+HT7AdKg3EJh/lgQajnTst4H7bH4PoC5r+BZUS2y/Gw/cDTyxaBVAhUiqAfIa/mWCwfkWYVOM2Cdmle4313xHrzBtthOowJYJ3TOT5eP7/x93tAeTVGNCgwGOVo2g3WX3uUd/dQYUr8ENVkjuefI1a7PRz3ZMjlKZg27JxFmECpGDdlrgWeCOFS3TgpULQrCDJnTFJ1SkK7pKoRLBv9Nh7nyoxIqRLMmhb1tEEYZ5rzhaKUY1xPpmQ80lwHlQxxO1sgS3J4dE9Tt8M/mOedCJ59FwQAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 25 19 23 17&apos; title=&apos;2022 01 25 19 23 17&apos; src=&apos;/static/c24ad1d9dfaed148b1ee8f541eeaef2b/ca1dc/2022-01-25-19-23-17.png&apos; srcset=&apos;/static/c24ad1d9dfaed148b1ee8f541eeaef2b/e7570/2022-01-25-19-23-17.png 170w,
/static/c24ad1d9dfaed148b1ee8f541eeaef2b/f46e7/2022-01-25-19-23-17.png 340w,
/static/c24ad1d9dfaed148b1ee8f541eeaef2b/ca1dc/2022-01-25-19-23-17.png 680w,
/static/c24ad1d9dfaed148b1ee8f541eeaef2b/06066/2022-01-25-19-23-17.png 729w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;API 서버에 장애가 난다면?&lt;/h3&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/464325d17358da049aa033e5f04ca039/0b3a5/2022-01-25-19-48-49.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 23.52941176470588%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABHElEQVQY00VPO07DUBD0LZACcezn5/+zY8fIJgmyIRaEAlEAEqIOKUAKUJEOREHLCRDiEtyBWw27TzEUI82OdmdnDMeLwJB+jN62ia2eCUGzcEMNW/qwhUs80LPjkeb4MC2BgZDo7p3NjaGXyKw/ELhaPmJ5ewfXC+AGCT2JMKoOMTtbIM4nkGTGmspKrF4/cX79gB3T0mG6AAY7u5yuL7C4X+Pn+wvjchdBMkI6zDE9usTT6gUX8xPIKIVKc5R7DW6eP3D69q6TsuFfQq7ARPoKQRhhvyooXQxLBrComhfnOJjUyFQKk2abdEFQZQVv3hIPN5XD/8q8xCbN7BjjukWoMq0xkqxANa0RpYU2Yi1UQ9RNi4xa8NPOjPELtQWdH/NemzcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 25 19 48 49&apos; title=&apos;2022 01 25 19 48 49&apos; src=&apos;/static/464325d17358da049aa033e5f04ca039/ca1dc/2022-01-25-19-48-49.png&apos; srcset=&apos;/static/464325d17358da049aa033e5f04ca039/e7570/2022-01-25-19-48-49.png 170w,
/static/464325d17358da049aa033e5f04ca039/f46e7/2022-01-25-19-48-49.png 340w,
/static/464325d17358da049aa033e5f04ca039/ca1dc/2022-01-25-19-48-49.png 680w,
/static/464325d17358da049aa033e5f04ca039/0b3a5/2022-01-25-19-48-49.png 728w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;다른 시스템 요소들과 관계 없이 전체 시스템이 먹통된다. &lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;DB 서버에 장애가 난다면?&lt;/h3&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/fb21398daa2e162acc5b7db873ce77ff/06066/2022-01-25-19-49-04.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 24.11764705882353%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABE0lEQVQY00VQu07DQBDMb6CEkJzte/hsHw5yFAcSYwuUkip8ABYgChoKCmgokJDS8Q+Ilobf4JuGvY0Dxehm97SzM9sLZAxGZBDpFPtCYxQoCKrHoaY/C6kziHBbi0jzK61DqBOe8/OC5y16nviPvf4QD6/v+P76xCTPYdIJkuwQ9WqN9e0LytMVjM2gbYrq/AKbjx9ctk/oD4Y8zzqKBAPpSYwDoVCUC2weW7iMtquENxbTM8yv76HrClG4dWHyEnc3z3i7ajEYhSz0J+iJhzQJTpY1prNjcuE4lo/u8gKLqkGc5lyPCTpxaJoGy1nJvV3kzmF3Q4LNKKY7Ihd0G2kYKk5ZTHaxfM/zmE4i1K73f8NfoRWdiDIxDVkAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 25 19 49 04&apos; title=&apos;2022 01 25 19 49 04&apos; src=&apos;/static/fb21398daa2e162acc5b7db873ce77ff/ca1dc/2022-01-25-19-49-04.png&apos; srcset=&apos;/static/fb21398daa2e162acc5b7db873ce77ff/e7570/2022-01-25-19-49-04.png 170w,
/static/fb21398daa2e162acc5b7db873ce77ff/f46e7/2022-01-25-19-49-04.png 340w,
/static/fb21398daa2e162acc5b7db873ce77ff/ca1dc/2022-01-25-19-49-04.png 680w,
/static/fb21398daa2e162acc5b7db873ce77ff/06066/2022-01-25-19-49-04.png 729w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이 역시 SPOF이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Network의 Bandwidth 한계&lt;/h3&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/89c8825b4e3433280a87344c0012ff09/663f3/2022-01-25-21-20-39.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 47.64705882352941%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABZUlEQVQoz4WSX0/CMBTF+STKNta13Z9uMlgEhKA+iICiQR9MlMSgMSGYEHw28ZMfbydIYRgfmjW35/56bs9KDpPYXuJ3b7sCSZqh0ergmBb3I6pxOB6dGTpTX1oD1gJd1N8KNR1YLq5u7zBbLPH0/AJPRrA00NDpfrO3VHQoV0AfhzZD/2aM6WyOx+lrDtRN+jJnn0NmOnTFzs1aIFEmqPBVDtdntjHePw7Nt+NwyUUYV+FHCWpZA4E6gh8m4DJcwUTh3YtAglgVDiZj9MdvOOmOIFUdo4cF4rSNrN3H9f2cwklI5+X6PaHIrVC0kBOwN1lCTSYIgwyD9y+w4SWazSHOPj5RqddhW2wFFH85lD+/AxWZCNE+76HaPYUfJOhcDBE1mkhrTbR6A3CV5JMUHG5CEVuh6IRVkhIszuEqTiEpGBnGUKoKxoPN77PTWxg5T5JW2fFQJhd6f0h7DdCudN2E7I78DQ4ILswm5eGiAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 25 21 20 39&apos; title=&apos;2022 01 25 21 20 39&apos; src=&apos;/static/89c8825b4e3433280a87344c0012ff09/663f3/2022-01-25-21-20-39.png&apos; srcset=&apos;/static/89c8825b4e3433280a87344c0012ff09/e7570/2022-01-25-21-20-39.png 170w,
/static/89c8825b4e3433280a87344c0012ff09/f46e7/2022-01-25-21-20-39.png 340w,
/static/89c8825b4e3433280a87344c0012ff09/663f3/2022-01-25-21-20-39.png 650w&apos; sizes=&apos;(max-width: 650px) 100vw, 650px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;10G 스위치에 10Gbps 이상의 데이터가 전달된다면, Capacity를 넘어가는 순간부터 패킷 드랍이 발생한다.&lt;/li&gt;
&lt;li&gt;Switch도 이중화가 필요하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;서버에 연결된 인터넷 망이 장애가 난다면?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;단일 인터넷망을 사용하면 이 또한 SPOF이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;이 외에도 많은 단일화 되어있는 요소들이 SPOF이다.&lt;/h3&gt;
&lt;h2&gt;SPOF방지&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;API서버를 늘려보자&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 678px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/989f27a163b15ddc877fdfc8ac11aaa2/dc057/2022-01-25-19-47-11.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 47.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVElEQVQoz4VSTU/CQBDlb5AYoN2PftPyVcDGSELkoASVm3oxMRoSE/TgwRN6Nx70RGLiX33ObguUKvEwmdm382bfzE6JSRdMOvjbp2ZwSWblsO37PK+kAlOkwMrzLFGdVSEv7CKo91Bj1jonb3l+qXhpcBvlCtde2D7qUQuTizmOZ88IWzEkYQYRa0ySiYLanEJueSjvVfHw8oav5ScY46SsBS9ooJ2MEEzP4VFxn7BqzcTlbIH56zfxfP14QWFasGJIHA5H+FjcI4qaqDdjjUsngrAamhQS5gUhTqZ3OH1fQnS7MInHKG+tUAWqumoxORgg7iUUB1QoQERtnl094vbmCZ24D9sLUTUl5eyjczQEcwOYvxVuzKUWlXH9oqt9MhjjejyB4/gwszxV2CYBTOyY4eZX7Wwmzlp5ox0j7PRzP5riRmE7tma4a69WmF4l4fy7hz97+BJcjzDv8AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 25 19 47 11&apos; title=&apos;2022 01 25 19 47 11&apos; src=&apos;/static/989f27a163b15ddc877fdfc8ac11aaa2/dc057/2022-01-25-19-47-11.png&apos; srcset=&apos;/static/989f27a163b15ddc877fdfc8ac11aaa2/e7570/2022-01-25-19-47-11.png 170w,
/static/989f27a163b15ddc877fdfc8ac11aaa2/f46e7/2022-01-25-19-47-11.png 340w,
/static/989f27a163b15ddc877fdfc8ac11aaa2/dc057/2022-01-25-19-47-11.png 678w&apos; sizes=&apos;(max-width: 678px) 100vw, 678px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;API 서버 한 대에 에러가 나도 서비스가 가능하다.&lt;/li&gt;
&lt;li&gt;하지만 여전히 DB서버는 SPOF이다.&lt;/li&gt;
&lt;li&gt;DB서버 또한 이중화를 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/2fb1aca0407d66249ae52b17e702a3f2/3be76/2022-01-25-21-02-56.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 42.94117647058824%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhElEQVQoz32SzU7CUBCFfQ2NEPp/b+9toa3QWkNrNCYkKiSQqAsSYeHfSjcal8S4ceXalQvjw/BUx2kLWMC4mGQ67Zx+c2Y2NNPGf6HoFlSTr9VVg6GmmWv1jSIpGnRLwKAoGjgJ2eAigGFKEma/P9EsmKIOJ9gtvs37eVmwiK1KDZtVLRczmEAYH+Ds7gVJ7wLcdvJGnUnKJfrDB7x+TSF2YiiqAW0GsiCsGQKT9w883V/nZI4XgPMGwu45rKNDSCJisgHherAppGyhdXULI02gKplgaWSdYltluByN8PY4hsZcOI0ACpHabkjjSthOAzwTrPtkjQ0v2kfaHUK1JDSDL3uokMGMCKK4DdcPZ88u/CjF+GaC3vGA6Op5g2m7ENLBYPyMz+8p4laMKo2sl0fOPNPJM0lUGcmcmtebOO30cZIkqM1q2TtGfurCx7jTQRoEqGhsdcvFprJNZnQF9Wwxe20Ir0knYi18yvKgGSGgiZTSlaxt+e87ZEsezWN+YvpK/Qf/dBXL5vU4mwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 25 21 02 56&apos; title=&apos;2022 01 25 21 02 56&apos; src=&apos;/static/2fb1aca0407d66249ae52b17e702a3f2/ca1dc/2022-01-25-21-02-56.png&apos; srcset=&apos;/static/2fb1aca0407d66249ae52b17e702a3f2/e7570/2022-01-25-21-02-56.png 170w,
/static/2fb1aca0407d66249ae52b17e702a3f2/f46e7/2022-01-25-21-02-56.png 340w,
/static/2fb1aca0407d66249ae52b17e702a3f2/ca1dc/2022-01-25-21-02-56.png 680w,
/static/2fb1aca0407d66249ae52b17e702a3f2/3be76/2022-01-25-21-02-56.png 704w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이 외에도 Switch, Route 등의 서버 외의 하드웨어 부분에 SPOF가 발생할 수 있다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;이러한 SPOF의 방지와 서비스의 복원력에는 당연하게도 큰 비용이 뒤따른다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;서버 및 스토리지의 이중화&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;위키피디아 - &lt;a href=&quot;https://ko.wikipedia.org/wiki/%EB%8B%A8%EC%9D%BC_%EC%9E%A5%EC%95%A0%EC%A0%90&quot;&gt;https://ko.wikipedia.org/wiki/%EB%8B%A8%EC%9D%BC_%EC%9E%A5%EC%95%A0%EC%A0%90&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.gigamon.com/2018/08/31/understanding-single-points-of-failure/&quot;&gt;https://blog.gigamon.com/2018/08/31/understanding-single-points-of-failure/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://searchdatacenter.techtarget.com/definition/Single-point-of-failure-SPOF&quot;&gt;https://searchdatacenter.techtarget.com/definition/Single-point-of-failure-SPOF&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[3 주차 회고 [2022]]]></title><description><![CDATA[한 것, 배운 점, 잘한 점 TickTick에서 Focus To Do…]]></description><link>https://blog.seongjun.kr/week-3-2022-retrospective/</link><guid isPermaLink="false">https://blog.seongjun.kr/week-3-2022-retrospective/</guid><pubDate>Sun, 23 Jan 2022 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;한 것, 배운 점, 잘한 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;TickTick에서 Focus To Do로 테스크관리 도구를 변경했다. 뽀모도르랑 같이 테스크를 관리할 수 있어서 좋은 것 같다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;카모 면접을 봤는데 메일에서는 코딩 인터뷰라고 해서 알고리즘만 겁나 풀었다...&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;하지만 직무면접이였다. 흔한 자기소개 하나 준비하지 못한 나는 ...... OMG....&lt;/li&gt;
&lt;li&gt;그래도 대답은 얼추 다 한 것 같은데 준비가 안 된 상태라 아쉽다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;스프링을 찔끔 손대보는 중이다. 생각보다 방대하다... &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;개선할 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;블로그 글도 쓰고 알고리즘도 더 해야겠다&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;생각&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;많은 경험을 했다고 생각했지만  아녔다.  자기 객관화가 이제 좀 되는 것 같다. &lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[[추천] Paste 클립보드 히스토리 앱]]></title><description><![CDATA[Paste for Mac 클립보드의 히스토리를 관리할 수 있는 Paste 앱이다. 내가 기기에서 복사했던 () 기록, 이에 대한 분류 및 검색 기능을 제공한다.  MacOS / IOS 에서 사용 가능하며 구독형으로 21'01.13 기준으로 13,50…]]></description><link>https://blog.seongjun.kr/paste/</link><guid isPermaLink="false">https://blog.seongjun.kr/paste/</guid><pubDate>Thu, 13 Jan 2022 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;img src=&quot;https://pasteapp.io/_next/image?url=%2Fimages%2Fpaste-mac-icon.png&amp;#x26;w=384&amp;#x26;q=75&quot; alt=&quot;Paste for Mac&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클립보드의 히스토리를 관리할 수 있는 &lt;a href=&quot;https://pasteapp.io/&quot;&gt;Paste&lt;/a&gt; 앱이다. 내가 기기에서 복사했던 (&lt;code class=&quot;language-text&quot;&gt;ctrl+c&lt;/code&gt;) 기록, 이에 대한 분류 및 검색 기능을 제공한다. &lt;/li&gt;
&lt;li&gt;MacOS / IOS 에서 사용 가능하며 구독형으로 21&apos;01.13 기준으로 &lt;strong&gt;13,500₩/year&lt;/strong&gt; 이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;기능&lt;/h2&gt;
&lt;h3&gt;클립보드 히스토리 기록&lt;/h3&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/e0b22af480ab444d32aa7a0989d5290f/c2fc5/2022-01-13-18-09-07.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 62.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADOklEQVQ4y1WT7U/bVRTH+w+YuJhosjdmb0hmoq9cjBJdSPGFIVkYTBhu3QZENok62ByLGwgoS3zBksGUTJljHaVACbBkwyASN6RNgdInWtYyhVJXaqH0iULbX58+/lqe4knOPd/74nzuuffcI0G0dDpNKpXKuiAIxONxEolEVkciEaLRaFYLiSSx+LYLidReTiZ/lyPZ3ezaygsXGo0Gi3WeOYsVg9GETm/AYNAz74VJN0y4wB78X9oeVJJZhOgW02YjU2YDWpMe9ZQanWYCoxhNOi2mGa2oNaKewqybZm52Gqt+hnlDxnVshsP7FWZER9cgle8WUPdROZfyZVSUXERafYMPqprJL7/G0Yp6csvrOXL2a946dZXDJ78i5+Na3ii9wkHpGe739GeByWQSSUCs9HyjHOexQiitJVpwifCxOiZrf+LzBzbyhn3kdi3y9h0bb/5oIafdzKFWA6+1aHmlUYvknJy2u4odYGq7wp87ull4Jw8qZcRk54iXnYHjxQRKZCjbhmh69JzrvzqpGXKQ167j9cZxDtQ95qXLI0jKOvjhXk8WmNgFDssVWF/OB2kJ8cqTJD87jfCljERVKZQdJ119gVhXJwGLGvuinV6tgy/6n1HW4+Rw3fAeEHaAPfeVqA6cIPDqCYI5UoTcPNKFUhFeQKSqkFhxPrEP30P45CjpZikMFontvsymWcno6DjKvsEsrnM2uQNU9NFd/B2rZzsJFrXgK2pkraiJQMU3bDQ1EL55ndCNK2w01BC4VkugTYwD50F9gUVFOQPK7ixwcnkHOKQa4Ns+HQ26OE1Po9hnnuBVf4pH04xrxsjcqA3zbwsYB2y4/xhjfeQR3j8nmbX8RfvDJyh6+/evvJ6A+lsqVBMWfvdEGVuK4Pj7GU7zHdyOx4RWg/zz3M5I7y081n9Zs9rxzs8Rcq9g0hu5ebsNebdivykPrFD9vQqbSRRpgUQ4wOraFo5lLy63j7B/i1BwSUz+hVjUz4tlN641D+LkYRh/SE3p+8i77u3/w7tmqGlVMTahZ8UvsOD0seQSQRshNjfDBH3iASurrHsDeMTo93jZ8AcRtgQsWg0tVy/S2rH9hpm5/g8yqkkSqN2BaQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 13 18 09 07&apos; title=&apos;2022 01 13 18 09 07&apos; src=&apos;/static/e0b22af480ab444d32aa7a0989d5290f/ca1dc/2022-01-13-18-09-07.png&apos; srcset=&apos;/static/e0b22af480ab444d32aa7a0989d5290f/e7570/2022-01-13-18-09-07.png 170w,
/static/e0b22af480ab444d32aa7a0989d5290f/f46e7/2022-01-13-18-09-07.png 340w,
/static/e0b22af480ab444d32aa7a0989d5290f/ca1dc/2022-01-13-18-09-07.png 680w,
/static/e0b22af480ab444d32aa7a0989d5290f/02d09/2022-01-13-18-09-07.png 1020w,
/static/e0b22af480ab444d32aa7a0989d5290f/c2fc5/2022-01-13-18-09-07.png 1055w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;복사 (&lt;code class=&quot;language-text&quot;&gt;ctrl+c&lt;/code&gt;) 를 했던 기록을 저장하고 설정해놓은 단축키( Default : &lt;code class=&quot;language-text&quot;&gt;cmd+shift+v&lt;/code&gt;) 를 누르면 사진과 같은 리스트가 표시된다. 리스트를 보고 원하는 기록을 선택하면 붙여넣기가 된다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;cmd + 1..9&lt;/code&gt; 으로 바로 붙여넣을 수도 있다. &lt;code class=&quot;language-text&quot;&gt;shift + cmd + 1..9&lt;/code&gt; 으로는 Plain Text로 붙여넣는다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 662px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/b934037252ee18a4096919edbee4d78c/46b67/2022-01-13-18-13-02.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 82.3529411764706%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAADXElEQVQ4y21STW8bVRR9aZSkTkolFiXB9ow9djz2fL6Z8Xz5Yzz+TE2TSFUlaNouSithFu2iliqQYMUGVMldseseVbBhhZDYsOQPIY1IPO9y38RN28Di6Pq+Oe+8c881mThtYlYb2weBbfiORZvUopaqUkuWqaUb1Ea4lk2bJqV6vUEdw6S2YWQ95/LqUssyNe3DQTci5PHoNvHr5u2HB63TYdROOq6fxO1u0oviJA5bSTcIk+lonBxODpJR1Esi7CN+7gdv8DcCUPyrz+/eI+T5k6dEleuzjh8CEiHyPDg4vgPTk4dwPBkDisEw6sF0OIL7n34G47gPx9MpTLB2gwDvhMse3rN0ffHX738Q8sWdE1LOF2e0poAlK0urpqSuYTOHBsw1XOZrJvN0ylzVYIFhMU+jWd9UdIZchvdO8R7UxPLiz1evCTnpf0KEG3szpSgBIjXKNdZ3PHDNDgTOAPjvuBlCz/GhS13oWh6Ykgz1fInzmVqUzlShAtJuYfHT8x8IeTA6IuJHH880sZoJ+iplQy8EWwtRMIbYQREbxSwX9NI+cB4XpJU6GFKNqWL1jJ9V9oqLX759Scj94SERUJC/gh9SrEwplEEvy9BzWzD024gOxG4Ifeztmgo4BZhcEKdB/oXgz98sLgkKlVQT91FQBKViYui4EO9ciI/toBjn8Xh45Y//r6D4jkOeS0s3wbV60PJvwsD1Mb8ABujUkc/dcaz4THtn5Pcd4iEGnDYKZaaLEmiyC53WFIYoGKNDLtoynCxLq9qA1RKzpfzX4W4+27KnGClukUW4BK+hg1GqZllxAb4IvmEd3dn7StZjBAzrZcGji5FxlBQvM2tfYY6sMZ4nH4viGXfTNptZ7zUMppWqLNRt5inmKU6VCb7++sVFhl/yV1YhAydwV4f9CRwNJnCrP4bj0c3MoVKQ3uTHI+KLPGvWNajmhZe/fvcjIfcGt0jxxt4jRcBMBGmpCJVlg//BJTkdht103O5lmHTjtGU6ab1QSpGDkPgCl6pY+cfXKFTywve/vXhFCACQrY3N6vWda7MPtnfmiGfXt6/Nd67m5muEXIAgNq+sz5E3X/HOkduZ5za2nuY2t2zkrBFUx0quIDYRV9/DGmJ9hY1L394ih9hCrJd38+RfzT+TttFMLiwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 13 18 13 02&apos; title=&apos;2022 01 13 18 13 02&apos; src=&apos;/static/b934037252ee18a4096919edbee4d78c/46b67/2022-01-13-18-13-02.png&apos; srcset=&apos;/static/b934037252ee18a4096919edbee4d78c/e7570/2022-01-13-18-13-02.png 170w,
/static/b934037252ee18a4096919edbee4d78c/f46e7/2022-01-13-18-13-02.png 340w,
/static/b934037252ee18a4096919edbee4d78c/46b67/2022-01-13-18-13-02.png 662w&apos; sizes=&apos;(max-width: 662px) 100vw, 662px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;복사한 컨텐츠가 링크라면 자동으로 메타데이터를 긁어와서 미리보기를 보여주기도 한다. 또한 복사 기록에 대한 저장 기간도 설정할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;검색기능&lt;/h3&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/87c6060600da80c2bc452bc2e35df120/9d62a/2022-01-13-18-16-34.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 47.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACcUlEQVQoz1WS20uTcRiAvz9BjaJt7vhtn2sHZ06n8zAPWWpqRZbT6TytTZ3O0iDKblrrsEVqzDCsFJG0LroJhcy8CBKvBKMguonopquCboquevo16KKLh/eFFx7ek2SWZWSTCbMsMFv+QxaYZAtGgSO/iPyDHkEJLoGzwIPbW0NxeS3F3iqKBG6vD8mg1mDWGTAanVjza7DYfVgcVZjtFVidFThdpdgcHhyuMpGXYz1QjGIVcpeXAlcxLlEvdNgotZrwWu1IExcvEw40kxq0kx53Mx2zMhW1MDtezURfHU1NJ+jrC+NvD9Lm7+JK/CbJGymOdwxTE7lH1eBDSrpncPfMUHJhHunZ6jp3EiN834rwezfGr61Wfm4ehd0UOwtDBDoCJBJxRkdjRCJhlldW2HyxRk8sTuX4KnWXNsmPbaAMb1B5/RWSRqOirfUUk8lbtPuDhENRQr0RAiKfm53L7FelVqPRaFCLqFKpyM7O4VB1DUvLj5hdXOD+3F0WH8zxdGkBye3x0R8KE+rowrhPS5nLjdNgRp+1l+TVBNa8vIxIq9VmMBgM5GRl0R2O8Glzi63zcZLzz+lf3KZl+iXSsfozDAwOMRDsRVGbqBCXdCs2lP1aUolr5CkKatHdP6FerxfCbLrC/bybecJX30k+j43xOj1FevkxkqLI9AaDnBsYwpZrpNbjxWt34dTLpG9PCqElM2Zubm4GnU7HnpxsTrcFWN/5wvu3H/j2Zpsfu7t83F5DMsp5VNU2Eo2exe/vFBcV+wv00BnoJjoyjllxotMbxVv9/VUzBr0BnRDbHYVUH27mSGMDDc0t1Lcco7zcxx+s1WFzoLohyQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 13 18 16 34&apos; title=&apos;2022 01 13 18 16 34&apos; src=&apos;/static/87c6060600da80c2bc452bc2e35df120/ca1dc/2022-01-13-18-16-34.png&apos; srcset=&apos;/static/87c6060600da80c2bc452bc2e35df120/e7570/2022-01-13-18-16-34.png 170w,
/static/87c6060600da80c2bc452bc2e35df120/f46e7/2022-01-13-18-16-34.png 340w,
/static/87c6060600da80c2bc452bc2e35df120/ca1dc/2022-01-13-18-16-34.png 680w,
/static/87c6060600da80c2bc452bc2e35df120/9d62a/2022-01-13-18-16-34.png 908w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;돋보기 모양을 누르거나 Paste를 활성화한 후에 &lt;code class=&quot;language-text&quot;&gt;cmd+f&lt;/code&gt; 를 누르면 검색 기능을 사용할 수 있다.&lt;/li&gt;
&lt;li&gt;기본적으로 &lt;strong&gt;내용에 대한&lt;/strong&gt; 검색도 가능하지만, 복사한 &lt;strong&gt;컨텐츠의 형식&lt;/strong&gt;과 복사한 &lt;strong&gt;어플리케이션으로&lt;/strong&gt;도 &lt;strong&gt;검색&lt;/strong&gt;이 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;ex&lt;/h4&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/827b9e50c8ff45b98cfc869245112d39/bac97/2022-01-13-18-20-24.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 32.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABwklEQVQozy2Ry2tTQRyF8xcUIYXUNjdpbO6dO3NnJsncm5iYmNSkjShSUBcurCtFQRBcCYpuREWxPsFHXLjwsagPcCEKUvVP+5wkLobzzTm/OcwwORnGROUqoejgOqfQjeOo+pBaNkLoAWEyJNJHie2YWnOMcZsIz9JuYqKMVLfpNFskSZ1qpUZuq7XCtUslfn/V/PiwyJ8v+7hxfomtbol3LxS/dlf5+XGBT6/ynOmXuHyuyt9vhu/vC+ztLnD/6hIn2hXePpPsfa6SG7kKF7cPMHmseHpnkclOnguni2y0yty7KXm9U+HlgzwPbxU41i5z9uQab57EPL9b8FmeK9vLDHzH7esxk0e+UEhDdc0QlOuUVjOvGZFMkcoSBAn7i4blYp1iqYbwXhjaGQdlR1BKqQpHouuUVy0rgSVXs5pm6hiPNxgN1zmy3qfX65I2GjjnyLIGqbOeLdYYsoajf7hLp9Py8wPPPTKX0j7Y4pD3ckZrEqmw1swOTPdaJ2il0InGeN8Yr9PML62SuXrP/s+mc1rPZ3JRrFHaIaQmVmb21Egoz3Wk/zkhYpQvj71GYUQSz1nGksSXR1E0Y+UvJYTgHyhn7WYwUOj7AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 13 18 20 24&apos; title=&apos;2022 01 13 18 20 24&apos; src=&apos;/static/827b9e50c8ff45b98cfc869245112d39/ca1dc/2022-01-13-18-20-24.png&apos; srcset=&apos;/static/827b9e50c8ff45b98cfc869245112d39/e7570/2022-01-13-18-20-24.png 170w,
/static/827b9e50c8ff45b98cfc869245112d39/f46e7/2022-01-13-18-20-24.png 340w,
/static/827b9e50c8ff45b98cfc869245112d39/ca1dc/2022-01-13-18-20-24.png 680w,
/static/827b9e50c8ff45b98cfc869245112d39/02d09/2022-01-13-18-20-24.png 1020w,
/static/827b9e50c8ff45b98cfc869245112d39/bac97/2022-01-13-18-20-24.png 1128w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h3&gt;Pin&lt;/h3&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 669px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/7b32a91d7a66422c64f32b7a3cb0d28c/66b6b/2022-01-13-18-21-43.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACg0lEQVQoz02Ry1ITURCGZ+HKhVSJJJO55EbIhYQKmskNyQRcSQQCSQgzk5lQJgE0QNAEkEIt3eDWF1DLKh+BlQurAuYBfA1duoffngOoi7/Ome6/v57uw62sVFEmVVc16IYJq76GVmsdzWYLDTofmxa6m0+w29tD51kXzUYdm+sWeS1YGybMGtWQNN0g1cBtlspoF4vYKpWwUy5jl8Bdy0KPZJ9NTce+YeAF3Q+sOp4bOnqmjg7Fd81VtMnf0DTsVCrYJgb3q9MG3hwBhz3g9SGwtQE0TKBVx0XTwseajt/dDvDyABfdbaBZZ7lLreFnw8Jn0wCO9oC3r8CdVJbw3dRwqlXQr62iX1rA6eIczooF9EnHpWV8rZaYZ2BUMFgqsJytwWIBJ8V5vCsvY6CV0bd0cB6/Hw6nE06XC4IoQnS74ZQkOEUJvCxDVfOQPR7muTlEGpZwR5RxyyFjRBDgCwSg5lSM8Dx4YnDBsSBkAvgJHIvFkEgkEApSjGBeAj3Iz7CczyujbcTx/qmMs+MhHFadcPAywuSdtZsSw0N+boyAkiQiQJ3uTk5iYmICkUiEAT1XQJ/Pj4DfjR+fUjj/4gA+3MC3/SGaSKLmYwwoXQNtkCC4WCAUCiEcDsPr9V4CafzZfJ59C/ZKBBGLihNHD4fRVkcgUo094QwBXZQXaWVcJDLOIDbMhtogty2Cua+A9iqi0Sgi41F4R4O4zXsgU076C1QZw/ZxkzRmKpVCPB5nXf6XXZDP5Vg+k8kgnU7TSmL0tzybiqeHCIyOQp2ehpJMIjuVBadO55BUFKZMKo00FV9rKpvFQuER7menoNxLIJlQkFKS5PvnsRvOzxXYXaEH/QPpDo9la4GdLgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 13 18 21 43&apos; title=&apos;2022 01 13 18 21 43&apos; src=&apos;/static/7b32a91d7a66422c64f32b7a3cb0d28c/66b6b/2022-01-13-18-21-43.png&apos; srcset=&apos;/static/7b32a91d7a66422c64f32b7a3cb0d28c/e7570/2022-01-13-18-21-43.png 170w,
/static/7b32a91d7a66422c64f32b7a3cb0d28c/f46e7/2022-01-13-18-21-43.png 340w,
/static/7b32a91d7a66422c64f32b7a3cb0d28c/66b6b/2022-01-13-18-21-43.png 669w&apos; sizes=&apos;(max-width: 669px) 100vw, 669px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;사진의 오른쪽 위에 &lt;code class=&quot;language-text&quot;&gt;+&lt;/code&gt; 를 눌러서 pin board를 만들고 복사한 컨텐츠를 드래그해서 해당 pin board에 넣어둘 수 있다.&lt;/li&gt;
&lt;li&gt;자주 쓰는 코드나 텍스트 템플릿 등을 저장하고 쓰면 편하다!&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Paste Stack&lt;/h3&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/f76628c67355a206c6cea9aedfc41a4e/68934/2022-01-13-18-31-39.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 57.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0ElEQVQoz5WQz07iUBTGeQ0egCADmdGkpbTQlj9Da8ExoZkhkQFqfAZXPg5qYDOJRtGFiX92Ji5cSCRRZpw4UZihgiWIlPb2emyNSsaN3+LmJPf8zved48KOLMuCp9tFK8tLxSJB0/FYLJfLFQpFURQpisrn85qmQePWmXnVs2wCu55QjCy7MhqN77JMUtRMeobneZqmI5EIwzCCIKiqCg26YfvYcmH82hvD1/zCQjQalWU5FgP7OIzwer0pKaW2b57bXuB7U7voH47Q8BE2DKWoMExYkqRQiKaoUDAY9H2YiHNC4+QvNCA0DjcHpz/+LN7qTRseKYoSCARYlmNZliAIv9/v800kE+L1Zdt2RmMwwuad0XHymKYJMEmSiUSC4zjIDLXH45mWpjvdzhuxHRkjdHWm/zzuz2ULBEnA2kAmkwJMmJqalFJptXmB++do2HVO9AQ7s/791mv7g9p+b+7rvCB+zmazmUwGDsZxLBx89ktarW/g5rbZOsDIeHF24NYv/WRvUDvozUrfPk1+5Dkedg6HwxDb7XZHebZdX3+Er3cxGv0XW0eXp8Pzo7vq2s7q6nKlUimXyxVbpVJps7p132thrW7pnbHYr2Xhd+gBtpncuUKlCNEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 13 18 31 39&apos; title=&apos;2022 01 13 18 31 39&apos; src=&apos;/static/f76628c67355a206c6cea9aedfc41a4e/ca1dc/2022-01-13-18-31-39.png&apos; srcset=&apos;/static/f76628c67355a206c6cea9aedfc41a4e/e7570/2022-01-13-18-31-39.png 170w,
/static/f76628c67355a206c6cea9aedfc41a4e/f46e7/2022-01-13-18-31-39.png 340w,
/static/f76628c67355a206c6cea9aedfc41a4e/ca1dc/2022-01-13-18-31-39.png 680w,
/static/f76628c67355a206c6cea9aedfc41a4e/02d09/2022-01-13-18-31-39.png 1020w,
/static/f76628c67355a206c6cea9aedfc41a4e/68934/2022-01-13-18-31-39.png 1278w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;복사 붙여넣기를 특정 순서로 텍스트, 이미지, 링크 등 여러 항목을 동시에 붙여넣을 수 있는 기능이다. 사실 나는 불편해서 잘 안 쓰지만, 활용을 잘하면 좋을 것 같다.&lt;/li&gt;
&lt;li&gt;자세한 건 링크 참고 &lt;a href=&quot;https://medium.com/pasteapp/copy-copy-copy-paste-paste-paste-56068d2150c2&quot;&gt;https://medium.com/pasteapp/copy-copy-copy-paste-paste-paste-56068d2150c2&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;IOS 및 Siri 지원&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;IOS 앱도 있고, 위젯을 사용하면 꽤나 편리하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;macOs Monterey Shortcuts&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;이건 사실 잘 모른다... 아직 빅서에서 업데이트를 안해서,....&lt;/li&gt;
&lt;li&gt;링크 참고! &lt;a href=&quot;https://medium.com/pasteapp/paste-with-shortcuts-for-macos-monterey-f74b68bd7d91&quot;&gt;https://medium.com/pasteapp/paste-with-shortcuts-for-macos-monterey-f74b68bd7d91&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;경험담&lt;/h2&gt;
&lt;h2&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 352px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/dfdfc333d4abc881fdd36641c1aabac6/3a2f8/2022-01-13-18-36-03.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 42.35294117647059%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABnUlEQVQoz4WSvWsUQRjG7y+wM7e5/ZjZ2d27vdvL3kcuWeMR4xEjiR+IByGa4jRgmsPCoPgP6B9gJ4ggNiGtClaChY2kSyOIYGklgtjY/ZwZuVMQtXh4n4F5n/d5n5lSIiKqQhH7EZEfkwTmrLknCSuBrRNuoFwx5QaxH9r7SaBsLRkx5UVkSpKHFcwA5YV0GnMsdRdp1Zu0GzkneydYbM/TyzuWF+0eRWeBLE6nolbQdSJuDyM+PFnm3f42r+43yUJJ0S24Mtxk9dSAQX+FLc0vnN1gbWWVc2vrXFw/z+aloR6c2w2mgjMzEU/HAt7e4vvrPb6+uEo/dWhUc+1wgTxtWifdrIVwPLumdHzk7E/8sXK5HPN424Gjh3x7Nubzgzn6NRfhKlIdR10qEt0U6RhqMrZNpk7wu5gVDNyYUVHh5b0tnl8v8+jyMYLjDnf37nD4/gsHbz5xePSRjcEZ63Ai8jfYR5FerFcR1oXwq0jNTy8ts3vjJqNrY3ZGu7TSzGZl3PwLJfNNauKX5Qk32YSzHkrD1EZUo5nU/4sf2QEC20H6qiUAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 13 18 36 03&apos; title=&apos;2022 01 13 18 36 03&apos; src=&apos;/static/dfdfc333d4abc881fdd36641c1aabac6/3a2f8/2022-01-13-18-36-03.png&apos; srcset=&apos;/static/dfdfc333d4abc881fdd36641c1aabac6/e7570/2022-01-13-18-36-03.png 170w,
/static/dfdfc333d4abc881fdd36641c1aabac6/f46e7/2022-01-13-18-36-03.png 340w,
/static/dfdfc333d4abc881fdd36641c1aabac6/3a2f8/2022-01-13-18-36-03.png 352w&apos; sizes=&apos;(max-width: 352px) 100vw, 352px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;내가 이 앱을 설치한 건 19년 8월이었다. 여러 내용을 복사 붙여넣기 할 때 따로 &lt;code class=&quot;language-text&quot;&gt;Typora&lt;/code&gt;를 키거나 메모장을 켜서 잠시 복사한 내용을 저장해두다가 불편해서 관련 앱을 찾았다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/035d84c0818c0214da7907d5c8f0a4ae/3a6ec/2022-01-13-18-38-47.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 32.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAz0lEQVQoz42RjQ3CIBCF2dk5nMAVXKIz6ABWm9iK/RFoihR4cjQYNbbpJV84Eni8ezAhFbrHA1prUHnv3zjnYK1dJJ0ZhiH2rL5f0bQ12q5D3/eQUr4Zx3G1qDFmEtTZBv64Q8UbXM458vwEfqtwC9DhNUVGOOeToMy20Ic9GmVQBtG6k+CNQCvDCD6G8BXDL1TkjkamPUuv2HD7OQbr1sWVcFHxv0jK+7eYDzYJ+OnyJ3OOlFLRVTQSYinLEkVRxJ4tjTNH+qy0pwyFELF/Aa6BJAj7zzXiAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 13 18 38 47&apos; title=&apos;2022 01 13 18 38 47&apos; src=&apos;/static/035d84c0818c0214da7907d5c8f0a4ae/ca1dc/2022-01-13-18-38-47.png&apos; srcset=&apos;/static/035d84c0818c0214da7907d5c8f0a4ae/e7570/2022-01-13-18-38-47.png 170w,
/static/035d84c0818c0214da7907d5c8f0a4ae/f46e7/2022-01-13-18-38-47.png 340w,
/static/035d84c0818c0214da7907d5c8f0a4ae/ca1dc/2022-01-13-18-38-47.png 680w,
/static/035d84c0818c0214da7907d5c8f0a4ae/3a6ec/2022-01-13-18-38-47.png 686w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;그때 당시에는 19,000원으로 한 2주 정도 Trial 기간을 줬는데 하루정도 쓰고 그냥 바로 결제했다. 내가 필요했던 기능을 너무 잘 제공해줬고 UI/UX 측면 다른 클립보드 히스토리 관리 앱들에 비해 압도적으로 편리했다.&lt;/li&gt;
&lt;li&gt;이 앱을 따라 한 무료 앱들이 매우 많았지만, 기능적으로나 성능적으로 원본 앱을 따라올 수 없었다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;구독형으로 전환&lt;/h3&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/e6a4524cecec4c79bbb031588bb4efe4/ce85c/2022-01-13-18-51-28.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 46.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA+klEQVQoz52SyWqEQBCG5/1fRO+ClwzoVY8quKGjaMTDuG+44J90BQeT6YQhBT/VTVV/XVXdF5xs33fy93sBz/MQRRGCIIDv+6S+78HLP9uFl9AX74ijG5IkRRzHyLIMeZ5jXVdM0wTDMJCm6ePMoScgWID8hr9sGAbM8/wNyK/wgO5fidu2QdM0XN+uUBQFuq5DVdUH4OWWD8+AsixDEASIoghJkj7HkDxV9muFvFtZe13XoSgKlGX5v0dZlgVN06BtW4LVdU1gtq+qisTiPDAXyA6YpgnLsmDbNhzHIbG167qkMAxpJC8B2X9jLY7jSJWd/XnNvtFP4AcQs7gTdpUurwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2022 01 13 18 51 28&apos; title=&apos;2022 01 13 18 51 28&apos; src=&apos;/static/e6a4524cecec4c79bbb031588bb4efe4/ca1dc/2022-01-13-18-51-28.png&apos; srcset=&apos;/static/e6a4524cecec4c79bbb031588bb4efe4/e7570/2022-01-13-18-51-28.png 170w,
/static/e6a4524cecec4c79bbb031588bb4efe4/f46e7/2022-01-13-18-51-28.png 340w,
/static/e6a4524cecec4c79bbb031588bb4efe4/ca1dc/2022-01-13-18-51-28.png 680w,
/static/e6a4524cecec4c79bbb031588bb4efe4/02d09/2022-01-13-18-51-28.png 1020w,
/static/e6a4524cecec4c79bbb031588bb4efe4/9d567/2022-01-13-18-51-28.png 1360w,
/static/e6a4524cecec4c79bbb031588bb4efe4/ce85c/2022-01-13-18-51-28.png 1372w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;20년 2월부터 Paste는 구독형으로 전환하였다.&lt;/li&gt;
&lt;li&gt;이전에 구매한 이들에게는 소정의 무료 기간을 줬지만, 반발이 꽤 심했다.. 구독으로 전환한다는 미디엄 글에 댓글이 다들 부정적인 의견이었고 삭제하고 다른 어플로 갈아탄다는 댓글이 대부분이었다.&lt;/li&gt;
&lt;li&gt;사실 이미 구매한 사람들은 업데이트하지 않으면 구독 없이 사용할 수 있었다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;My two cents&lt;/h2&gt;
&lt;p&gt;일단 나는 소프트웨어를 사는 것에 있어서 최대한 돈을 아끼지 않으려고 한다. &lt;/p&gt;
&lt;p&gt;내 주변에서는 소프트웨어 혹은 게임을 돈 주고 구매하는 것에 대한 거부감을 갖고있는 사람이 많다.  개발자로써 조금 안타까운일이라고 생각한다.&lt;/p&gt;
&lt;p&gt;매번 어플을 살 땐 이 어플을 만들 때 든 개발자의 노고를 생각해보곤 한다. 이 어플을 만드는 개발자의 노동력의 대가로 생각했을 때 그 값이 맞을까? 라고 말이다.&lt;/p&gt;
&lt;p&gt;어떤 어플에 대한 아이디어에 필요성을 느끼곤 &quot;와 사이드 프로젝트로 할만한 주제인데?&quot; 하고 막상 검색해보면 너무나 잘 만든 앱이 있어서 기분 좋게 쓰곤 했기 때문이다. 아, 내가 만들었으면 몇 달은 걸렸을 텐데 하고 말이다.&lt;/p&gt;
&lt;p&gt;그래서 그런지 이 어플이 그 정도 값어치를 하는가? 에 대한 질문은 오히려 더 받아야 한다는 의견이었기도 하고, 구독형 전환 때문에 개발자들이 더 이 프로덕트에 집중하여 더 좋은 프로덕트로 개선이 된다면 좋다는 생각에 역시 바로 구독으로 전환하여 잘 사용하고 있다.&lt;/p&gt;
&lt;h2&gt;LINK&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;공식 홈페이지 &lt;a href=&quot;https://pasteapp.io/&quot;&gt;https://pasteapp.io/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;App Store &lt;a href=&quot;https://apps.apple.com/kr/app/paste-clipboard-manager/id967805235?l=en&quot;&gt;https://apps.apple.com/kr/app/paste-clipboard-manager/id967805235?l=en&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Alternative&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://apps.apple.com/kr/app/upaste-clipboard-manager/id1503649026&quot;&gt;https://apps.apple.com/kr/app/upaste-clipboard-manager/id1503649026&lt;/a&gt; - 무료&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://snark.github.io/jumpcut/&quot;&gt;https://snark.github.io/jumpcut/&lt;/a&gt; - 무료 OpenSource&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://apps.apple.com/app/copyclip-clipboard-history/id595191960&quot;&gt;https://apps.apple.com/app/copyclip-clipboard-history/id595191960&lt;/a&gt; - 무료&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://apps.apple.com/app/copyclip-2-clipboard-manager/id1020812363&quot;&gt;https://apps.apple.com/app/copyclip-2-clipboard-manager/id1020812363&lt;/a&gt; - 7.79$&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[1 주차 회고 [2022]]]></title><description><![CDATA[…]]></description><link>https://blog.seongjun.kr/week-1-2022-retrospective/</link><guid isPermaLink="false">https://blog.seongjun.kr/week-1-2022-retrospective/</guid><pubDate>Sat, 08 Jan 2022 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;한 것, 배운 점, 잘한 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;당마 과제로 가득 채운 한 주였다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;과제 내용 자체는 짧았다.&lt;/li&gt;
&lt;li&gt;하지만 다 처음으로 돌아가서 하나하나 의문을 가지면서 짜려고 하다 보니 많이 늦어졌다.&lt;/li&gt;
&lt;li&gt;뭔가 지난 몇 년을 다시 돌아보는 느낌인듯..&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;개선할 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;알골을 풀어놓고 제출을 안 했다 solved.ac 54일 연속이 깨졌다 ㅜㅠ&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;생각&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;문득 불안해질 때가 있다. &lt;/li&gt;
&lt;li&gt;어차피 먹고사는 건 문제없다고 되뇌고 집중을 유지해보자&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[51 주차 회고 [2021]]]></title><description><![CDATA[한 것, 배운 점, 잘한 점 프리랜서 포함…]]></description><link>https://blog.seongjun.kr/week-51-2021-retrospective/</link><guid isPermaLink="false">https://blog.seongjun.kr/week-51-2021-retrospective/</guid><pubDate>Sun, 26 Dec 2021 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;한 것, 배운 점, 잘한 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;프리랜서 포함 3년 반 다닌 회사를 퇴사를 했다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;고객사 프로젝트는 하고 있는 게 없어서 그냥 내가 하던 작업만 마무리하고 리드미 쓰고 인수인계 받으실 분에게 이틀잡고 인수인계 해드렸다.&lt;/li&gt;
&lt;li&gt;앞으로 회사나 나나 잘 되었으면 좋겠다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ide를 전부다 intellij로 변경 중 &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;단축키를 vscode keymap extension을 추가해서 쓸까 하다가도... vscode에서 atom keymap을 쓰다 습관이 고쳐지지 않았던 기억때문에 그냥 찾아보며 익숙해지는 중&lt;/li&gt;
&lt;li&gt;역시 돈쓴 값어치를 한다&lt;/li&gt;
&lt;li&gt;하지만 맥북 터질라함ㅜㅜ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;새로 배우는 것들과 먼 기억 속에서 지워져 새로운 느낌인 것들 다 배우는 재미가 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;개선할 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;잘 쉬었다 이제 달려어~~&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;생각&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;아쉽기도 하고 후련하기도 하고 참 복합적이다. 하지만 뒤돌아볼 시간이 아깝다. &lt;/li&gt;
&lt;li&gt;그동안 너무 정체되어있었다는 생각과 그래도 몇 년 전의 나보단 성장을 한 듯 한데? 하는 두 생각이 공존&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[HTTPS 와 SSL - 2]]></title><description><![CDATA[이전 글에서 HTTPS와 HTTP의 차이에 대해 알아봤다. HTTPS에서 보안 계층은 어떻게 동작하는지에 대해 좀 더 자세히 알아보자 SSL…]]></description><link>https://blog.seongjun.kr/https-and-ssl-2/</link><guid isPermaLink="false">https://blog.seongjun.kr/https-and-ssl-2/</guid><pubDate>Sun, 19 Dec 2021 00:00:00 GMT</pubDate><content:encoded>&lt;ul&gt;
&lt;li&gt;이전 글에서 HTTPS와 HTTP의 차이에 대해 알아봤다.&lt;/li&gt;
&lt;li&gt;HTTPS에서 보안 계층은 어떻게 동작하는지에 대해 좀 더 자세히 알아보자&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;SSL 인증서가 신뢰 할 수 있는 서버(사이트)임을 보장하는 방법&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;웹 브라우저가 서버에 접속할 때 서버는 먼저 인증서를 제공한다.&lt;/li&gt;
&lt;li&gt;브라우저는 이 인증서를 발급한 CA가 자신이 갖고있는 CA의 리스트에 있는지를 확인한다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;있다면 해당 CA의 공개키를 이용해서 인증서를 복호화 한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CA의 공개키로 복호화 가능 하다는 것은 해당 비공개 키로 암호화 된 것을 의미한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;복호화에 성공하면 CA에 의해 발급된 인증서라는 것이 검토됨을 의미한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;그럼 사실 공개키만 있어도 복호화가 가능한거 아닌가?&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;데이터를 보호하는 목적이 아니다 &lt;/li&gt;
&lt;li&gt;복호화 할 수 있다는 것은 그 데이터가 비공개키로 암호화 되었다는 것을 의미&lt;/li&gt;
&lt;li&gt;따라서 공개키가 데이터를 제공한 사람의 신원을 보장해주는 것&lt;/li&gt;
&lt;li&gt;이를 전자서명이라고 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;SSL의 동작 방식&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;이전 글에서 간단하게 SSL은 암호화된 데이터를 전송하기 위해 공개키와 대칭키를 혼합해서 쓴다고 했다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;실제 데이터는 대칭키로 암호화 - ( 리소스가 적게 들어서 빠름 )&lt;/li&gt;
&lt;li&gt;대칭키를 공개키 방식으로 암호화&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;이에 대해 좀 더 자세히 알아보자&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;SSL Handshake&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Client Hello - 먼저 클라이언트가 서버에게 요청을 보낸다. 아래의 정보를 보낸다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클라이언트에서 생성한 &lt;strong&gt;랜덤 데이터&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;클라이언트 사용 가능한 암호화 방식 목록 - 서로 지원하는 암호화 방식이 다를 수 있으므로 협상 해야함&lt;/li&gt;
&lt;li&gt;Cipher Suite 목록&lt;/li&gt;
&lt;li&gt;세션 아이디 - 이미 SSL Handshake를 했다면 기존 세션을 사용한다. 이에 대한 식별자&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Server Hello - 위에 대한 응답을 준다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;서버에서 생성한 &lt;strong&gt;랜덤 데이터&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;서버가 선택한 암호화 방식&lt;/li&gt;
&lt;li&gt;클라이언트의 암호화 방식 목록을 보고 서버에서도 사용할 수 있는 방식을 전달&lt;/li&gt;
&lt;li&gt;인증서&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;클라이언트는 서버의 인증서를 확인하기위해 브라우저에 내장된 CA목록을 확인&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;목록에 있다면 내장된 CA의 공개키로 복호화, 성공 시 인증서가 보증된 것&lt;/li&gt;
&lt;li&gt;없으면 경고&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Pre-master secret&lt;/strong&gt;를 생성한다.&lt;/li&gt;
&lt;li&gt;이후 이 &lt;strong&gt;Pre-master secret&lt;/strong&gt;를  서버의 공개키로 암호화 해서 서버로 전송&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;서버는 클라이언트로부터 받은 정보로 &lt;strong&gt;Session key&lt;/strong&gt;를 유도&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Pre-master secret&lt;/strong&gt; 복호화한다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Client 랜덤 데이터, Server 랜덤 데이터&lt;/strong&gt; 와 함께 &lt;strong&gt;Session Key&lt;/strong&gt;를 유도한다.&lt;/li&gt;
&lt;li&gt;이 Session Key로 암호화된 데이터 통신을 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;핸드쉐이크 잘 되었다고 알리고 끝&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Opinions&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;pre master secret, client random, server random, session 등 많은 키가 생성되고 사용되어서 많이 헷갈린다.&lt;/li&gt;
&lt;li&gt;cloudflare 블로그에서 그림을 잘 그려놨다고 하던데 보러가야징&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.geeksforgeeks.org/secure-socket-layer-ssl/&quot;&gt;https://www.geeksforgeeks.org/secure-socket-layer-ssl/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://opentutorials.org/course/228/4894&quot;&gt;https://opentutorials.org/course/228/4894&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://learningnetwork.cisco.com/s/question/0D53i00000Kt0q0/which-layer-of-the-osi-model-do-ssl-and-tls-belong-to&quot;&gt;https://learningnetwork.cisco.com/s/question/0D53i00000Kt0q0/which-layer-of-the-osi-model-do-ssl-and-tls-belong-to&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://dokydoky.tistory.com/462&quot;&gt;https://dokydoky.tistory.com/462&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[50 주차 회고 [2021]]]></title><description><![CDATA[한 것, 배운 점 요즘 TDD…]]></description><link>https://blog.seongjun.kr/week-50-2021-retrospective/</link><guid isPermaLink="false">https://blog.seongjun.kr/week-50-2021-retrospective/</guid><pubDate>Sun, 19 Dec 2021 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;한 것, 배운 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;요즘 TDD에 관해 공부하고 있다.&lt;/li&gt;
&lt;li&gt;슬.. 퇴사각 잡아보는 중&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;잘한 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;꾸역꾸역 스터디 과제 다 했음&lt;/li&gt;
&lt;li&gt;알골을 좀 덜 풀긴 했는데 하루도 놓친 적은 없다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;개선할 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;아 이거 써야지 하고 생각한 게 있지만 기억을 못했다 ㅜ&lt;/li&gt;
&lt;li&gt;낭비되는 시간을 더 줄이자&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;생각&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;연말이지만 어차피 코로나 때문에 사람들 안 만나기도 하고, 더 집중해야겠다.&lt;/li&gt;
&lt;li&gt;외로운 싸움이 될 듯 흐그 ㅜㅠㅠㅜ&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[HTTPS 와 SSL]]></title><description><![CDATA[https에 대해서 certbot 혹은 aws acm으로 SSL 인증서를 적용 시키는 것 외에 제대로 된 개념을 알고있지 못했다. 그냥 보안이 좋다더라? 정도밖에.. 이참에 알아보자 HTTP - HyperText Transfer Protocol…]]></description><link>https://blog.seongjun.kr/https-and-ssl/</link><guid isPermaLink="false">https://blog.seongjun.kr/https-and-ssl/</guid><pubDate>Sun, 12 Dec 2021 00:00:00 GMT</pubDate><content:encoded>&lt;ul&gt;
&lt;li&gt;https에 대해서 certbot 혹은 aws acm으로 SSL 인증서를 적용 시키는 것 외에 제대로 된 개념을 알고있지 못했다.&lt;/li&gt;
&lt;li&gt;그냥 보안이 좋다더라? 정도밖에..&lt;/li&gt;
&lt;li&gt;이참에 알아보자&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;HTTP - HyperText Transfer Protocol&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;데이터를 주고받을 수 있는 프로토콜 ( 규칙 )&lt;/li&gt;
&lt;li&gt;클라이언트와 서버 사이에 이루어지는 요청와 응답 프로토콜&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;주로 TCP를 이용한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;del&gt;HTTP/3 부터는 UDP를 쓴다는데 왜 그런걸까? 글 거리 하나 추가...&lt;/del&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;비연결성 프로토콜이다.&lt;/li&gt;
&lt;li&gt;HTTP에서는 전송되는 정보가 암호화되지 않는다.&lt;/li&gt;
&lt;li&gt;서버와 클라이언트가 서로 주고받는 메시지를 감청당하기 쉬움&lt;/li&gt;
&lt;li&gt;기본 포트 80&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;HTTPS - HTTP + Secure&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;HTTP에서 보안이 강화된 버전&lt;/li&gt;
&lt;li&gt;HTTPS에서는 SSL( Secure Sockets Layer ) 을 사용한다.&lt;/li&gt;
&lt;li&gt;클라이언트와 서버간의 메시지를 암호화 한다!&lt;/li&gt;
&lt;li&gt;기본 포트 443&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c9704515bd0d051bd8c25aba08cf952f/ffe51/2021-12-13-01-53-32.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 43.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAACJUlEQVQozz1SS4uSURg+ft84LlS8S6hIKF4n75mLQMTbwiGoZhhw4f0uoiiIu7buWupuaBc00B8YM4JmFQXu2gRBTSExEC0aGnVOz/lADzw8532/c573/d7nEKVSuSeXy3mVSsURQkSTyYSwhVhgSqkAmUz2ViwWU6lU+lcikTBQjUbzVK1WE2Bfq9Vy0OKI0Wgker1eYI7jSDabJQ6Hg0ynU5JMJgWwxfP8BdNXKBQbCG/YHuKPIUr8fj+x2WzEbDYTotPpnuHQGBVPrVaro1QqneVyufeVSmWez+ffAbN+v383lUq9SSQSFFjF4/ENClGgAPEjNPPEZDIl0FiKBAKBl3a7/bXBYJhD8GGz2byqVqsUIrRer1O2Hw6H9zqdznm326Wj0Wg9GAxu2T6TyYzR4Rfc+wx8gOhHYT5YEsC2WCz20f7S5/NRr9d7A75FfJ1Op93hcHjG8ojX4HUwGKTRaPQR7okBGcA84InFYvmBf/+FStcikegQya9sPpjZmjFwg6EfgGcsxhmW33473hq3W4VCQYaKdzDgBycnJ3KXy7V0Op0UvGYM/IvFYm6Px3MOs1h+hdzK7XbTUCh0FIlECOI9poVihKCzMZ7Ic3R0Cqd8tVrtJ4yhjUaDlstlhg1mdoD8fJuHYQLa7fZxq9UiAL/rEJVeQOgMb+gCLt3HwU9w9qpYLF6i+yXwrdfrOWDOK+T+oMB3CF+Cf0PoECYSYCf4HzP1zqmRiNsgAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2021 12 13 01 53 32&apos; title=&apos;2021 12 13 01 53 32&apos; src=&apos;/static/c9704515bd0d051bd8c25aba08cf952f/ca1dc/2021-12-13-01-53-32.png&apos; srcset=&apos;/static/c9704515bd0d051bd8c25aba08cf952f/e7570/2021-12-13-01-53-32.png 170w,
/static/c9704515bd0d051bd8c25aba08cf952f/f46e7/2021-12-13-01-53-32.png 340w,
/static/c9704515bd0d051bd8c25aba08cf952f/ca1dc/2021-12-13-01-53-32.png 680w,
/static/c9704515bd0d051bd8c25aba08cf952f/02d09/2021-12-13-01-53-32.png 1020w,
/static/c9704515bd0d051bd8c25aba08cf952f/9d567/2021-12-13-01-53-32.png 1360w,
/static/c9704515bd0d051bd8c25aba08cf952f/ffe51/2021-12-13-01-53-32.png 2018w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;그림과 같이 Application Layer와 Transport Layer 사이에 위치&lt;/li&gt;
&lt;li&gt;Application Layer에서 받은 데이터를 암호화하여 TCP로 전달&lt;/li&gt;
&lt;li&gt;TCP에서 받은 데이터는 복호화하여 Application에 전달한다&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;TCP에서는 SSL을 Application처럼, Application에선  SSL을 TCP처럼 인식한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;기존 전달 방식 그대로 사용하게 됨&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;보안 계층을 하나 둬서 암/복호화를 하여 안전하게 메시지를 전달한다.&lt;/p&gt;
&lt;h1&gt;SSL과 TLS&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;SSL - Secure Sockets Layer / TSL - Transport Layer Security&lt;/li&gt;
&lt;li&gt;TSL의 과거명칭이 SSL이며 같은 말임 근데 SSL이 더 많이 쓰인다.&lt;/li&gt;
&lt;li&gt;데이터를 안전하게 전송하기 위한 암호화 통신 프로토콜&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;암호화를 해서 안전하게 만든다는 것은 알겠다. 하지만 어떻게 암호화를 해서 안전하게 만든다는 것일까?&lt;/p&gt;
&lt;h2&gt;SSL에서 사용하는 암호화&lt;/h2&gt;
&lt;h3&gt;1. 대칭키 방식&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;동일한 키로 암호화와 복호화를 같이 할 수 있는 방식&lt;/li&gt;
&lt;li&gt;발신자와 수신자가 모두 공유키를 갖고있어야 한다.&lt;/li&gt;
&lt;li&gt;공유키가 노출되면 위험하다.&lt;/li&gt;
&lt;li&gt;적은 컴퓨터 자원을 사용, 효율적&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;2. 공개키 암호화 방식&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;개인 키 ( Private key, 비공개 키 ), 공개 키 ( Public key )를 이용한다.&lt;/li&gt;
&lt;li&gt;공개키로 암호화 하고 비공개키로 복호화 할 수 있다.&lt;/li&gt;
&lt;li&gt;공개키는 노출이 되어도 상관 없다.&lt;/li&gt;
&lt;li&gt;계산하는데 복잡하고 자원사용도가 높다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;3. 공개키와 대칭키를 혼합해서 사용하는 SSL&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;공개키 암호화 방식은 리소스를 많이 잡아먹는다고 했다.&lt;/li&gt;
&lt;li&gt;따라서 실제로 SSL에서는 대칭키와 공개키를 &lt;strong&gt;혼합&lt;/strong&gt;하여 사용&lt;/li&gt;
&lt;li&gt;클라이언트와 서버가 주고받는 정보는 &lt;strong&gt;대칭키&lt;/strong&gt; 방식으로 암호화&lt;/li&gt;
&lt;li&gt;위에서 &lt;strong&gt;사용할 대칭키&lt;/strong&gt;는 &lt;strong&gt;공개키 방식&lt;/strong&gt;으로 암호화해서 주고 받음&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;4. 공개키 암호화 방식의 문제 - CA 그리고 SSL 인증서&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;공개키가 진짜인지 가짜인지 증명할 수가 없다.&lt;/li&gt;
&lt;li&gt;도중에 해커가 공개키를 바꿔치기 했을 수도 있다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;따라서 인증 기관 ( Certificate Authority - CA )이 발급한 공개키 증명서를 사용한다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;인증 기관에 서버의 공개키를 제출한다&lt;/li&gt;
&lt;li&gt;인증 기관에서는 제출된 공개키에 인증기관의 비밀키로 디지털 서명을 하여 공개키 인증서를 만든다.&lt;/li&gt;
&lt;li&gt;서버는 이 공개키 인증서를 클라이언트에 보낸다.&lt;/li&gt;
&lt;li&gt;클라이언트는 인증기관의 공개키를 사용하여 인증서를 복호화 한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;각 인증기관의 리스트와 공개키들은 클라이언트의 브라우저에 이미 저장되어있다.&lt;/li&gt;
&lt;li&gt;따라서 클라이언트는 서버에서 보내준 공개키의 신뢰성을 보장할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;opinion&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;HTTPS는 HTTP과 달리 보안계층을 하나 둬서 보안이 더 좋다.&lt;/li&gt;
&lt;li&gt;보안 계층(SSL)은 TCP와 HTTP (application) 사이에 위치한다.&lt;/li&gt;
&lt;li&gt;SSL은 공개키와 대칭키를 혼합해서 사용한다.&lt;/li&gt;
&lt;li&gt;신뢰 가능한 공개키를 사용하기 위해서 CA에서 발급해준 인증서를 사용한다.&lt;/li&gt;
&lt;li&gt;생각보다 길어졌다 글을 좀 나누도록 하겠다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;++ 사실 보안 계층이 OSI 7 계층에서 어디에 위치한걸까 고민했다. &lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://learningnetwork.cisco.com/s/question/0D53i00000Kt0q0/which-layer-of-the-osi-model-do-ssl-and-tls-belong-to&quot;&gt;조금 구글링을 해봤는데&lt;/a&gt;  OSI 7계층이 명확하게 일치하는 모델은 아니라는 의견도 있었고&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://security.stackexchange.com/questions/25568/how-valid-is-this-statement-ssl-sit-between-application-layer-and-network-layer&quot;&gt;Session Layer&lt;/a&gt;라는 의견, &lt;a href=&quot;https://www.techtarget.com/searchnetworking/definition/OSI&quot;&gt;Presentation Layer&lt;/a&gt; Transport Layer 라는 의견 등 다양했다.&lt;/p&gt;
&lt;p&gt;명확히 어느 한 계층에 속해서 동작하는 것이 아닌 Application Layer와 Transport Layer 사이의 독립적인 계층을 만들어서 동작하는 것 이라고 이해하고 넘어갔다&lt;/p&gt;
&lt;h1&gt;References&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.geeksforgeeks.org/secure-socket-layer-ssl/&quot;&gt;https://www.geeksforgeeks.org/secure-socket-layer-ssl/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://opentutorials.org/course/228/4894&quot;&gt;https://opentutorials.org/course/228/4894&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://learningnetwork.cisco.com/s/question/0D53i00000Kt0q0/which-layer-of-the-osi-model-do-ssl-and-tls-belong-to&quot;&gt;https://learningnetwork.cisco.com/s/question/0D53i00000Kt0q0/which-layer-of-the-osi-model-do-ssl-and-tls-belong-to&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[49 주차 회고 [2021]]]></title><description><![CDATA[한 것, 배운 점 루비 메타프로그래밍 관련하여 예전에 적어놨던 글을 다시 정비하고 게시했다. 부족해서 가려둔 글이 많은데 언제 다 올리나 싶다 새벽 4시에 지금 4…]]></description><link>https://blog.seongjun.kr/week-49-2021-retrospective/</link><guid isPermaLink="false">https://blog.seongjun.kr/week-49-2021-retrospective/</guid><pubDate>Sun, 12 Dec 2021 00:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;한 것, 배운 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;루비 메타프로그래밍 관련하여 예전에 적어놨던 글을 다시 정비하고 게시했다.&lt;/li&gt;
&lt;li&gt;부족해서 가려둔 글이 많은데 언제 다 올리나 싶다&lt;/li&gt;
&lt;li&gt;새벽 4시에 지금 49주차 회고를 쓰고 있다 출근 언제하지... &lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;잘한 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;딱히 없는 듯 하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;개선할 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;뭐 했나 싶다 스터디 과제 마감까지 직전에 다 끝냈다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;생각&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;깊게 알아가는 재미가 있다.&lt;/li&gt;
&lt;li&gt;회고를 따로 분리해서 보관해야하나 고민이다. 쿼리에서 필터만 해서 안 보이게 할까 아니면 완전히 분리를 할까...&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;퇴사 고민을 하고있다. 회사에 남아있는 것 보다 혼자서 공부하는 게 더 성장이 빠를 것 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;회사 사람들하고 스터디를 3개정도 하고있는데 이게 쫌 아쉽다.&lt;/li&gt;
&lt;li&gt;알골, cs, 책 스터디 ( 리펙터링 )&lt;/li&gt;
&lt;li&gt;알골은 유지 가능할 듯?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[1password + ssh key password]]></title><description><![CDATA[ssh key를 비밀번호 없이 사용하는 경우가 많았다. 혹은 항상 쓰던 비밀번호를 썼다. 회사, 개인, 사이드플젝, 외주 등 각각 ssh-key…]]></description><link>https://blog.seongjun.kr/op-ssh/</link><guid isPermaLink="false">https://blog.seongjun.kr/op-ssh/</guid><pubDate>Sun, 05 Dec 2021 00:00:00 GMT</pubDate><content:encoded>&lt;ul&gt;
&lt;li&gt;ssh key를 비밀번호 없이 사용하는 경우가 많았다. 혹은 항상 쓰던 비밀번호를 썼다.&lt;/li&gt;
&lt;li&gt;회사, 개인, 사이드플젝, 외주 등 각각 ssh-key를 따로 관리했는데 비밀번호를 안 쓰는 것에 죄책감을 느끼기 시작함&lt;/li&gt;
&lt;li&gt;만약 노트북이 열린 채로 털리면 터미널 히스토리 보고 서버 접속 가능할 듯?&lt;/li&gt;
&lt;li&gt;1password를 결제해서 쓰고 있는데 1password cli를 사용해서 어떻게 못 할까?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;라는 니즈에서 스크립트를 짜놓고 작년부터 썼는데 이제 글로 옮겨적기&lt;/p&gt;
&lt;h2&gt;1password 란?&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;1password는 패스워드를 관리하는 프로그램이다.&lt;/li&gt;
&lt;li&gt;패스워드 및 각종 신용카드 정보나 민감한 개인 정보들을 관리하고 쉽게 사용할 수 있다.&lt;/li&gt;
&lt;li&gt;mac, window, android, iphone, 크롬 확장프로그램, cli에서도 사용 가능하다.&lt;/li&gt;
&lt;li&gt;모든 사이트의 비밀번호를 다르게 사용해도 1password를 사용해서 auto complete를 할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Need to be installed - expect, op&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;1password cli ( op ), jq, expect 가 설치되어있어야 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;expect&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;macos&lt;/strong&gt; - 맥에선 원래 expect가 설치 되어있다. ㅎㅎ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ubuntu&lt;/strong&gt; - &lt;code class=&quot;language-text&quot;&gt;sudo apt-get install expect&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;1password command line&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://1password.com/downloads/command-line/&quot;&gt;1password cli&lt;/a&gt; 에서 설치!&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;jq&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;brew install jq&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;ssh-key 저장해두기&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;비밀번호를 굉장히 복잡하게 설정하거나 1password으로 만들어냅니다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ssh-keygen&lt;/code&gt; 을 통해 ssh-key를 하나 생성하고 비밀번호를 1.의 비밀번호로 설정합니다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;1password에 저장합니다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;public key와 private key도 저장해두면 pc가 뿌셔져도 괜찮습니다.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;tags를 꼭 ssh-key 로 해둡니다.&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/373f7f610b98e04f0b66bae7eb741b5c/79586/2021-12-05-20-09-58.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 90.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAADR0lEQVQ4y6VUyW7TQBh2SZpuHBASdEkTxx5v493O2jpbl7RFRRQkrlhCQlzLnUfgAeABOLdISJxB4sKTVDkhcQPG/vlnmpQuBw5E+hTHnnzzLf9Ykgq1UkK1xxaVn1fW1FRXjJSafuracerQEK+DVCdOSnU7dUw7JTU9JbKeajUjNVQrpYbzzDbcF5ZuD3b7+xJ+inLSaH7vdnsQujHgIjAUAoFtQ933wTUMIJUKtFsJuDQGzw6gEbbAtTxAUjAJFdAU4ysASNLcjES8sH3WS/aQoP5bLhO2NdxmD4+eMpkOmeIM2brZY82owY7TQ9ZptFnkNxg6QZgMSX/hNyhV8gXVFaTZ4hwJ7GCctBMI3DirldW8++Q4H7w6yZeOPuQLj07z4v77vLUxyt+9eZknnc089ps5kuTohoNxV0TWzgkLt4ok8urj7cEudBqbmbyuwVY3gYPRCKpVFww9AEI8MDUHqO6DbXjAFWGOU3CloE4JS6jQo8G4tzkA3w4zvptJLNBrOpgqZqSaoMkaBE4E2/0RdDs9aNc3wHdCkXnoxcw1fVCrE8LZQomEbjTeGY6gFXcyHjYSi8BFQQh+TQ0Xy2gLYk6EriD269COOywK61CrqdMMSwQJhELH8jLH9EST1wltQdgBS7Mv7KIq/pxZpg2KMillfm6BIMk49hs8m8yj/g1CbBS/qVDHN3TQInfCN8ENGMV8LywXZooEcxhvtrq4yM84MSe9TEhkA3b6BvQ2bNjuqRC5OJuyNX0uWr4ohWcYOH8tI+kNhdzewS6Fg50EhomKGRJQKqZYw2fxCmFp9rzl7kZflIJqudKrGeJYuKaOJWiwO2zDIOkDd9TD/+CpYedjNCGUpBnSiFrjB3uH0IxaWT1sipHgqv5myNWgiqolZtHDKXB51jTA9h0kvKSQl4IWx3y2MPQMyXOMIEfC6UkQp2J6MrCgHNVfxlXLd+/cVVHuGbeITf3GFhnuzCYLmaFY4sxOMSnhAnjv54TwsyBcmF/UMLMfmJ8YCf4muV7Kv2DiSKGjb4JwafH2vdXl8lvEx9X7ayeVsnwqr9dO8fdpeWVdYG2lLHB+fQMneP/T6vLaayS8xV+IM4gSYuk/UbSILf0BLDa8CC2SAsYAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2021 12 05 20 09 58&apos; title=&apos;2021 12 05 20 09 58&apos; src=&apos;/static/373f7f610b98e04f0b66bae7eb741b5c/ca1dc/2021-12-05-20-09-58.png&apos; srcset=&apos;/static/373f7f610b98e04f0b66bae7eb741b5c/e7570/2021-12-05-20-09-58.png 170w,
/static/373f7f610b98e04f0b66bae7eb741b5c/f46e7/2021-12-05-20-09-58.png 340w,
/static/373f7f610b98e04f0b66bae7eb741b5c/ca1dc/2021-12-05-20-09-58.png 680w,
/static/373f7f610b98e04f0b66bae7eb741b5c/79586/2021-12-05-20-09-58.png 932w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;script&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;아래 스크립트를 아무 곳에나 잘 위치 시키고 ( 나는 &lt;code class=&quot;language-text&quot;&gt;~/.custom/op_ssh.sh&lt;/code&gt; 로 해뒀음)&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;실행 권한을 준다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;chmod +x 파일명.sh&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;alias&lt;/code&gt; 를 설정한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;alias op_ssh=~/.custom/op_ssh.sh&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sh&quot;&gt;&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;#!/bin/bash

if [ $# -eq 0 ]; then
  echo &amp;quot;ssh path 경로 없음&amp;quot;
else
  ssh_path=&amp;quot;${1}&amp;quot;
  title=&amp;quot;$(echo $ssh_path | tr &amp;#39;/&amp;#39; &amp;#39;\n&amp;#39; | tail -n1)&amp;quot;
  uuid=$(op list items --tags ssh-key | jq --arg title &amp;quot;$title&amp;quot; &amp;#39;.[] | select(.overview.title == $title).uuid&amp;#39; | sed -e &amp;#39;s/^&amp;quot;//&amp;#39; -e &amp;#39;s/&amp;quot;$//&amp;#39;)
  if [ -z &amp;quot;$uuid&amp;quot; ]; then
    echo &amp;quot;Need 1password Sign In&amp;quot;
  else
    password=$(op get item $uuid | jq &amp;#39;.details.sections[1].fields[] | select(.t == &amp;quot;password&amp;quot;).v&amp;#39; | sed -e &amp;#39;s/^&amp;quot;//&amp;#39; -e &amp;#39;s/&amp;quot;$//&amp;#39;)
    expect &amp;lt;&amp;lt;EOL
  spawn ssh-add $ssh_path
  expect &amp;quot;Enter passphrase for *&amp;quot;
  send &amp;quot;$password&amp;quot;
  send &amp;quot;\n&amp;quot;
  expect &amp;quot;Identity added: *&amp;quot;
EOL
  fi
fi&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;사용&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;op cli 로그인을 한다.&lt;/li&gt;
&lt;li&gt;로그인 하고자하는 키의 경로를 매개변수로 두고 커맨드 실행&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/171f3c7ee35a98e2681d789dc73cbb64/59080/2021-12-05-20-31-19.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAxklEQVQY012Q2w6CMBBEqwISFBF5IPET8AYqbQEtN43x/z9oXIoX4sOk2+72dKbMFgUCIRHIEkFxg5dWmCYFzEOuZcU5pnGB8U6CRSnYhv8UcYy3HBbNO2cF63gB8/MaoWoIdse6fFL9wCprsZQN5mkJO7nA2Gd0UfTAjzQwhbETmJBG1DfpYeZfW4RXhQVXcMmdTyBP1LSv9Pqp3QG8Uw/mGmh2KcidRX3mCIXZKadI4js81GQvyYGk+JmWPvuL332N/Qa+AFrFc+Gw+s4qAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2021 12 05 20 31 19&apos; title=&apos;2021 12 05 20 31 19&apos; src=&apos;/static/171f3c7ee35a98e2681d789dc73cbb64/ca1dc/2021-12-05-20-31-19.png&apos; srcset=&apos;/static/171f3c7ee35a98e2681d789dc73cbb64/e7570/2021-12-05-20-31-19.png 170w,
/static/171f3c7ee35a98e2681d789dc73cbb64/f46e7/2021-12-05-20-31-19.png 340w,
/static/171f3c7ee35a98e2681d789dc73cbb64/ca1dc/2021-12-05-20-31-19.png 680w,
/static/171f3c7ee35a98e2681d789dc73cbb64/59080/2021-12-05-20-31-19.png 893w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;next?&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;gist 올려두고 자동화&lt;/li&gt;
&lt;li&gt;1password 비밀번호 입력도 불편하다, touch id로 안 되나?&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[48 주차 회고 [2021]]]></title><description><![CDATA[이번 주는 코테 준비로 가득 채운 한 주였다. 한 것, 배운 점 우리 프론트엔드 코드에서 관심사를 나눠놓는 방식이 과연 좋은 건가? 다른 방식은 없나?하고 많이 찾아봤다. https://itnext.io/what-are-front-end-service…]]></description><link>https://blog.seongjun.kr/week-48-2021-retrospective/</link><guid isPermaLink="false">https://blog.seongjun.kr/week-48-2021-retrospective/</guid><pubDate>Sat, 04 Dec 2021 00:00:00 GMT</pubDate><content:encoded>&lt;ul&gt;
&lt;li&gt;이번 주는 코테 준비로 가득 채운 한 주였다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;한 것, 배운 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;우리 프론트엔드 코드에서 관심사를 나눠놓는 방식이 과연 좋은 건가? 다른 방식은 없나?하고 많이 찾아봤다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://itnext.io/what-are-front-end-service-layers-4dba95db21bb&quot;&gt;https://itnext.io/what-are-front-end-service-layers-4dba95db21bb&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://dev.to/mmcshinsky/a-simple-approach-to-managing-api-calls-1lo6&quot;&gt;https://dev.to/mmcshinsky/a-simple-approach-to-managing-api-calls-1lo6&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;boj 문제 일주일동안 30문제정도 풀었다. 골드 1~3은 거의 시간초과로 못푼듯 ㅜ&lt;/li&gt;
&lt;li&gt;배민 커리어 코칭을 했다. 사실 정보를 얻는 것 보단 내가 하고있는 게 맞는지를 확인해보는 시간이었던 것 같다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;잘한 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;스터디 딱히 못 한 것 없이 잘 마무리했다. + 블로그 글을 작성함&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;개선할 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;디자인 패턴에 대해 더 공부해야겠다. GOF?&lt;/li&gt;
&lt;li&gt;네이버웹툰, 카카오웹툰 삭제해야겠다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;생각&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;아직 혼자서 성장할 수 있는 여지가 많이 남아있었던 것 같다.&lt;/li&gt;
&lt;li&gt;급할 필요없다.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[47 주차 회고 [2021]]]></title><description><![CDATA[…]]></description><link>https://blog.seongjun.kr/week-47-2021-retrospective/</link><guid isPermaLink="false">https://blog.seongjun.kr/week-47-2021-retrospective/</guid><pubDate>Sun, 28 Nov 2021 00:00:00 GMT</pubDate><content:encoded>&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://stibee.com/api/v1.0/emails/share/KxPb9t2oAVziTFMbnZSyAOXiuE4Suw==&quot;&gt;당근메일 - &lt;strong&gt;자신을 빠르게 성장시키는 &apos;회고&apos;&lt;/strong&gt;&lt;/a&gt; 을 보고 주간 회고를 해봐야겠다고 마음먹었다.&lt;/li&gt;
&lt;li&gt;일주일 단위로 하면 어느 정도 부담이 덜 하지 않을까?&lt;/li&gt;
&lt;li&gt;매주 일요일 아침을 회고를 위한 시간으로 ! - 오늘은 일어나자마자 카페에서 가서 할 일 하느라...&lt;/li&gt;
&lt;li&gt;적당히 한 것, 배운 점, 잘한 점이랑 개선할 점을 쓸까 한다.&lt;/li&gt;
&lt;li&gt;사실 회사 일은 어느 정도까지 공개해도 되는지 잘 모르겠다... 최대한 덜어내고 추상적으로 쓰는 방향으로&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;한 것, 배운 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ssh tunneling 으로 vpc안의 rds를 접근 해봤다&lt;/li&gt;
&lt;li&gt;aws session manager를 통해 port forwarding을 해보고 proxy ec2안에서 socat으로 해당 포트와 rds 를 연결해봤음&lt;/li&gt;
&lt;li&gt;매번 ssh key의 비밀번호를 치기 힘들어서 만들어놓은 1password cli shell script가 더 귀찮아져서 swift 로 touch id를 써서 비밀번호 입력하는 소스를 짜보고 있다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;스터디&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;매일 알고리즘을 풀었다.&lt;/li&gt;
&lt;li&gt;객체지향의 사실과 오해 chapter 4까지 읽었다.&lt;/li&gt;
&lt;li&gt;CS study 운영체제 과제도 시간 내로 냈고 공부도 적당히 한 듯&lt;/li&gt;
&lt;li&gt;데이터베이스 스터디 과제 시간 내로 잘 냄!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;블로그를 리뉴얼하고 레쥬메를 리뉴얼해보는 중!&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;잘한 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;이번 주는 스터디 딱히 못 한 것 없이 잘 마무리했다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;힙서비 콘텐츠 챌린지를 통해 강제였지만 어쨌든 블로그 글을 작성함&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;아 이거 써야지 하고 메모만 해둔게 &lt;strong&gt;33개&lt;/strong&gt; , quiver 메모는 &lt;strong&gt;165개&lt;/strong&gt; .... 어지간히 안 했다...&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;주말에 평소보다 일찍 일어나서 바로 나갔다. 집에 있으면 나태해진다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;개선할 점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;손이 아파서 파라핀을 매일 하기로 했는데 한 번도 안 했다.,., ( 효과가 있는지는 모르겠음 )&lt;/li&gt;
&lt;li&gt;클라이밍을 최소 주 2회~3회 하기로 했는데 한 번밖에 못했다... 월욜에 하려다가 개발하는 게 막혀서 붙잡고 있다가 ㅜㅜ&lt;/li&gt;
&lt;li&gt;이력서를 써보기로 했는데 제대로 못 씀&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;생각&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;이직을 하던 안 하던 이력서를 분기마다 업데이트하고 시장에서 자신의 가치를 확인해보는 것이 좋다고 생각한다.&lt;/li&gt;
&lt;li&gt;과연 회사 입장에서 내가 매력적인 지원자가 맞을까?&lt;/li&gt;
&lt;li&gt;내가 여태까지 해 온 것을 복기해보고 모자란 것을 찾아본다. 내가 가고 있는 길이 맞는지를 한 번 돌아볼 필요가 있다.&lt;/li&gt;
&lt;li&gt;늘 이런 생각을 하고 돌아 볼 때마다 많이 모자란다고 느낀다.&lt;/li&gt;
&lt;li&gt;여태까지 너무 고여있던 것 아닌가 실패와 좌절을 겪어본 적 없으니 흐를 필요성을 못 느끼는 것 아닌가.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[gh-pages, custom domain(cname) 적용 안 될 때 (gatsby-gh-pages-action)]]></title><description><![CDATA[새 블로그를  으로 배포하고 있다.  브랜치에 푸시가 되면 github action으로 빌드를 하고, gh-pages로 푸시를 한다. gh-pages으로 정적 페이지들이 올라가면 이를 블로그로 사용한다 ( ) 사용법은 대충 github action…]]></description><link>https://blog.seongjun.kr/gh-pages-cname/</link><guid isPermaLink="false">https://blog.seongjun.kr/gh-pages-cname/</guid><pubDate>Sat, 27 Nov 2021 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;새 블로그를 &lt;code class=&quot;language-text&quot;&gt;gatsby-gh-pages-action&lt;/code&gt; 으로 배포하고 있다.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt; 브랜치에 푸시가 되면 github action으로 빌드를 하고, gh-pages로 푸시를 한다.&lt;/p&gt;
&lt;p&gt;gh-pages으로 정적 페이지들이 올라가면 이를 블로그로 사용한다 ( &lt;code class=&quot;language-text&quot;&gt;gmkseta.github.io&lt;/code&gt;)&lt;/p&gt;
&lt;p&gt;사용법은 대충 github action 만들고 세팅에서 사진처럼 설정하면 끝인데&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; CI

&lt;span class=&quot;token key atrule&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;branches&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; main
    &lt;span class=&quot;token key atrule&quot;&gt;paths-ignore&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;**/README.md&quot;&lt;/span&gt;

&lt;span class=&quot;token key atrule&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;token key atrule&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token key atrule&quot;&gt;runs-on&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ubuntu&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;latest
    &lt;span class=&quot;token key atrule&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; actions/checkout@v2
        &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;token&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ACCESS_TOKEN &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;submodules&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;

      &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;uses&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; enriikke/gatsby&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;gh&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;pages&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;action@v2
        &lt;span class=&quot;token key atrule&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;access-token&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; $&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; secrets.ACCESS_TOKEN &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;token key atrule&quot;&gt;deploy-branch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; gh&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;pages
          &lt;span class=&quot;token key atrule&quot;&gt;skip-publish&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/f11953d50d39795ec6ea5f78303975ff/1e052/2021-11-28-23-48-18.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 62.35294117647059%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACBElEQVQoz22TWXfaMBCF/dYQMF4ly7Ll3RjMYqAsTZPT9vT//6fbkQwkOenDd0aLdTV3xrJktUUz/ELZn7E5XCFUjVBkYHFu4LJAlFYIzZzGSUVrpRnzpDRz/f3UYQZrJgRsJeGoBE4aIygzg1/kBMVSRwUvT4gUPqGjlyWPNT12Mok5aVlOJSFPLdrXPdq3A/rfJ5QvB8TXM+T1BPnjgujYI1grIvs/fYZwm8MtE1ieIHURY+IHmAThGInn4CMhpiEzzDSMwWYcNid3PBqJBGYBh1Uvd9jsL0iLhUFmDdKyQ6Lnt6jRtdX7PG3gyg4OL6hmdJHLHvUzNeRU8OXuZLi8/kWzGrDYHPH95Y9Z02L1cqCmKLgshsMSyi6FHcSYepStxx9ocSurV1hThqtBH27BZG4QWU1dLEiIGiNyIzL1xS2rMbO7yMexVbRr7C9v2J1+UmYHskm28wYxCUq6QFUdmCKbSQc3KjBzP2f1JUM/Uqi6LcrFhg6v8GT7+DbzPvFETGyXoDgP8ey8M3UCk/VDMG9W6LZHg7ao7fqCfhFitKvgU9TrpgQUg9u+y1M4UYk5Uw/rlq6brl8/nKHtC1VRY3Zo+z1qalBPf8FgStGZMuh9Jgsj7tMLcWVLovm7oBPG5iPdBJdJshTQU7s9NzqY0cEqLclSZMqh9++Mln1j+275H3DFOZ5sY7JSAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2021 11 28 23 48 18&apos; title=&apos;2021 11 28 23 48 18&apos; src=&apos;/static/f11953d50d39795ec6ea5f78303975ff/ca1dc/2021-11-28-23-48-18.png&apos; srcset=&apos;/static/f11953d50d39795ec6ea5f78303975ff/e7570/2021-11-28-23-48-18.png 170w,
/static/f11953d50d39795ec6ea5f78303975ff/f46e7/2021-11-28-23-48-18.png 340w,
/static/f11953d50d39795ec6ea5f78303975ff/ca1dc/2021-11-28-23-48-18.png 680w,
/static/f11953d50d39795ec6ea5f78303975ff/1e052/2021-11-28-23-48-18.png 872w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;문제&lt;/h2&gt;
&lt;h3&gt;배포할 때 마다 Custom Domain 설정이 사라진다...?&lt;/h3&gt;
&lt;h2&gt;원인을 찾아보자.&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;github docs를 찾아봤더니 다음과 같은 글이 나왔다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/14d298eb9d5c84cc06defa477ef25640/d2c78/2021-11-28-23-54-38.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 75.88235294117648%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACc0lEQVQ4y1VUV5vaQAzkKckVDgwG3GgGN4oNuNByd7mUL///F000MjjJg9BK3tWORrO0eiMPi3gLP9rAnYfo2xM8vPTx1B3gsWM29nSzJpbvzR5dD/FsDNAaOFNs8xO2hxNWuxKTZYKOaaM7cGBK8e7A1XXHdNQbAsAYurqHZgwlb1pSbKhFWzwUbfZYJinC9Q7x9oBIbJUV9SXio00dM7/eVdgcjkgkDlYZgvSI6apCu28r4pZhTeHFJewghxMW4vdiB7hxBTsS8zcNWiIzhh5IU98aq2+bHjr2Es89qy6oCLc5QkERrveCsF4Hsk6yUuM4zesOpBMiTdJCc4zn4Uq4rTln2y1r7OPy/gtZcUZ1/cD57Sfy8xvKyzccX7/ruji/y/oH8tMb9sev6rkvKy8oZJ8zDXSQWpBDqfnYqb/zpDnhtOavVOMeIo5uPN+59UQdDcKRN1fZkBMWp2wG7gwm15IjJczT90ZjzfWtSfPtzm09ZQ5FAupv7Ed609iPMQvWcGeB5hh74rnv01MXn58NtS/t3j9r4y9C/kxFe7vqqnxlxUVbTvOzenI2WcRgJ850CUcusicLjWlDd64xlaAI+cNN5Iu8UYvkZykao1FzRMrD9mSpRd1ZKN3UHdkS8xtFrgX5dBZxiuvHbzVOlII+yRRPMllewPbdGzKiJSVJykFVEidKRdMy3yc3UCaH4yt25VWfICVUXb9rcU6XOqSfhxv4MkRO3Y+2ks8EoY92b1QjpH5IPN8zhU0ueZht8TALUvh847NwjbEgXN04Zmd3xP9xyKCWQy2dl76lQn0U4zQfXnr6r6I58czV+X5j95b/AGOdoDXk8vU5AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2021 11 28 23 54 38&apos; title=&apos;2021 11 28 23 54 38&apos; src=&apos;/static/14d298eb9d5c84cc06defa477ef25640/ca1dc/2021-11-28-23-54-38.png&apos; srcset=&apos;/static/14d298eb9d5c84cc06defa477ef25640/e7570/2021-11-28-23-54-38.png 170w,
/static/14d298eb9d5c84cc06defa477ef25640/f46e7/2021-11-28-23-54-38.png 340w,
/static/14d298eb9d5c84cc06defa477ef25640/ca1dc/2021-11-28-23-54-38.png 680w,
/static/14d298eb9d5c84cc06defa477ef25640/d2c78/2021-11-28-23-54-38.png 812w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;대충 읽어보자면 CNAME file에 저장이 된다는데....&lt;/li&gt;
&lt;li&gt;한번 gh-pages 브랜치를 살펴보자..&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/ba102ac6a3a5bdfb11094f68ad58902c/ed9c8/2021-11-28-23-55-30.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 94.11764705882352%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAADO0lEQVQ4y01UyXbjRgzkNWONTXEnu7nvkqg1tmfevElyTQ655P+/pVIAZY0PeC31A6qrCgAdL63glwvC+oiwuSBsb/BMj21ksNlG+OolPOP7GWEbW1TDAZGpEWYVsrKHnxTImwkvQQbHiyzivIcAB7aDb1qYeoQbpFrw7Cc8SyanvMvg+RYZ84K0RJI3GmnRPgg4Pn/YooEXZSyO8cLwyOKrFytYkBYKKACeyREuNbwuV3DJeXJDPb+8BHo6sa0xn95Q9XtkVa+sJNYXY5VXdju0wxH5fkb/3w35z1nvYksicU7JueaLCseUHcbDFc14RDefKaEjYM3kllaskZUDknJEVgywdkIQroxDUymIhKgRto5IktfqYU+WO02M1ZsWCb0RBVqYtnDDTO+8xCorsUZ8E6AnN1o9lIKSQPKChBRJ5zRogRie0GPXDNphy4Z5BJOuCnsB+Yg7wxJ5OymQXAh98UaDTCOyix4MjTLfcjLchMwL1kU564IHqCPJ/e4Mn9KlU8qwWhmaavjEcFSGph5Uat6MOjJS85mlIyNRtPNjBISh+LR62KmHsa3gpp12MmUTBdC3PaJy5jmsHn5Ilokvu1n/yGsCmBJImMmZ5LWCutm6PcJcAGVcxBLx/TNLRwAEsBkXjMv1wU5BWfyxDSugva9ajml3pFWn1d9g9X8jDAVQOiZj090TIjJSyfk6NnL3kFys5+vbuwKKz7IIKyAZumFKdrINE19vddVM1a/BBsidNGVrR5VqeRekOf79528uxEU/EvJx+JgSZ7PN6AU7Voxk1pN+wYSGRS1flo9ArbGJejbOIuCd5OwIJuq+PAf3wQ5XD9sxwev3Eb9/m3D7NmJeLJZrjeVSY3di4THXu3ZfUmKK063FuM/4eLVulinZ4fBXU6ZDjB9/jnj/MeD6XhHM4Pbe4PJa4nAxOJwz7M8ppqMhuDze4sgc8dVUEzzL+fUj/PYsU0LJT3fJZX/iiyeV68X0hZJFns+N8JJV8sYzvJN1M5zdDmXL3DBEmMq3M+UnkJ8vl9/Bbj7icH0jk1duSafNkE2Q7lv5X3Hd8knHpeCISVPOtwl//HXDcm4x7wvslxJVa/A/T3T3qm7jKKEAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2021 11 28 23 55 30&apos; title=&apos;2021 11 28 23 55 30&apos; src=&apos;/static/ba102ac6a3a5bdfb11094f68ad58902c/ca1dc/2021-11-28-23-55-30.png&apos; srcset=&apos;/static/ba102ac6a3a5bdfb11094f68ad58902c/e7570/2021-11-28-23-55-30.png 170w,
/static/ba102ac6a3a5bdfb11094f68ad58902c/f46e7/2021-11-28-23-55-30.png 340w,
/static/ba102ac6a3a5bdfb11094f68ad58902c/ca1dc/2021-11-28-23-55-30.png 680w,
/static/ba102ac6a3a5bdfb11094f68ad58902c/02d09/2021-11-28-23-55-30.png 1020w,
/static/ba102ac6a3a5bdfb11094f68ad58902c/ed9c8/2021-11-28-23-55-30.png 1245w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;배포를 위해 빌드된 파일들이 들어가 있고, 잘 보니 CNAME 파일이 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c6b4027bf15dc23ac24fb438da157ff3/4c530/2021-11-28-23-58-26.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 39.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABMklEQVQoz41SSW7DMAz0tVsSW7K12ZbkLY2TBm3//7cpycBA2kPQw4BayJkhpaL0I6r+DJ2u0MM3VP5EaRN2yuBpr/FyqPF8F3fKIs1nNG2Gsj1CWlCZFv14wl47FMp2UC4JKhuhQ5ZkLqx9xKEOqEOi6FE2Adr1MHTPZ9pFWTPhW2XwWjYoPB3k4SiXe5NQugGmm4TsjUg5kZU5mdcstK03+DiJWxYt2Oq8fsHnE0y6QMcVNi5w/UREXhxy4i3eUJnuF3gEefkgtwMR5gXj+5VUZrGvbIuSisqmFdXK/EVHHYwiaNoRVrrJaPPxRljRDEOaZQ475aQ9busRtla3uW41fFbUPskL9eOKjmIT2GWUmT5GQpxWavUCR92xU01cBX8HVuLXZhXe89D/g/svtdX9AMDQzKnTbVlOAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2021 11 28 23 58 26&apos; title=&apos;2021 11 28 23 58 26&apos; src=&apos;/static/c6b4027bf15dc23ac24fb438da157ff3/ca1dc/2021-11-28-23-58-26.png&apos; srcset=&apos;/static/c6b4027bf15dc23ac24fb438da157ff3/e7570/2021-11-28-23-58-26.png 170w,
/static/c6b4027bf15dc23ac24fb438da157ff3/f46e7/2021-11-28-23-58-26.png 340w,
/static/c6b4027bf15dc23ac24fb438da157ff3/ca1dc/2021-11-28-23-58-26.png 680w,
/static/c6b4027bf15dc23ac24fb438da157ff3/02d09/2021-11-28-23-58-26.png 1020w,
/static/c6b4027bf15dc23ac24fb438da157ff3/4c530/2021-11-28-23-58-26.png 1252w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;설정에서 Custom Domain을 추가하면 CNAME 파일이 생성되어 설정한 Custom Domain이 들어간다.&lt;/li&gt;
&lt;li&gt;하지만 gh-pages 브랜치는 배포용이어서 늘 강제푸시되는 브랜치이고....&lt;/li&gt;
&lt;li&gt;main 브랜치에서는 CNAME이 없어서 설정은 빠지고, 설정해도 gh-pages브랜치만 반영이 된 것&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;해결&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;main branch에 CNAME 파일 하나 추가 - 끗&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/troubleshooting-custom-domains-and-github-pages#https-errors&quot;&gt;https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/troubleshooting-custom-domains-and-github-pages#https-errors&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[터미널에서 비밀번호 말고 touch id로 sudo 쓰기]]></title><description><![CDATA[요즘 애플워치로 맥 비밀번호( Touch ID )를 대신 하는 재미가 있다. 1password 비밀번호가 상당히 긴데 다 안 치고 애플워치( Touch ID )로 쓰니 쾌감 터미널에서도 sudo를 사용할 때 비밀번호를 touch id…]]></description><link>https://blog.seongjun.kr/sudo-with-touch-id/</link><guid isPermaLink="false">https://blog.seongjun.kr/sudo-with-touch-id/</guid><pubDate>Wed, 24 Nov 2021 00:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;요즘 애플워치로 맥 비밀번호( Touch ID )를 대신 하는 재미가 있다.&lt;/li&gt;
&lt;li&gt;1password 비밀번호가 상당히 긴데 다 안 치고 애플워치( Touch ID )로 쓰니 쾌감&lt;/li&gt;
&lt;li&gt;터미널에서도 sudo를 사용할 때 비밀번호를 touch id로 하는 법은 없을까 하다 검색해봤다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;선 1줄요약&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sh&quot;&gt;&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;curl -sL https://gist.githubusercontent.com/RichardBronosky/31660eb4b0f0ba5e673b9bc3c9148a70/raw/touchid_sudo.sh | bash&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Mac에서 Touch ID로 암호 대신 sudo 인증하기&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;원래는 &lt;code class=&quot;language-text&quot;&gt;sudo [command]&lt;/code&gt; 같이 sudo 권한을 사용하려고 하면 비밀번호로 인증을 해야한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 670px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/ccf600b6bd1da62cbbe2c0eb72c78e34/6bbca/2021-12-05-00-50-19.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 5.88235294117647%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAN0lEQVQI12NQcQ/8z2Fq81/c1vo/m77xfwYts/8M2lCsZYpgY8NAeUYd8//shtb/GYC0jJP3fwBu7xyDclSh9wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2021 12 05 00 50 19&apos; title=&apos;2021 12 05 00 50 19&apos; src=&apos;/static/ccf600b6bd1da62cbbe2c0eb72c78e34/6bbca/2021-12-05-00-50-19.png&apos; srcset=&apos;/static/ccf600b6bd1da62cbbe2c0eb72c78e34/e7570/2021-12-05-00-50-19.png 170w,
/static/ccf600b6bd1da62cbbe2c0eb72c78e34/f46e7/2021-12-05-00-50-19.png 340w,
/static/ccf600b6bd1da62cbbe2c0eb72c78e34/6bbca/2021-12-05-00-50-19.png 670w&apos; sizes=&apos;(max-width: 670px) 100vw, 670px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;먼저 &lt;code class=&quot;language-text&quot;&gt;/etc/pam.d/sudo&lt;/code&gt; 파일을 수정해야하는데 읽기만 가능한 파일이라 변경해야한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sh&quot;&gt;&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;sudo su
cd /etc/pam.d
chmod 755 sudo
# or chmod u+w /etc/pam.d/sudo&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;sudo&lt;/code&gt; 파일의 맨 윗 줄에 &lt;code class=&quot;language-text&quot;&gt;auth sufficient pam_tid.so&lt;/code&gt; 을 추가한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sh&quot;&gt;&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;vi sudo&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;# sudo file
auth       sufficient     pam_tid.so #  &amp;lt;&amp;lt;&amp;lt;&amp;lt; 이 부분을 추가합니다.
auth       sufficient     pam_smartcard.so
auth       required       pam_opendirectory.so
account    required       pam_permit.so
password   required       pam_deny.so
session    required       pam_permit.so&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;다시 읽기만 가능한 권한으로 변경해줍니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sh&quot;&gt;&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;chmod 444 sudo
# or chmod u-w sudo&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;끝!&lt;/p&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/98b782726aeea13a699b89ec31fb56a0/91652/2021-12-05-01-12-12.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 53.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3klEQVQoz62S32uSURyHj6sgRjdBrG3uh+nrz9ep89X3VZduqc1tKTKJMKONxRaOGlu1YEF1F7sd/QF1EQVFVGS2ftJ1N/UH+K8sns5e38BgBEIHHr7n4pznfD5wxK+9PQ5arVaLZ69e87LxjkZz16S5+5EnT58zkc4zHtPJFWbRjBQurx/FF8DjVxHff/zkxdsmjU9fTd58+Mz7L9+o377Dw3vbPNreYeH6Dda37lO/uUWxukB+vkqiUCY5UyaeL6Jop1FiaTwRA1FaWkX0KxxRItgcYwhHENuwjxNhg8cPdri1eJVUpUa+ukT2wiLG3HlCk3OoE2flnMUVyzAY1BkOJRnwRxG1zbuIoEFfJsXxpEGvfK1HjXMyZODQMtjDKU7J6dQmcUYzMs0UufIlSrUVihdX0KfnyVYuk5MMhROIytomYiTA4bCOLRhDBOIIX5Rj7hB2n8aAN0q/d7yNR+KO4NbSBBJZVIkzksJnTEnO0KdqsvLqhik8NJaUMh2h6m2pFIoRj8RtzQ7sLsSgs82QYu1dHN2vXKqvW0IZV1Y1pX/E/yJooe43a89emVZML68hRgP0mMKOhN1g3TGF5+obHQn/g7BwRX6bUfVvYTfSjvOmcGb52sHCbrGEvwGsGXGDr8vbpQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2021 12 05 01 12 12&apos; title=&apos;2021 12 05 01 12 12&apos; src=&apos;/static/98b782726aeea13a699b89ec31fb56a0/ca1dc/2021-12-05-01-12-12.png&apos; srcset=&apos;/static/98b782726aeea13a699b89ec31fb56a0/e7570/2021-12-05-01-12-12.png 170w,
/static/98b782726aeea13a699b89ec31fb56a0/f46e7/2021-12-05-01-12-12.png 340w,
/static/98b782726aeea13a699b89ec31fb56a0/ca1dc/2021-12-05-01-12-12.png 680w,
/static/98b782726aeea13a699b89ec31fb56a0/91652/2021-12-05-01-12-12.png 694w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 368px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/4d74a5e861406d94592f46e51462a355/55493/2021-12-05-01-13-09.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 121.76470588235296%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAIAAAB1KUohAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrklEQVQ4y82UuYpCQRBFnyLu+/7cV9wwcEEDwcgNVFAjQTAwMhY/QecHRIxNRfwSf8fYOfpgYAZHHYaRqaApuu/te6u63hMEQTAYDFqtVngUSqXSarXqdDqTyWQ0GmUy2WW3Vqv1+/1SqfQdTcJls9nhcFitVhuNRqvVUigUlzMu40qLxXJfGXdgsIms3W4X/l/o9XrsUY5kkuQxR2oMLZnNZuPxeDqdTiaT0Wg0n88rlcoH4B55MBh4PJ5oNHo8HlerlVqtJu92u0+Re72e1+stl8vn8/l0OmUymXA43Ol0niK3221RFH0+32632263vEogEGg2m/fI0kEikTgcDuv1erlcvl1jsVhsNpv9fh+LxQDI5fJ7fcYzsn6/nxXNYDAoXkOj0dzm4A1QPB5HmTFi4JLJpNvtpnOpVIrTUCjkdDrZRJ/TT2Sz2QwONZfLZbPZHA5HJBIBhzgJTHLIwMAAeNC8X4XsGiQqlYrK0+k0ZedyOd6cnAK/mr8ZkGlEvV5nZfig5fN5iqeKH3hhyBkYWlAsFvEiVf7szIMuFAqQpRL4n7z8g/2zR3pRvANqbVH9dYSwrwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2021 12 05 01 13 09&apos; title=&apos;2021 12 05 01 13 09&apos; src=&apos;/static/4d74a5e861406d94592f46e51462a355/55493/2021-12-05-01-13-09.png&apos; srcset=&apos;/static/4d74a5e861406d94592f46e51462a355/e7570/2021-12-05-01-13-09.png 170w,
/static/4d74a5e861406d94592f46e51462a355/f46e7/2021-12-05-01-13-09.png 340w,
/static/4d74a5e861406d94592f46e51462a355/55493/2021-12-05-01-13-09.png 368w&apos; sizes=&apos;(max-width: 368px) 100vw, 368px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;
&lt;ul&gt;
&lt;li&gt;애플워치에서도 잘 보입니다&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Reference&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://apple.stackexchange.com/questions/259093/can-touch-id-for-the-mac-touch-bar-authenticate-sudo-users-and-admin-privileges/306324#306324&quot;&gt;https://apple.stackexchange.com/questions/259093/can-touch-id-for-the-mac-touch-bar-authenticate-sudo-users-and-admin-privileges/306324#306324&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Binary Semaphore vs Mutex]]></title><description><![CDATA[예전에 누가 바이너리 세마포어와 뮤텍스의 차이가 뭐냐고 물었는데, 똑같은 거 아니냐 차이가 있나? 라고 답한 적이 있다. 요즘 os를 다시 공부하고 있는데 겸사겸사 알아보니 차이가 있더라... geeksforgeeks…]]></description><link>https://blog.seongjun.kr/26-difference-between-binary-semaphore-and-mutex/</link><guid isPermaLink="false">https://blog.seongjun.kr/26-difference-between-binary-semaphore-and-mutex/</guid><pubDate>Mon, 22 Nov 2021 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;예전에 누가 바이너리 세마포어와 뮤텍스의 차이가 뭐냐고 물었는데, 똑같은 거 아니냐 차이가 있나? 라고 답한 적이 있다.&lt;/p&gt;
&lt;p&gt;요즘 os를 다시 공부하고 있는데 겸사겸사 알아보니 차이가 있더라...&lt;/p&gt;
&lt;p&gt;geeksforgeeks에서 본 글이 제일 잘 정리가 되어있어서 보고 한글로 다시 정리를 해보고 한번 생각을 해봤다.&lt;/p&gt;
&lt;h2&gt;바이너리 세마포어 - Binary Semaphore&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;값을 0과 1만 가지는 세마포어임&lt;/li&gt;
&lt;li&gt;상호 배제(mutual exclusion) 를 위해 신호 전달 메커니즘을 사용해서 잠금을 구현함&lt;/li&gt;
&lt;li&gt;세마포어가 0이면 잠겨있는 것이고, 1이면 잠금이 해제된 것&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;뮤텍스 - Mutex&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;상호 배제를 locking과 unlocking으로 제공&lt;/li&gt;
&lt;li&gt;하나의 스레드만 전체 버퍼와 함께 작업 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;둘의 차이는?&lt;/h2&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;바이너리 세마포어&lt;/th&gt;
&lt;th&gt;뮤텍스&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;신호 전달 메커니즘 기반으로 동작&lt;/td&gt;
&lt;td&gt;잠금 메커니즘 기반으로 동작&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;현재 스레드보다 우선순위가 높은 스레드가 바이너리 세마포어를 해제하고 잠글 수 있음&lt;/td&gt;
&lt;td&gt;뮤텍스를 획득한 스레드는 크리티컬 섹션에서 나갈 때만 뮤텍스 해제 가능&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;값은 &lt;code class=&quot;language-text&quot;&gt;wait()&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;signal()&lt;/code&gt; 에 따라 변경&lt;/td&gt;
&lt;td&gt;값이 locked, unlocked 으로 수정&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;여러 개의 스레드가 동시에 이진 세마포어를 획득 가능&lt;/td&gt;
&lt;td&gt;한 번에 하나의 스레드만 뮤텍스를 획득 가능&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;소유권이 없다&lt;/td&gt;
&lt;td&gt;뮤텍스를 소유한 스레드만 잠금을 해제 가능하므로 소유권이 있음&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;다른 스레드/프로세스가 잠금 해제가 가능하기 때문에 뮤텍스보다 빠르다.&lt;/td&gt;
&lt;td&gt;획득한 스레드만 잠금 해제가 가능하므로 바이너리 세마포어보다 느리다.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2&gt;결론&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;결국 둘은 메커니즘이 다르고 사용법, 소유권, 동작 방식이 다르다.&lt;/li&gt;
&lt;li&gt;&lt;del&gt;하지만 아직도 좀 헷갈리는 것 같기도 하다. 검색해보면 mutex는 binary semaphore라고 써놓은 곳이 많았다. ㅠㅠ&lt;/del&gt;&lt;/li&gt;
&lt;li&gt;함수로써의 mutex가 아닌 상호배제라는 뜻으로 쓰인걸까...&lt;/li&gt;
&lt;li&gt;언뜻 보면 비슷해 보이지만 자세히 보면 다르다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ETC...&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;공부를 하다보니 내가 세마포어에 대해 제대로 알고있나 의심하게 되었다..&lt;/li&gt;
&lt;li&gt;세마포어는 여러 스레드/프로세스가 공유자원에 접근할 수 있게 하면서 어떻게 상호 배제를 지키는걸까?&lt;/li&gt;
&lt;li&gt;-&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;References&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.geeksforgeeks.org/difference-between-binary-semaphore-and-mutex/&quot;&gt;https://www.geeksforgeeks.org/difference-between-binary-semaphore-and-mutex/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://jwprogramming.tistory.com/13&quot;&gt;https://jwprogramming.tistory.com/13&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Infrastructure as code]]></title><description><![CDATA[Infrastructure as Code ( IaC ) 내가 IaC에 대해 알게된건 회사에서 aws의 강태호님과 미팅을 하게 되었을 때다. 기존에 회사에선 aws…]]></description><link>https://blog.seongjun.kr/23-InfraStructureAsCode/</link><guid isPermaLink="false">https://blog.seongjun.kr/23-InfraStructureAsCode/</guid><pubDate>Mon, 08 Nov 2021 00:00:00 GMT</pubDate><content:encoded>&lt;h1&gt;Infrastructure as Code ( IaC )&lt;/h1&gt;
&lt;p&gt;내가 IaC에 대해 알게된건 회사에서 aws의 강태호님과 미팅을 하게 되었을 때다.&lt;/p&gt;
&lt;p&gt;기존에 회사에선 aws 인프라를 수동으로 관리하고 있었다&lt;/p&gt;
&lt;p&gt;고객사의 프로젝트가 마무리되어서 인프라를 세팅해줄 때마다 aws console에 들어가서 수동으로 인프라를 세팅해줬다...&lt;/p&gt;
&lt;p&gt;몇번 하다보니 귀찮아져서 문서화를 해두고 사내 위키에 올려둔 뒤 가끔 다른 개발자 분들이 어려워 하실때 만 도와주러 갔다.&lt;/p&gt;
&lt;p&gt;하지만 이 방법도 내가 시간을 안쓸 뿐이지 다른 분들이 쓰게 만드는 해결책이였다.&lt;/p&gt;
&lt;p&gt;IaC에 대해 알게되고 테라폼 강의를 인프런에서 봤다. 거기서 강사님이 이런말을 한게 기억난다.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;IaC의 제일 좋은 도입 시기는 IaC라는 것에 대해 아는 순간이다.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;그때 강의를 들을때나 지금이나 그리고 미래에도 이 말에 대해 전적으로 동의한다.&lt;/p&gt;
&lt;h2&gt;Infrastructure as Code(IaC) - 코드로 인프라를 관리&lt;/h2&gt;
&lt;p&gt;수동 프로세스가 아닌 코드를 통해 인프라를 관리하고 &lt;a href=&quot;https://ko.wikipedia.org/wiki/%ED%94%84%EB%A1%9C%EB%B9%84%EC%A0%80%EB%8B%9D&quot; title=&quot;프로비저닝&quot;&gt;프로비저닝&lt;/a&gt;하는 것을 말한다.&lt;/p&gt;
&lt;p&gt;즉 인프라 구성, 관리를 마치 소프트웨어를 프로그래밍하는 것 처럼 처리한다.&lt;/p&gt;
&lt;p&gt;버전 관리도 중요하다, 다른 소프트웨어 코드들 처럼 버전 관리 시스템을 이용해서 관리해야한다.&lt;/p&gt;
&lt;h2&gt;수동으로 인프라를 관리했을 때의 단점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;서론에서 제 경험을 말했듯이 보통 메뉴얼을 만들고 관리를 할텐데 aws console이 업데이트되어 UI가 바뀐다면?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;문서도 다시 업데이트를 해줘야함..&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;기존에 구성되어있는 인프라에 대해 다른사람이 건드릴 일이 있다면?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;문서화가 잘 되어있지 않다면 어디에 어떤 리소스가 있는지 하나하나 찾아봐야함&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;똑같은 형태 혹은 비슷한 형태의 인프라를 재구성할 때 손으로 일일히 다시 ..&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;반복되는 노가다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;이를 해결해주는 IaC의 이점&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;원래 인프라를 수동으로 &lt;a href=&quot;https://ko.wikipedia.org/wiki/%ED%94%84%EB%A1%9C%EB%B9%84%EC%A0%80%EB%8B%9D&quot; title=&quot;프로비저닝&quot;&gt;프로비저닝&lt;/a&gt;하는 것은 시간이 많이 드는 일, 코드로 한 번 작성 해놓고나면 자동화가 된다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;aws console이 업데이트가 되던 말던 코드는 그대로 사용 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;IaC는 인프라의 구성 사양을 코드화하고 문서화함으로써 따로 인프라 구성 및 변경에 대한 문서화를 하지 않아도 된다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;어디에 어떤 리소스가 있는지 코드를 통해 확인이 가능함&lt;/li&gt;
&lt;li&gt;우리가 수동으로 직접 구성했을 때 누락하거나 잘못 설정하는 실수하는 경우를 방지&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;일관성이 향상된다.&lt;/li&gt;
&lt;li&gt;복제가 쉽다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;IaC 도구들&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;Terraform, Aws CloudFormation, Aws CDK&lt;/li&gt;
&lt;li&gt;Ansible, Chef, Puppet, Saltstack&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;1과 2의 차이가 살짝 있다. 서로 다른 목적으로 만들어졌다&lt;/p&gt;
&lt;p&gt;Terraform과 CloudFormation ( 1번 )은 프로비저닝 도구이며, 2번은 구성 관리 도구이다.&lt;/p&gt;
&lt;p&gt;1번은 인프라를 처음부터 설정하고 구성하는 것 이고 2번은 이미 구성된 인프라를 업데이트한다.&lt;/p&gt;
&lt;p&gt;몇몇 기능들이 중복되는게 있긴 하지만 보통 1번과 2번을 같이 사용한다.&lt;/p&gt;
&lt;p&gt;Terraform으로 ec2를 띄우고 ansible로 해당 ec2에 필요한 패키지를 설치한다던지 하는 방식으로 말이다.&lt;/p&gt;
&lt;p&gt;&lt;del&gt;나는 2 - terraform, cdk, ansible밖에 사용경험이 없어서 잘못 분류했을 수도 있다..&lt;/del&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[M Ruby - 12. Attribute Methods의 진화]]></title><description><![CDATA[대규모 시스템에서 메타크로그래밍을 사용할 때 어떤일이 발생하는지 여전히 궁금하다!! 이를 살펴보기 위해 Rails의 가장 인기 있는 기능중 하나인 attribute method…]]></description><link>https://blog.seongjun.kr/metaprogramming-ruby-12/</link><guid isPermaLink="false">https://blog.seongjun.kr/metaprogramming-ruby-12/</guid><pubDate>Mon, 31 May 2021 00:00:00 GMT</pubDate><content:encoded>&lt;ul&gt;
&lt;li&gt;대규모 시스템에서 메타크로그래밍을 사용할 때 어떤일이 발생하는지 여전히 궁금하다!!&lt;/li&gt;
&lt;li&gt;이를 살펴보기 위해 Rails의 가장 인기 있는 기능중 하나인 attribute method에 대해 살펴본다.&lt;/li&gt;
&lt;li&gt;참고로 모든 라인을 이해하려고 하지 말고 아이디어 만을 이해하려고 하자&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Attribute Methods의 사용&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;active_record&apos;&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Base&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;establish_connection &lt;span class=&quot;token symbol&quot;&gt;:adapter&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;sqlite3&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;token symbol&quot;&gt;:database&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;dbfile&quot;&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Base&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;connection&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create_table &lt;span class=&quot;token symbol&quot;&gt;:tasks&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;t&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;string   &lt;span class=&quot;token symbol&quot;&gt;:description&lt;/span&gt;
  t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;boolean  &lt;span class=&quot;token symbol&quot;&gt;:completed&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;위 처럼 데이터베이스에 tasks라는 테이블을 만든다면&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Task&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Base&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
task &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Task&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
task&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;description &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Clean up garage&apos;&lt;/span&gt;
task&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;completed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
task&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;save
task&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;description    &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;Clean up garage&quot;&lt;/span&gt;
task&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;completed&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# =&gt; true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ActiveRecord::Base&lt;/code&gt; 에서 상속하는 빈 Task 클래스를 정의할 수 있고, 해당 클래스의 객체를 사용하여 데이터베이스와 상호작용이 가능하다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;2개의 쓰기 accessor( 이하 접근자 )&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;description = , completed = &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;1개의 읽기 접근자&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;description&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;1개의 쿼리 접근자&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;completed?&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;4개의 접근자 모두 정의한 것이 아닌 Active Record에서 generated된 것이다.&lt;/li&gt;
&lt;li&gt;이러한 자동 생성 접근자를 attributes methods라고 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;복잡한 역사&lt;/h2&gt;
&lt;h3&gt;Rails 1: 간단한 시작&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;첫 버전에서는 단지 몇 줄의 코드&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Base&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attributes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token variable&quot;&gt;@attributes&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; attributes_from_column_definition
      &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;attribute_names&lt;/span&gt;&lt;/span&gt;
      &lt;span class=&quot;token variable&quot;&gt;@attributes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;keys&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sort
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    alias_method &lt;span class=&quot;token symbol&quot;&gt;:respond_to_without_attributes?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:respond_to?&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;respond_to&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token variable&quot;&gt;@@dynamic_methods&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; attribute_names &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;
                        attribute_names&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;collect &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;attr&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; attr &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;=&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;
                        attribute_names&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;collect &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;attr&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; attr &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;?&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;token variable&quot;&gt;@@dynamic_methods&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_s&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 
      respond_to_without_attributes&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;method_missing&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;arguments&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      method_name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; method_id&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id2name
      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; method_name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt; read_method&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@attributes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;$&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; read_attribute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;$&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;elsif&lt;/span&gt; method_name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt; write_method&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
        write_attribute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;$&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; arguments&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;elsif&lt;/span&gt; method_name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt; query_method&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; query_attribute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;$&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;read_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;a&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;zA&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Z&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;_\w&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;$&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;write_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;a&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;zA&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Z&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;_\w&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;$&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;query_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;a&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;zA&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Z&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;_\w&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;$&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;     &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;read_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attr_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;         &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;write_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attr_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;query_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attr_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;        &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;생성자를 먼저 살펴보자&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;@attributes&lt;/code&gt; 변수는 데이터베이스의 속성 이름으로 채워진다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;method_missing을 보자&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;해당 속성의 이름은 Ghost Method의 이름이 된다.&lt;/li&gt;
&lt;li&gt;description= 과 같은 메서드를 호출할 때 method&lt;em&gt;missing은 속성의 이름과, write&lt;/em&gt;method의 정규식에 일치한 다는 것을 알 수 있다.&lt;/li&gt;
&lt;li&gt;따라서 write_attribute(&quot;description&quot;)을 호출하게 된다. 다른 것 들도 비슷한 프로세스이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;3장에서 봤을때 method&lt;em&gt;missing과 함께 respond&lt;/em&gt;to? 를 재정의 하는 것이 좋은 아이디어라는 것을 배웠다 &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;예를 들어 &lt;code class=&quot;language-text&quot;&gt;my_task.description&lt;/code&gt; 이 호출 가능하면 &lt;code class=&quot;language-text&quot;&gt;my_task.respond_to?(:description)&lt;/code&gt; 이 true를 반환해야한다.&lt;/li&gt;
&lt;li&gt;재정의된 respond&lt;em&gt;to? 는 nil guard를 사용하여  `@@dynamic&lt;/em&gt;methods` 에 한 번만 계산하고 클래스 변수에 저장한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Rails 2: 성능에 초첨맞추기&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;method_missing에 대한 설명을 기억하는가?&lt;/li&gt;
&lt;li&gt;존재하지 않는 메서드를 호출하면 Ruby는 해당 메서드를 찾기위해 조상 체인으로 타고 올라간다.&lt;/li&gt;
&lt;li&gt;메서드를 찾지 못하고 BasicObject에 도달하면 맨 아래에서 다시 시작하여 method_missing을 호출한다.&lt;/li&gt;
&lt;li&gt;일반적으로 Ruby가 전체 조상 체인을 한 번 이상 걸어야 하기 때문에 일반 메서드보다 느리다.&lt;/li&gt;
&lt;li&gt;대부분 성능 차이는 무시할 수 있지만 attributes method는 매우 자주 호출 된다.&lt;/li&gt;
&lt;li&gt;define&lt;em&gt;method를 사용하고 method&lt;/em&gt;missing을 모두 제거하여 고스트메서드를 동적 메서드로 대체함으로써 이 성능 문제 해결이 가능하다.&lt;/li&gt;
&lt;li&gt;흥미롭게도 그들은 Ghost Method와 Dynamic Method를 모두 포함하는 혼합 솔루션을 택했다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;AttributeMethods&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;method_missing&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      method_name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; method_id&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_s
      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;private_method_defined&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;NoMethodError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Attempt to call private method&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; method_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# If we haven&apos;t generated any methods yet, generate them, then&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# see if we&apos;ve created the method we&apos;re looking for.&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;generated_methods&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;define_attribute_methods
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;generated_methods&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;read_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attr_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;         &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;write_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attr_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;query_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attr_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;        &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Task#description=&lt;/code&gt; 같은 메서드를 처음 호출하면 호출이 method_hissing으로 전달 된다.&lt;/li&gt;
&lt;li&gt;작업을 수행 전 private method 호출은 에러를 발생시킨다.&lt;/li&gt;
&lt;li&gt;그 다음 &lt;code class=&quot;language-text&quot;&gt;define_attribute_methods&lt;/code&gt; 을 호출한다. &lt;/li&gt;
&lt;li&gt;다음에 description= 또는 다른 접근자를 호출할 때 호출은 method_missing에 의해 처리되지 않는다.&lt;/li&gt;
&lt;li&gt;대신 고스트메서드가 아닌 실제 메서드를 호출한다.&lt;/li&gt;
&lt;li&gt;method_missing은 dynamic dispatch를 사용하여 이를 호출하고 결과를 받을 수 있다.&lt;/li&gt;
&lt;li&gt;이 프로세스는 &lt;code class=&quot;language-text&quot;&gt;generated_methods?&lt;/code&gt;로 인해 한 번만 발생하고 건너뛴다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;define_attribute_methods&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; generated_methods&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
  columns_hash&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; column&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; instance_method_already_implemented&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;serialized_attributes&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        define_read_method_for_serialized_attribute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;elsif&lt;/span&gt; create_time_zone_conversion_attribute&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; column&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        define_read_method_for_time_zone_conversion&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
        define_read_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_sym&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; column&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; instance_method_already_implemented&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;=&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; create_time_zone_conversion_attribute&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; column&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        define_write_method_for_time_zone_conversion&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
        define_write_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_sym&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; instance_method_already_implemented&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;?&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      define_question_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;instance_method_already_implemented?&lt;/code&gt; 속성 이름의 메서드가 이미 존재하면 이 코드는 다음 속성으로 건너뛴다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;define_read_method&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;define_write_method&lt;/code&gt; 와 같이 실제 작업을 수행하는 다른 메서드에 위임하는 것 외에는 거의 뭔가를 하지 않는다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;define_write_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attr_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  evaluate_attribute_method attr_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
     &lt;span class=&quot;token string&quot;&gt;&quot;def &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attr_name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;=(new_value);write_attribute(&apos;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attr_name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&apos;, new_value);end&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
     &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attr_name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;=&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;evaluate_attribute_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attr_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; method_definition&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; method_name&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;attr_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; method_name&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_s &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; primary_key&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_s
    generated_methods &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; method_name
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;begin&lt;/span&gt;
    class_eval&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_definition&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; __FILE__&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; __LINE__&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;rescue&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;SyntaxError&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; err
    generated_methods&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;delete&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attr_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; logger
      logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;warn &lt;span class=&quot;token string&quot;&gt;&quot;Exception occurred during reader method compilation.&quot;&lt;/span&gt;
      logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;warn &lt;span class=&quot;token string&quot;&gt;&quot;Maybe &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attr_name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; is not a valid Ruby identifier?&quot;&lt;/span&gt;
      logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;warn err&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;message
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;define_write_method&lt;/code&gt; 는 class eval을 통해서 String Code를 빌드한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;description=&lt;/code&gt; 을 호출하면 evaluate&lt;em&gt;attribute&lt;/em&gt;method가 다음 문자열을 eval한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;description&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;new_value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;write_attribute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;description&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; new_value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;속성에 처음 접근할 때 해당 속성은 고스트 메서드이다.&lt;/li&gt;
&lt;li&gt;method_missing을 통해 실제 메서드로 전환한다.&lt;/li&gt;
&lt;li&gt;모든 열에 대한 읽기, 쓰기, 쿼리 접근자를 동적으로 정의한다.&lt;/li&gt;
&lt;li&gt;하지만 모든 속성 접근자에 적용되지는 않는다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;동적으로 유지되는 속성&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;ActiveRecord를 통해 속성 접근자를 정의하고 싶지 않은 경우가 있다.&lt;/li&gt;
&lt;li&gt;계산된 필드 같이 데이터베이스 열이 지원하지 않는 속성을 생각해보자&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;my_query &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;tasks.*, (description like &apos;%garage%&apos;) as heavy_job&quot;&lt;/span&gt;
task &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Task&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;find&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:first&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:select&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; my_query&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
task&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;heavy_job&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# =&gt; true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;heavy_job 같은 속성은 객체마다 다를 수 있기 때문에 액세스하기 위해 동적 메서드를 생성할 필요가 없다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;AttributeMethods&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;method_missing&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;primary_key&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_s &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; method_name
        id
      &lt;span class=&quot;token keyword&quot;&gt;elsif&lt;/span&gt; md &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;match_attribute_method&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        attribute_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; method_type &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; md&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pre_match&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; md&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_s
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@attributes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attribute_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          __send__&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;attribute&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;method_type&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; attribute_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
          &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt; 
        &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;elsif&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@attributes&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        read_attribute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# Handle *? for method_missing.&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attribute_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        query_attribute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attribute_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# Handle *= for method_missing.&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attribute_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        write_attribute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attribute_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;method_missing 의 후반부를 보면 객체의 식별자에 액세스 하는 경우는 해당 값을 반환한다.&lt;/li&gt;
&lt;li&gt;속성 접근자를 호출하는 경우는 동적 디스패치 또는 read_attribute에 대한 직접 호출을 사용하여 접근자를 호출한다&lt;/li&gt;
&lt;li&gt;그렇지 않으면 super를 사용하여 상위 체인으로 호출을 보낸다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Rails 3,4 : 더 특별한 클래스&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;1에서는 수 십줄의 코드&lt;/li&gt;
&lt;li&gt;2에서는 자체 파일과 수백 줄의 코드&lt;/li&gt;
&lt;li&gt;3에서는 테스트를 포함하지 않은 9개의 소스 코드 파일&lt;/li&gt;
&lt;li&gt;Rails가 커짐에 따라 속성 메서드와 관련된 작은 트릭 및 성능 최적화, 코너 케이스를 발견했다.&lt;/li&gt;
&lt;li&gt;Rails 4에서는 더 나아가 속성 접근자를 정의할때 이를 UnboundMethod로 변환하여 메서드 캐시에 저장한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;AttributeMethods&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Read&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveSupport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Concern&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;methods_transplantable&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
          &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;define_method_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            method &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ReaderMethodCache&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
            generated_attribute_methods&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;module_eval &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; method &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
        &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
          &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;define_method_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
          &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
        &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;define&lt;em&gt;method&lt;/em&gt;attribute 라는 메서드를 정의한다.&lt;/li&gt;
&lt;li&gt;concern으로 인해 궁극적으로는 ActiveRecord::Base의 클래스 메서드가 된다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Module.methods_transplantable?에 따라 다르게 정의된다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;UnboundMethod를 다른 클래스 객체에 바인딩할 수 있나? - ruby 2.0 이상일 경우&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;define&lt;em&gt;method&lt;/em&gt;attribute는 메서드 캐시에서 UnboundMethod를 검색하고 메서드를 define_method로 현재 모듈에 바인딩한다.&lt;/li&gt;
&lt;li&gt;메서드 캐시는 ReaderMethodCache라는 상수에 저장된다.&lt;/li&gt;
&lt;li&gt;generated&lt;em&gt;attribute&lt;/em&gt;methods 은 클린 룸을 제공,&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;AttributeMethods&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Read&lt;/span&gt;
      &lt;span class=&quot;token constant&quot;&gt;ReaderMethodCache&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;AttributeMethodCache&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# We want to generate the methods via module_eval rather than&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# define_method, because define_method is slower on dispatch.&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# Evaluating many similar methods may use more memory as the instruction&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# sequences are duplicated and cached (in MRI).  define_method may&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# be slower on dispatch, but if you&apos;re careful about the closure&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# created, then define_method will consume much less memory.&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# But sometimes the database might return columns with&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# characters that are not allowed in normal method names (like&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# &apos;my_column(omg)&apos;. So to work around this we first define with&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# the __temp__ identifier, and then use alias method to rename&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# it to what we want.&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# We are also defining a constant to hold the frozen string of&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# the attribute name. Using a constant means that we do not have&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# to allocate an object on each call to the attribute method.&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# Making it frozen means that it doesn&apos;t get duped when used to&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# key the @attributes_cache in read_attribute&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;method_body&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; const_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;EOMETHOD&lt;/span&gt;
          &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#{method_name}&lt;/span&gt;
            name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;AttributeMethods&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;AttrNames&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;ATTR_&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;#{const_name}&lt;/span&gt;
            read_attribute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;n&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; missing_attribute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;n&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; caller&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
          &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
          &lt;span class=&quot;token constant&quot;&gt;EOMETHOD&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;ReaderMethodCache는 AttributeMethodCache의 하위 클래스인 익명 클래스의 인스턴스이다.&lt;/li&gt;
&lt;li&gt;이 클래스는 String of Code를 반환하는 단일 메서드를 정의한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;AttributeMethods&lt;/span&gt;
    &lt;span class=&quot;token constant&quot;&gt;AttrNames&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;set_name_cache&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        const_name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ATTR_&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; const_defined&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; const_name
          const_set const_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dup&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;freeze
        &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;    
    &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AttributeMethodCache&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;@module&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;@method_cache&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ThreadSafe&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Cache&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;@method_cache&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;compute_if_absent&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
          safe_name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;unpack&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;h*&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;first
          temp_method &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;__temp__&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;safe_name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
          &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;AttributeMethods&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;AttrNames&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;set_name_cache safe_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; name
          &lt;span class=&quot;token variable&quot;&gt;@module&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;module_eval method_body&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;temp_method&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; safe_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                              __FILE__&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; __LINE__
          &lt;span class=&quot;token variable&quot;&gt;@module&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_method temp_method
        &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;method_body&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;NotImplementedError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;AttrNames를 보자, set&lt;em&gt;name&lt;/em&gt;cache라는 단일 메서드가 있는 모듈이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이름과 값이 주어지면 메서드는 그 값으로 관습적으로 명명된 상수를 정의한다.&lt;/li&gt;
&lt;li&gt;&quot;description&quot; =&gt; &quot;ATTR_description&quot; &lt;/li&gt;
&lt;li&gt;AttrNames는 클린 룸과 유사하다.&lt;/li&gt;
&lt;li&gt;속성의 이름을 나타내는 상수를 저장하기 위해서만 존재한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;AttributeMethodCache를 보자 [] 메서드는 속성의 이름을 사용하고 해당 속성에 대한 접근자를 UnboundMethod로 반환&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;속성 접근자는 Ruby 메서드지만 모든 속성 이름이 유효한 Ruby 메서드 이름은 아니다.&lt;/li&gt;
&lt;li&gt;속성의 이름을 16진수 시퀀스로 디코딩하고 기존의 안전한 메서드 이름을 만들어 문제를 해결한다.&lt;/li&gt;
&lt;li&gt;접근자에 대한 안전한 이름이 있으면 method_body를 호출하여 접근자의 본문을 정의하는 코드 문자열을 가져오고&lt;/li&gt;
&lt;li&gt;단순히 @module이라는 이름의 클린룸 내부에 접근자를 정의한다.&lt;/li&gt;
&lt;li&gt;마지막으로 클린룸에서 새로 생성된 접근자 메서드를 가져와 UnboundMethod로 반환한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;후속 호출에서 AttributeMethodCache#[]은 더 이상 메서드를 저장할 필요가 없다.&lt;/li&gt;
&lt;li&gt;eotls @method&lt;em&gt;cache.compute&lt;/em&gt;if_absent가 결과를 저장하고 반환한다&lt;/li&gt;
&lt;li&gt;동일한 접근자가 여러 클래스에 정의된 경우 시간을 단축한다.&lt;/li&gt;
&lt;li&gt;ReaderMethodCache에서 method_body를 재정의하고 일기 접근자에 대한 코드 문자열을 반환함으로써 일반 AttributeMethodCache를 읽기 접근자를 위한 캐시로 바꾼다.&lt;/li&gt;
&lt;li&gt;WriterMethodCache도 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;교훈&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;코드에서 몇 가지 특수한 경우를 다뤄야하나?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;극단적인 경우에는 처음부터 완벽하고 되돌리지 않아도 되는 코드를 작성하기 위해 항상 노력할 수 있다.&lt;/li&gt;
&lt;li&gt;Do It Right First Time . &lt;/li&gt;
&lt;li&gt;하지만 다른 경우에는 당장의 명백한 문제를 해결하는 간단한 코드를 작성하고 나중에 더 특별한 경우를 발견하면 더 포괄적으로 만들 수 있다.&lt;/li&gt;
&lt;li&gt;이 접근 방식을 진화적 설계 라고 부르겠다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;이 두 가지 접근 방식 간의 올바른 균형을 맞추는 게 중요하다.&lt;/li&gt;
&lt;li&gt;Rails1 에서는 간단하고 단순한 솔루션, 2에서는 사용자의 요구사항에 따른 최적화 처럼 진화적인 설계의 좋은 예시이다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;다음을 포함하여 여러 대안이 있었다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;고스트 메서드에만 의존하여 접근자를 동적으로 정의하지 않는다.&lt;/li&gt;
&lt;li&gt;initialize 메소드에서 개체를 생성할 때 접근자를 정의한다.&lt;/li&gt;
&lt;li&gt;다른 속성이 아닌 액세스 중인 속성에 대해서만 접근자를 정의한다.&lt;/li&gt;
&lt;li&gt;항상 계산된 필드에 대한 접근자를 포함하여 각 개체에 대한 모든 접근자를 정의한다.&lt;/li&gt;
&lt;li&gt;String of Code 대신 define_method를 사용하여 접근자를 정의한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;몇 가지 대안의 디자인을 시도한 다음 실제 시스템에서 코드를 프로파일리하여 성능의 병목 현상이 발생한 위치를 찾은 다음 최적화하는 것을 쉽게 상상할 수 있다.&lt;/li&gt;
&lt;li&gt;이전 예제는 최적화에 중점을 뒀지만 동일한 원칙이 모든 측변에 적용된다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;private 메서드를 호출하기위해 method_missing을 쓰는 것을 막는 코드를 생각해보자&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;모든 경우를 다 잡는건 어렵다.&lt;/li&gt;
&lt;li&gt;합리적인 수의 특별한 경우를 다루고 더 많은 특별한 경우가 보이면 코드를 변경하는 것이 더 쉽다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Rails의 접근 방식은 진화적 설계에 치우져져 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;루비는 메타프로그래밍을 사용할 때 유연한 언어이므로 코드를 쉽게 발전시킬 수 있다.&lt;/li&gt;
&lt;li&gt;완벽한 메타프로그래밍 코드를 미리 작성하는 것은 어렵다. 모든 경우를 찾기 힘드니까.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;한 문장으로 요약하자면 코드를 최대한 단순하게 유지하고 필요한 만큼 복잡도를 추가하라 라는 뜻&lt;/li&gt;
&lt;li&gt;시작할 때 일반적인 경우에 코드를 올바르게 만들고 나중에 특별한 경우를 더 추가할 수 있을 정도로 간단하게 만들라. &lt;/li&gt;
&lt;li&gt;이것은 대부분의 코드에 대한 좋은 경험 법칙이지만 메타프로그래밍이 관련된 경우 특히 관련이 있다!&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[M Ruby - 11.alias_method_chain의 흥망성쇠]]></title><description><![CDATA[이전 두 장에서 Rails의 모듈 설계와 그 설계가 시간이 지남에 따라 어떻게 변했는지 살펴봤다. 이 장에서는 Rails 역사의 더 극적인 변화에 대해 이야기 해보도록 하겠다. 결국 Rails…]]></description><link>https://blog.seongjun.kr/metaprogramming-ruby-11/</link><guid isPermaLink="false">https://blog.seongjun.kr/metaprogramming-ruby-11/</guid><pubDate>Tue, 25 May 2021 00:00:00 GMT</pubDate><content:encoded>&lt;ul&gt;
&lt;li&gt;이전 두 장에서 Rails의 모듈 설계와 그 설계가 시간이 지남에 따라 어떻게 변했는지 살펴봤다.&lt;/li&gt;
&lt;li&gt;이 장에서는 Rails 역사의 더 극적인 변화에 대해 이야기 해보도록 하겠다.&lt;/li&gt;
&lt;li&gt;결국 Rails 코드베이스에서 거의 완전히 폐기된 &lt;code class=&quot;language-text&quot;&gt;alias_method_chain&lt;/code&gt;이라는 메서드가 어떻게 흥하고 망했는지&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;alias&lt;em&gt;method&lt;/em&gt;chain의 부흥&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Include - Extend 트릭에서 흥미로운 코드 조각을 보여줬었다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Validations&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;included&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# here&lt;/span&gt;
      base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;class_eval &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
        alias_method_chain &lt;span class=&quot;token symbol&quot;&gt;:save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:validation&lt;/span&gt;
        alias_method_chain &lt;span class=&quot;token symbol&quot;&gt;:save!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:validation&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# here&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;ActiveRecord::Base에 Validations 모듈이 포함되어 있으면 표시된 라인이 Base를 다시 열고 alias&lt;em&gt;method&lt;/em&gt;chain을 호출한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;alias&lt;em&gt;method&lt;/em&gt;chain를 썻던 이유&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Greeting 메서드를 정의하는 모듈이 있다고 가정한다. 다음 코드처럼 보일 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Greetings&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;greet&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Greetings&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;greet  &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;hello&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;만약 Greetings를 선택적인 기능으로 감싸고 싶다고 가정해보자.&lt;/li&gt;
&lt;li&gt;예를들어 인사말이 더 열정적이였으면 좋겠다&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Greetings&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;greet_with_enthusiasm&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;Hey, &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;greet_without_enthusiasm&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;!&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  alias_method &lt;span class=&quot;token symbol&quot;&gt;:greet_without_enthusiasm&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:greet&lt;/span&gt;
  alias_method &lt;span class=&quot;token symbol&quot;&gt;:greet&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:greet_with_enthusiasm&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;greet  &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;Hey, hello!&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;새로운 두 가지 메서드를 정의한다. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;greeting_without_enthusiasm&lt;/code&gt;는 원래 Greeting의 별칭이다.&lt;/li&gt;
&lt;li&gt;두 번째는 &lt;code class=&quot;language-text&quot;&gt;greeting_with_enthusiasm&lt;/code&gt; 은 &lt;code class=&quot;language-text&quot;&gt;greeting_without_enthusiasm&lt;/code&gt;을 호출하고 그 위를 추가단어로 감싼다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;이런식의 래핑하는 아이디어는 레일즈에서 일반적이다.&lt;/li&gt;
&lt;li&gt;method, method&lt;em&gt;with&lt;/em&gt;feature 및 method&lt;em&gt;without&lt;/em&gt;feature가 생긴다&lt;/li&gt;
&lt;li&gt;별칭을 여기저기 작성하는 대신 Rails에서는 이러한 작업을 수행하는 메타프로그래밍 방법을 제공했다.&lt;/li&gt;
&lt;li&gt;ActiveSupport 라이브러리의 일부였었다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;alias&lt;em&gt;method&lt;/em&gt;chain의 구현&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Module&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;alias_method_chain&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; feature&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Strip out punctuation on predicates or bang methods since&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# e.g. target?_without_feature is not a valid method name.&lt;/span&gt;
    aliased_target&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; punctuation &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; target&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_s&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sub&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;/([?!=])$/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; $&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;aliased_target&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; punctuation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; block_given&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
    with_method &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;aliased_target&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;_with_&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;feature&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;punctuation&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
    without_method &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;aliased_target&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;_without_&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;feature&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;punctuation&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
    alias_method without_method&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; target
    alias_method target&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; with_method
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;when&lt;/span&gt; public_method_defined&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;without_method&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;public&lt;/span&gt; target
    &lt;span class=&quot;token keyword&quot;&gt;when&lt;/span&gt; protected_method_defined&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;without_method&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;protected&lt;/span&gt; target
    &lt;span class=&quot;token keyword&quot;&gt;when&lt;/span&gt; private_method_defined&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;without_method&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; target
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;대상의 메서드 이름과 추가 기능의 이름을 사용한다.&lt;/li&gt;
&lt;li&gt;target&lt;em&gt;without&lt;/em&gt;feature / target&lt;em&gt;with&lt;/em&gt;feature 라는 이름의 두가지 새 메서드 이름을 eval한다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;원래 대상을 target&lt;em&gt;without&lt;/em&gt;feature으로 저장하고, target&lt;em&gt;with&lt;/em&gt;feature의 별칭을 target으로 지정한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;target&lt;em&gt;with&lt;/em&gt;feature라는 메서드가 동일한 모듈 어딘가에 있다고 가정함&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;마지막 스위치 케이스는 target&lt;em&gt;without&lt;/em&gt;feature의 원래 대상과 동일한 접근 제한자를 설정함&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ActiveRecord::Validation에서의 사용&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;included&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;class_eval &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    alias_method_chain &lt;span class=&quot;token symbol&quot;&gt;:save&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:validation&lt;/span&gt;
    alias_method_chain &lt;span class=&quot;token symbol&quot;&gt;:save!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:validation&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이 줄은 Validation을 포함시키는 ( ActiveRecord::Base ) 클래스를 다시 열고 save를 해킹한다&lt;/li&gt;
&lt;li&gt;유효성 검사를 자동으로 save 할때마다 추가할 수 있다.&lt;/li&gt;
&lt;li&gt;save&lt;em&gt;without&lt;/em&gt;validation이라고 하면 유효성 검사를 안하고 저장 가능하다.&lt;/li&gt;
&lt;li&gt;이 모듈은 save&lt;em&gt;with&lt;/em&gt;validation 및 save&lt;em&gt;with&lt;/em&gt;validation!을 구현해야겠지?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Validations&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;save_with_validation&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;perform_validation &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; perform_validation &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; valid&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;perform_validation
        save_without_validation
      &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;save_with_validation&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; valid&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
        save_without_validation&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;RecordInvalid&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;valid&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;#...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;실제 유효성 검사는 &lt;code class=&quot;language-text&quot;&gt;valid?&lt;/code&gt; 에서 일어난다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Validation#save_with_validation&lt;/code&gt;은 유효성 검사가 실패하거나 호출자가 유효성 검사를 명시적으로 비활성화 한 경우 false를 반환한다.&lt;/li&gt;
&lt;li&gt;그렇지 않으면 원래 save&lt;em&gt;without&lt;/em&gt;validation을호출한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;!&lt;/code&gt; 에서는 에러를 발생시킨다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;alias&lt;em&gt;method&lt;/em&gt;chain의 끝&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Rails 2에서의 많은 모듈이 alias&lt;em&gt;method&lt;/em&gt;chain을 사용하여 include하는 메서드의 기능을 래핑했다.&lt;/li&gt;
&lt;li&gt;결과적으로 alias&lt;em&gt;method&lt;/em&gt;chain은 Rails와 수 십개의 타사 라이브러리에서 모두 사용되었다.&lt;/li&gt;
&lt;li&gt;alias&lt;em&gt;method&lt;/em&gt;chain는 그저 Around Alias의 캡슐화일 뿐이고 &lt;a href=&quot;https://blog.seongjun.kr/metaprogramming-ruby-5&quot;&gt;예전 챕터&lt;/a&gt;에서의 문제점을 그대로 갖고있다.&lt;/li&gt;
&lt;li&gt;설상가상으로 alias&lt;em&gt;method&lt;/em&gt;chain많이 사용되면서 실제 메서드의 버전 추적이 어려워진다.&lt;/li&gt;
&lt;li&gt;그러나 alias&lt;em&gt;method&lt;/em&gt;chain의 가장 치명적인 문제는 대부분의 경우 불필요하다는 것,&lt;/li&gt;
&lt;li&gt;객체 지향 적인 관점에서 기존 메서드 주위에 기능을 래핑하는 보다 우아하고 내장된 방법을 제공한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Greetings&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;greet&lt;/span&gt;&lt;/span&gt;
   &lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; 
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Greetings&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;greet  &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;hello&quot;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;EnthusiasticGreetings&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;greet&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;Hey, &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;!&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;EnthusiasticGreetings&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ancestors&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;.2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# =&gt; [MyClass, EnthusiasticGreetings, Object]&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;greet        &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;hello&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;EnthusiasticGreetings&lt;/code&gt; 을 포함할 때 해당 모듈이 클래스의 조상 체인에 있는 클래스보다 더 높아진다.&lt;/li&gt;
&lt;li&gt;따라서 greet 함수는 모듈의 greet를 재정의한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;EnthusiasticGreetings&lt;/code&gt; 같은 중개 모듈을 삽입하고 오버라이드 및 super를 호출할 수 있다&lt;/li&gt;
&lt;li&gt;하지만 만약 클래스가 Rails같은 라이브러리의 일부이며 소스코드에서 직접 작업하지 않고 해당 라이브러리를 확장하므로 모든 경우에 그럴 수 있는게 아니다&lt;/li&gt;
&lt;li&gt;이 제한으로 인해 alias&lt;em&gt;metho&lt;/em&gt;chain을 쓰는 것&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;EnthusiasticGreetings&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;greet&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;Hey, &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;!&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;prepend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;EnthusiasticGreetings&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ancestors&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;.2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# =&gt; [EnthusiasticGreetings, MyClass, Object]&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;greet        &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;Hey, hello!&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Arounded Aliases에 대한 현대적인 대안인 prepended wrapper를 사용&lt;/li&gt;
&lt;li&gt;MyClass의 조상 체인에서 MyClass#greet보다 낮아서 재정의가 잘 된다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;교훈&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;이 책을 통해 메타프로그래밍이 얼마나 편리하고 우아하고 멋진지에 대해 배웠다&lt;/li&gt;
&lt;li&gt;하지만 alias&lt;em&gt;method&lt;/em&gt;chain에 대한 이야기는 경고에 가깝다.&lt;/li&gt;
&lt;li&gt;메타프로그래밍 코드는 때때로 복잡해질 수 있으며 심지어 더 전통적이고 단순한 기술을 간과하게 만들 수 있다.&lt;/li&gt;
&lt;li&gt;메타프로그래밍을 피하고 평범한 구식 OOP을 사용할 수 있다.&lt;/li&gt;
&lt;li&gt;코드를 너무 똑똑하게 만드려는 유혹에 저항하라는 교훈&lt;/li&gt;
&lt;li&gt;메타프로그래밍보다 목표를 달성하는 더 간단한 방법이 있는지 자문해본다.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[M Ruby - 10. Active Support's Concern Module]]></title><description><![CDATA[이전 장에서 모듈을 포함하면 인스턴스와 클래스 메서드 모두를 얻는 것을 알게되었다. Active Support 라이브러리에 있는 Concern 덕분에 가능 한 것 이전에 어떻게 되어있었고 어떤식으로 진화하는지 알아보자 Concern…]]></description><link>https://blog.seongjun.kr/metaprogramming-ruby-10/</link><guid isPermaLink="false">https://blog.seongjun.kr/metaprogramming-ruby-10/</guid><pubDate>Sun, 16 May 2021 00:00:00 GMT</pubDate><content:encoded>&lt;ul&gt;
&lt;li&gt;이전 장에서 모듈을 포함하면 인스턴스와 클래스 메서드 모두를 얻는 것을 알게되었다.&lt;/li&gt;
&lt;li&gt;Active Support 라이브러리에 있는 Concern 덕분에 가능 한 것&lt;/li&gt;
&lt;li&gt;이전에 어떻게 되어있었고 어떤식으로 진화하는지 알아보자&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Concern 이전의 레일즈&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;레일즈는 수년동안 많이 변경되었지만 기본 아이디어는 크게 변경되지 않았다&lt;/li&gt;
&lt;li&gt;그 중 하나가 ActiveRecord::Base 개념이다.&lt;/li&gt;
&lt;li&gt;이 클래스는 인스턴스 메서드와 클래스 메서드를 모두 정의하는 수십 개의 모듈로 이뤄져있다.&lt;/li&gt;
&lt;li&gt;이러한 메서드를 Base에 넣는 메커니즘이 변경되었다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Include, Extend 사용&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Rails2에서의 유효성 검사는 &lt;code class=&quot;language-text&quot;&gt;ActiveRecord::Validations&lt;/code&gt; 에 정의되어있다 ( 그때는 Active Model 없었음 )&lt;/li&gt;
&lt;li&gt;Validation은 독특한 트릭 사용&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Validations&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;included&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;validates_length_of&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;attrs&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;valid&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;낯익지 않나? VCR 예제에서 본 것 ( HTTP call )&lt;/li&gt;
&lt;li&gt;valid? 같은 Validation의 인스턴스 메서드는 Base의 인스턴스 메서드가 된다.&lt;/li&gt;
&lt;li&gt;Ruby는 hook method를 호출해서 base를 인수로 전달한다.&lt;/li&gt;
&lt;li&gt;Validations::ClassMethod를 이용하여 base를 extend 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;결과적으로 Base는 인스턴스 메서드와 클래스 메서드 모두 다 갖고올 수 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;include-and-extend 트릭이라고 부르도록 하겠다..&lt;/li&gt;
&lt;li&gt;수 많은 ruby, rails 프로젝트에서 이렇게 사용했다....&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;편리하지만 몇 개의 문제가 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클래스 메서드를 정의하는 각각의 모든 모듈은 해당 includer를 확장하는 훅도 정의해야한다.&lt;/li&gt;
&lt;li&gt;해당 훅이 수십 개의 모듈에 걸쳐 복제된다. 결과적으로 사람들이 이럴 가치가 있나? ..흠 한 줄 더 추가해서 해결이 가능..&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Validations&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Validations&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;하지만 더 깊은 문제가 있다!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;The Problem of Chained Inclusions&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;다른 모듈을 포함하는 모듈을 포함한다고 가정해보자.&lt;/li&gt;
&lt;li&gt;ActiveRecord::Validations는 ActiveModel::Validations 을 include한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;SecondLevelModule&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;included&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;second_level_instance_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;ok&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;second_level_class_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;ok&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;FirstLevelModule&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;included&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;first_level_instance_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;ok&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;first_level_class_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;ok&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;SecondLevelModule&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BaseClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;FirstLevelModule&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;두 모듈 모두 BaseClass의 조상에 있으니 두 모듈의 인스턴스 메서드를 모두 호출 가능하다.&lt;/li&gt;
&lt;li&gt;include와 extend 덕분에 클래스 메서드도 사용 가능하다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;하지만...&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;BaseClass.second_level_class_method # =&amp;gt; NoMethodError&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;SecondLevelModule.included를 호출할 때 기본 매개변수는 BaseClass가 아니라 FirstLevelModule&lt;/li&gt;
&lt;li&gt;결과적으로 SecondLevelModule::ClassMethods의 메서드는 FirstLevelModule의 클래스 메서드..&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;FirstLevelModule&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;included&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
    base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send &lt;span class=&quot;token symbol&quot;&gt;:include&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;SecondLevelModule&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이러한 구현은 덜 유연하다..&lt;/li&gt;
&lt;li&gt;다른 모듈과 첫 번째 레벨의 모듈을 구별해야하고, 각 모듈은 그것이 첫 번째 레벨인지 알아야한다..&lt;/li&gt;
&lt;li&gt;그리고 이 시대에는 Module#include가 프라이빗 메서드라 호출 못했음 ( Dynamic Dispatch 를 사용해야함) , 최근엔 Public&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;ActiveSupport::Concern&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ActiveSupport::Concern&lt;/code&gt;은 included-and-extend 트릭을 을 캡슐화하고 연결된 include문제를 수정한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;active_support&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyConcern&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveSupport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Concern&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;an_instance_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;an instance method&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;a_class_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;a class method&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyConcern&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;an_instance_method  &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;an instance method&quot;&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a_class_method          &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;a class method&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;어떻게 이게 되는걸까?&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Concern 코드 보기&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveSupport&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Concern&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MultipleIncludedBlocks&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;StandardError&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#:nodoc:&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Cannot define multiple &apos;included&apos; blocks for a Concern&quot;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;extended&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_variable_set&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@_dependencies&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;#...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Concern의 코드는 짧지만 복잡하다.&lt;/li&gt;
&lt;li&gt;excended및 append_features 메서드만 정의한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Module#append_features&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;append_features&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;C&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ancestors
&lt;span class=&quot;token comment&quot;&gt;# =&gt; [C, Object, Kernel, BasicObject]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;included는 일반적으로 비어있는 Hook 메서드였고 재정의 하려는 경우에만 존재했다.&lt;/li&gt;
&lt;li&gt;append_features는 실제 include가 일어나는 곳에 있다.&lt;/li&gt;
&lt;li&gt;append_features는 포함된 모듈이 이미 포함하는 모듈의 조상체인에 있는지 확인하고 그렇지 않으면 체인에 추가한다.&lt;/li&gt;
&lt;li&gt;일반적으로는 included를 재정의하지만 append_features를 재정의..해버리면 모듈이 전혀 포함 안 되게 할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Concern#append_features&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveSupport&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Concern&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;append_features&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Extension이 기억 나나?&lt;/li&gt;
&lt;li&gt;append_features는 Concern의 인스턴스 메서드이므로 Concern을 확장하는 모듈의 클래스 메서드가 된다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;즉 Validations라는 모듈이 Concern을 확장하면 Validations.append_features 클래스 메서드를 얻지&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;싱글톤 클래스들이 갖던거 기억하나?&lt;/li&gt;
&lt;li&gt;아뇨.. ㅜㅜ&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Concern을 확장하는 모듈은 @_dependencies 클래스 변수를 얻는다.&lt;/li&gt;
&lt;li&gt;append_features의 재정의를 얻는다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Inside Concern#append_features&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveSupport&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Concern&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;append_features&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_variable_defined&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@_dependencies&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_variable_get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@_dependencies&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; base &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;@_dependencies&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;dep&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:include&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; dep&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;
        base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; const_get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:ClassMethods&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; \
          &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; const_defined&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:ClassMethods&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;어렵지만 기본 아이디어는 간단하다.&lt;/li&gt;
&lt;li&gt;다른 concern에 concern을 include하지마!&lt;/li&gt;
&lt;li&gt;대신 concern이 서로를 include 하려할 때 종속성 그래프에 연결하기만 하면 된다.&lt;/li&gt;
&lt;li&gt;스스로 include하는 것이 아닌, 모든 종속성을 한번에 includer로 돌아서 include한다.&lt;/li&gt;
&lt;li&gt;self는 concern이다, 클래스 메서드로 실행이 되고, base는 관심사거나 이를 포함하는 모듈이다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;맨 처음 concern을 include하려고하면?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;@_dependencies 클래스 변수가 있는 것이 문제&lt;/li&gt;
&lt;li&gt;이를 조상 체인에 자신을 추가하는 대신 dependencies에 자신을 추가하고 include가 실제로 안 되었음을 알리기 위해 false&lt;/li&gt;
&lt;li&gt;예를들어 ActiveModel::Validations 이고, ActiveRecord::Validations에 포함되는 경우임!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;만약 Concern이 아닌 경우 -&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이미 이 포함자의 조상인지 확인한다. ( base &amp;#x3C; self )&lt;/li&gt;
&lt;li&gt;아닌 경우 종속성을 포함시킨다.&lt;/li&gt;
&lt;li&gt;예를들어 ActiveRecord::Validations이고, ActiveRecord::Base에 포함되는 경우임!&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;모든 종속성을 포함자의 조상 체인으로 롤링한 후에도 super으로 표준 append_features를 호출하여 조상 체인에 자신을 추가해야한다.&lt;/li&gt;
&lt;li&gt;ClassMethod 모듈로 includer를 확장해야한다. 이에대한 참조를 얻으려면 Kernel#const_get이 필요함&lt;/li&gt;
&lt;li&gt;Concern의 모듈 범위가 아닌 self의 범위에서 상수를 읽기 위함&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Concern Wrap Up&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ActiveSupport::Concern은 몇 줄의 코드로 단일 모듈로 래핑된 최소한의 종속성 관리 시스템&lt;/li&gt;
&lt;li&gt;그 코드는 복잡하지만, Active Model의 소스를 보면 알 수 있듯이 Concern을 사용하는 것은 쉽다&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveModel&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Validations&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveSupport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Concern&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;validate&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;일부는 이런 호출들 뒤에 숨겨진 너무 많은 마법들이 있고, 이런 숨겨진 복잡성엔 숨겨진 비용이 따른다고 한다.&lt;/li&gt;
&lt;li&gt;또 다른 일부는 Concern이 Rails 모듈을 최대한 슬림하고 단순하게 유지하는 데 도움을 준 것에.... 굿굿..&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;교훈&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;대부분의 언어에서는 구성 요소를 함께 묶는 방법이 많지 않다&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;클래스에서 상속하거나 객체에 위임할 수 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;멋지게 만들고 싶다면 종속성 관리를 전문으로 하는 라이브러리 또는 전체 프레임워크를 사용할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Rails의 개발자의 프레임워크의 일부를 함께 묶는 방법...&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;처음에는 아마도 모듈을 포함하고 확장했을 것이고&lt;/li&gt;
&lt;li&gt;나중에는 코드에 메타프로그래밍의 마법의 가루를 뿌리고 include-and-extend 트릭을 사용&lt;/li&gt;
&lt;li&gt;나중에 Rails가 계속 성장하면서 이 관용구가 가장자리에서 삐걱거리기 시작했고..&lt;/li&gt;
&lt;li&gt;include-and-extend를 메타프로그래밍이 많은 ActiveSupport::Concern으로 대체했습니다.&lt;/li&gt;
&lt;li&gt;그들은 한 번에 한 단계씩 자체 종속성 관리 시스템을 발전시켰습니다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;수년에 걸쳐 우리는 소프트웨어 설계가 &quot;처음부터 제대로 하는&quot; 일이 아니라는 것을 배웠다.&lt;/li&gt;
&lt;li&gt;이것은 모듈이 상호 작용하는 방식과 같이 근본적인 것을 변경하기 위해 메타프로그래밍을 사용할 수 있는 Ruby와 같은 가단성 언어에서 특히 그렇다..&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;메타프로그래밍은 영리해지는 것이 아니라 융통성에 관한 것&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;코드를 작성할 때 처음부터 완벽한 디자인을 위해 애쓰지 않고 복잡한 메타프로그래밍 트릭이 필요할 때까지 사용하지 않는다.&lt;/li&gt;
&lt;li&gt;대신 작업을 수행하는 가장 확실한 기술을 사용하여 코드를 단순하게 유지하려고 한다.&lt;/li&gt;
&lt;li&gt;어쩌면 어느 시점에서 내 코드가 엉키거나 완고한 중복을 발견할 수 있다..&lt;/li&gt;
&lt;li&gt;그 때 메타프로그래밍과 같은 더 좋은 방법을 찾게된다.&lt;/li&gt;
&lt;li&gt;이 책은 메타프로그래밍 성공 사례로 가득 차 있으며 ActiveSupport::Concern도 그 중 하나이다,....&lt;/li&gt;
&lt;li&gt;그러나 Concern의 복잡한 코드와 약간 논쟁의 여지가 있는 성격은 메타프로그래밍의 어두운 면을 암시한다...&lt;/li&gt;
&lt;li&gt;이것은 Rails의 가장 악명 높은 메소드에 대한 이야기를 살펴볼 다음 장의 주제&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[M Ruby - 9. The Design of Active Record]]></title><description><![CDATA[ActiveRecord는 루비의 객체를 데이터베이스 레코드에 매칭하는 Rails 라이브러리이다. 이러한 기능을 object relational mapping…]]></description><link>https://blog.seongjun.kr/metaprogramming-ruby-9/</link><guid isPermaLink="false">https://blog.seongjun.kr/metaprogramming-ruby-9/</guid><pubDate>Mon, 10 May 2021 00:00:00 GMT</pubDate><content:encoded>&lt;ul&gt;
&lt;li&gt;ActiveRecord는 루비의 객체를 데이터베이스 레코드에 매칭하는 Rails 라이브러리이다.&lt;/li&gt;
&lt;li&gt;이러한 기능을 object relational mapping이라고 하고, 관계형 데이터베이스와 객체지향 프로그래밍을 모두 잘 활용 가능하다.&lt;/li&gt;
&lt;li&gt;액티브 레코드가 하는 일 보다는 어떻게 하는지에 대해 관심있게 확인!&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;짧은 예시&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;active_record&apos;&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Base&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;establish_connection &lt;span class=&quot;token symbol&quot;&gt;:adapter&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;sqlite3&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;token symbol&quot;&gt;:database&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;dbfile&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Duck&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Base&lt;/span&gt;
  validate &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    errors&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:base&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Illegal duck name.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;D&apos;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ActiveRecord::Base&lt;/code&gt; 는 데이터베이스 연결같은 클래스 메서드 뿐만 아니라 매핑되는 모든 클래스의 슈퍼 클래스이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Duck&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Base&lt;/span&gt;
  validate &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    errors&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:base&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Illegal duck name.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; name&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;D&apos;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;유효성 검사를 하는 클래스 매크로이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Duck의 이름은 D로 시작해야한다!&lt;/li&gt;
&lt;li&gt;만약 다른 이름을 저장하려 하면 예외&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;convention에 따라서 Duck은 ducks 테이블애 매핑된다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ActiveRecord는 데이터베이스 스키마를 봐서 ducks에 name이 있다는 것을 알고, 그 필드에 접근 가능한 Ghost Method를 정의한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;my_duck &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Duck&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
my_duck&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Donald&quot;&lt;/span&gt;
my_duck&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;valid&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;         &lt;span class=&quot;token comment&quot;&gt;# =&gt; true&lt;/span&gt;
my_duck&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;save&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;

duck_from_database &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Duck&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;first
duck_from_database&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name         &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;Donald&quot;&lt;/span&gt;
duck_from_database&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;delete&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;ActiveRecord의 매커니즘&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;앞의 예는 간단하지만 사실 더 많은 것들을 할 수 있다.&lt;/li&gt;
&lt;li&gt;하지만 ActiveRecord::Base 에서는 그런 메서드들에 대한 추적이 없다.&lt;/li&gt;
&lt;li&gt;따라서 초보자에겐 어떤 메서드가 어디서왔고 어떻게 들어오는지 이해하기 어렵다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Autoloading 매커니즘&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;active_support&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;active_model&apos;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveSupport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Autoload&lt;/span&gt;
  autoload &lt;span class=&quot;token symbol&quot;&gt;:Base&lt;/span&gt;
  autoload &lt;span class=&quot;token symbol&quot;&gt;:NoTouching&lt;/span&gt;
  autoload &lt;span class=&quot;token symbol&quot;&gt;:Persistence&lt;/span&gt;
  autoload &lt;span class=&quot;token symbol&quot;&gt;:QueryCache&lt;/span&gt;
  autoload &lt;span class=&quot;token symbol&quot;&gt;:Querying&lt;/span&gt;
  autoload &lt;span class=&quot;token symbol&quot;&gt;:Validations&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ActiveRecord는 두 개의 라이브러리에 크게 의존한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ActiveSupport, ActiveModel&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;autoload&lt;/code&gt; 는 ActiveSupport의 메서드임&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ActiveSupport::Autoload&lt;/code&gt; 를 extend 하고 autoload는 ActiveRecord의 클래스 메서드가 된다.&lt;/li&gt;
&lt;li&gt;ActiveRecord는 autoload 클래스 매크로를 통해 수십개의 모듈을 등록한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ActiveRecord::Base&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Base&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveModel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Naming&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveSupport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Benchmarkable&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveSupport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;DescendantsTracker&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ConnectionHandling&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;QueryCache&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Querying&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Translation&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;DynamicMatchers&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Explain&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Enum&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Delegation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;DelegateCache&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Core&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Persistence&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;NoTouching&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ReadonlyAttributes&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ModelSchema&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Inheritance&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Scoping&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Sanitization&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;AttributeAssignment&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveModel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Conversion&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Integration&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Validations&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;CounterCache&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Locking&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Optimistic&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Locking&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Pessimistic&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;AttributeMethods&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Callbacks&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Timestamp&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Associations&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveModel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;SecurePassword&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;AutosaveAssociation&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;NestedAttributes&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Aggregations&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Transactions&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Reflection&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Serialization&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Store&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Core&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token constant&quot;&gt;ActiveSupport&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run_load_hooks&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:active_record&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Base&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;모듈을 통해 기능들을 조립하는 클래스는 흔하지 않지만 ActiveRecord::Base는 이 작업을 대규모로 수행한다.&lt;/li&gt;
&lt;li&gt;그냥 수십 개의 모듈을 확장하거나 포함할 뿐이다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;run_load_hooks&lt;/code&gt; 코드를 통해 이러한 모듈 일부가 로드된 후 자체 configuration코드를 실행 가능&lt;/li&gt;
&lt;li&gt;모듈의 소스코드가 필요하지 않고 그냥 Include를 한다, 이 덕분에 최소한의 코드로 많은 모듈을 사용 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Persistence&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;save&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;delete&lt;/span&gt;&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Base의 특정 메서드가 어디서 왔는지 그리 어렵지 않을 수 있다&lt;/li&gt;
&lt;li&gt;저장과 같은 persistence 메서드는 위와 같은 코드에서 확인이 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;유효성 검증 모듈&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;ActiveRecord::Validations&lt;/code&gt; - 관련 모듈인가...?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Validations&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveModel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Validations&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;valid&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;context &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;하지만 실제로 validate 메서드는 없음&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;ActiveModel::validations&lt;/code&gt; 에 있다~&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이런 모듈을 포함하여 조금 헷갈리는 세부사항이 있다.&lt;/p&gt;
&lt;p&gt;일반적으로 클래스는 모듈을 포함함으로써 인스턴스 메서드를 얻는다.&lt;/p&gt;
&lt;p&gt;하지만 validate는 ActiveRecord의 클래스 메서드이다. 어떻게 Base는 클래스 메서드를 얻을 수 있지?&lt;/p&gt;
&lt;p&gt;ActiveModel, ActiveRecord는 왜 두 모듈로 나뉘었나?&lt;/p&gt;
&lt;p&gt;크게 두 가지 작업&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;저장 및 로드와 같은 데이터베이스 작업을 처리&lt;/li&gt;
&lt;li&gt;객체 모델을 다루는 것, 객체 속성을 관리하거나 유효한지 추적하는 것&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;라이브러리의 저자들은 두개의 분리된 라이브러리로 분할하기로 결정해서 active_model이 탄생한 것&lt;/p&gt;
&lt;p&gt;특히 &lt;code class=&quot;language-text&quot;&gt;valid?&lt;/code&gt; 는 나름 데이터베이스쪽에 관계가 있어서 남았고,&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;validate&lt;/code&gt; 는 데이터베이스와 관계 없이 객체의 속성에만 관심이 있으므로 ActiveModel로 갔다&lt;/p&gt;
&lt;h2&gt;교훈&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;수많은 모듈을 포함해서 굉장히 큰 클래스가 된다.&lt;/li&gt;
&lt;li&gt;Base는 300개 이상의 인스턴스 메서드와 550개 이상의 클래스 메서드를 갖고있다..&lt;/li&gt;
&lt;li&gt;ActiveRecord::Base는 궁극의 오픈클래스&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;수백개의 메서드를 가진 거대한 클래스? 이해하기 힘들고 어렵지 않나?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;액티브 레코드의 대부분의 메서드는 궁극적으로 하나의 클래스 안으로 굴러들어간다.&lt;/li&gt;
&lt;li&gt;일부 모듈은 메타프로그래밍을 사용하여 더 많은 메서드를 정의하는 것을 고민하지 않고..&lt;/li&gt;
&lt;li&gt;엎친 데 덮친 격으로 액티브 레코드로 작업하는 추가 라이브러리도 액티브 레코드를 확장함..&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;스파게티 덩어리가 되지 않을까? &lt;del&gt;하지만 그렇지 않다...?&lt;/del&gt; -&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;많은 사람들이 자신의 목적을 위해 액티브 레코드를 몽키패치하고,..&lt;/li&gt;
&lt;li&gt;엑레의 소스코드는 빠르게 진화한다...&lt;/li&gt;
&lt;li&gt;안정적이게 유지가 되고 프로덕션에서 만족하며 사용중...&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;액티브 레코드에서 배운 중요한 가이드라인...&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;design techniques는... 상대적이고 사용하는 언어에 따라 다르다,&lt;/li&gt;
&lt;li&gt;루비에서는 다른 언어들과 다른 관용구를 사용한다.&lt;/li&gt;
&lt;li&gt;오래된 좋은 규칙들이 갑자기 쓸모없어지는 것이 아니다,&lt;/li&gt;
&lt;li&gt;루비에서도 다른 언어와 마찬가지로 디자인의 기본 원칙( 디커플링, simplicity, 중복 없음)이 적용된다.&lt;/li&gt;
&lt;li&gt;하지만 이를 달성하기 위한 기술이 매우 다르다.&lt;/li&gt;
&lt;li&gt;ActiveRecord::Base를 보면 매우 큰 클래스지만 소스코드에는 복잡한 코드가 없다&lt;/li&gt;
&lt;li&gt;대신 느슨하게 결합되고 테스트하기 쉬우며 재사용하기 쉬운 모듈을 조합하여 런타임에 구성된다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;active_model&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;User&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveModel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Validations&lt;/span&gt;
  attr_accessor &lt;span class=&quot;token symbol&quot;&gt;:password&lt;/span&gt;
  validate &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    errors&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:base&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Don&apos;t let dad choose the password.&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; password &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;1234&apos;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

user &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;password &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;12345&apos;&lt;/span&gt;
user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;valid&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;        &lt;span class=&quot;token comment&quot;&gt;# =&gt; true&lt;/span&gt;
user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;password &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;1234&apos;&lt;/span&gt;
user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;valid&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;        &lt;span class=&quot;token comment&quot;&gt;# =&gt; false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;위처럼 필요한 경우만 포함도 가능함&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[M Ruby - 6. Code That Writes Code]]></title><description><![CDATA[메타프로그래밍은 단문장으로 정의할 수 있는 접근법이 아니다. 여태 배운 트릭들을 잘 조합해서 어떻게 문제들을 해결하는지에 대한 장  과제 attraccessor 처럼 클래스 매크로 `attrchecked…]]></description><link>https://blog.seongjun.kr/metaprogramming-ruby-6/</link><guid isPermaLink="false">https://blog.seongjun.kr/metaprogramming-ruby-6/</guid><pubDate>Sun, 02 May 2021 00:00:00 GMT</pubDate><content:encoded>&lt;ul&gt;
&lt;li&gt;메타프로그래밍은 단문장으로 정의할 수 있는 접근법이 아니다.&lt;/li&gt;
&lt;li&gt;여태 배운 트릭들을 잘 조합해서 어떻게 문제들을 해결하는지에 대한 장&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;&lt;/h2&gt;
&lt;h2&gt;과제&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Person&lt;/span&gt;
 &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;CheckedAttributes&lt;/span&gt;
  attr_checked &lt;span class=&quot;token symbol&quot;&gt;:age&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;v&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    v &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
me &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
me&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;39&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;# OK&lt;/span&gt;
me&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;# Exception&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;attr&lt;em&gt;accessor 처럼 클래스 매크로 `attr&lt;/em&gt;checked`&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;모든 클래스에서 사용하여 더럽게 만드는 것 보단...&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CheckedAttributes모듈을 포함하는 경우에 클래스가 사용 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;계획&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;add&lt;em&gt;checked&lt;/em&gt;attribute라는 Kernel method 메서드를 eval을 통해 추가한다. - 단순한 유효성 검사 어트리뷰트를 클래스에 추가&lt;/li&gt;
&lt;li&gt;eval을 제거하기 위해 add&lt;em&gt;checked&lt;/em&gt;attribute를 리펙터링한다&lt;/li&gt;
&lt;li&gt;블록을 통해 속성을 유효성 검증 한다.&lt;/li&gt;
&lt;li&gt;add&lt;em&gt;checked&lt;/em&gt;attributes를 attr_checked라는 클래스 매크로로 변경한다. 모든 클래스에서 사용 가능&lt;/li&gt;
&lt;li&gt;모듈을 추가해서 선택된 클래스만 사용 가능하게 한다.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Kernel#eval&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;instance&lt;em&gt;eval, class&lt;/em&gt;eval을 이전에 배웠지? Kernel#eval 도 있다&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;array &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
el &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt;
eval&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;array &amp;lt;&amp;lt; el&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; [10,20,30]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;위의 예시는 의미가 없지만 코드 문자열을 즉시 evaluate하는건 의미가 있다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;REST client 예시&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;gem install rest-client&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;REST Client는 간단한 http 클라이언트 라이브러리이다.&lt;/li&gt;
&lt;li&gt;http 메서드와 함께 일반 루비 명령을 실행할 수 있는 인터프리터가 포함&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;restclient http&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;www&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;twitter&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;com
   &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; html_first_chars &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;.14&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
   &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&amp;lt;!DOCTYPE html&gt;&quot;&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;RestClient&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Resource&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;additional_headers&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;post&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; additional_headers&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;put&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;payload&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; additional_headers&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;delete&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;additional_headers&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;소스를 보면 네 가지의 기본 HTTP 메서드가 리소스 클래스에 정의되어 있다.&lt;/li&gt;
&lt;li&gt;인터프리터에서 이 메서드들을 사용할 수 있도록 특정 url의 리소스 메서드에 위임하는 최상위 메서드를 정의한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt;  &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  r&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;하지만 이런 것들을 일일이 정의하는 것이 아닌&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token constant&quot;&gt;POSSIBLE_VERBS&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;get&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;put&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;post&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;delete&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;POSSIBLE_VERBS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;m&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  eval &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;end_eval
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;#{m}(path, *args, &amp;amp;b)&lt;/span&gt;
        r&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;#{m}(*args, &amp;amp;b)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  end_eval
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;here document - heredoc 이라고 알려진 구문을 사용&lt;/li&gt;
&lt;li&gt;&amp;#x3C;&amp;#x3C;- 시퀀스로 시작하여 end_eval로 끝나는데&lt;/li&gt;
&lt;li&gt;&amp;#x3C;&amp;#x3C;- end&lt;em&gt;eval 은 end&lt;/em&gt;eval이라는 문구가 나오면 끝난다는 것&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Binding Objects&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;바인딩은 객체로 패키지된 전체 스코프이다.&lt;/li&gt;
&lt;li&gt;바인딩을 생성해서 로컬 스코프를 캠쳐하고, 이동할 수 있다는 아이디어&lt;/li&gt;
&lt;li&gt;나중에 바인딩 객체를 eval과 함께 사용하여 해당 스코프에서 코드를 실행할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@x&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    binding
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
b &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;바인딩 객체는 스코프를 포함하지만 코드는 포함하지 않는다, 따라서 블록보다 순수한 형태의 클로저라고 생각할 수 있다.&lt;/li&gt;
&lt;li&gt;바인딩을 evaluate할 추가 인수로 전달하여 캡쳐된 스코프의 코드를 eval 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;eval &lt;span class=&quot;token string&quot;&gt;&quot;@x&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b       &lt;span class=&quot;token comment&quot;&gt;# =&gt; 1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;TOPLEVEL_BINDING이라는 미리 정의된 상수, 최상위 스코프의 바인딩&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;AnotherClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
    eval &lt;span class=&quot;token string&quot;&gt;&quot;self&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;TOPLEVEL_BINDING&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;AnotherClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method    &lt;span class=&quot;token comment&quot;&gt;# =&gt; main&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이런 바인딩 오브젝트를 유용하게 쓴 잼이 Pry&lt;/li&gt;
&lt;li&gt;Object#pry 를 정의하고, 이 함수를 디버거로 사용할 수 있다.&lt;/li&gt;
&lt;li&gt;중단점을 설정하는 대신 현재 바인딩을 호출하는 줄을 코드에 추가한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# code...&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;pry&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; binding&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pry
&lt;span class=&quot;token comment&quot;&gt;# more code...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;ruby interpreter를 현재 바인딩에서 열고 ~&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;IRB 예시&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;irb는 표준 입력이나 파일을 파싱하고 각 줄을 통과시켜 eval하는 단순한 프로그램&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;eval&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;statements&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@binding&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; file&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;irb 소스코드의 깊은 곳에 있는 eval 호출&lt;/li&gt;
&lt;li&gt;statements는 그냥 루비 코드&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;binding - 다른 맥락에서 코드를 eval하기 위해 이 인수를 변경 가능하다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;특정 객체에서 중첩된 irb세션을 열 때 기존 irb 세션의 객체 이름 뒤에 irb를 입력함&lt;/li&gt;
&lt;li&gt;해당 객체 맥락에서 eval 될 것&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;file, line은 예외가 났을 때 스택을 주적하는데 사용됨&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;x&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;ZeroDivisionError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; divided by &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
from exception&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rb&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:in&lt;/span&gt; `&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&apos;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;String of Code vs Block&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;문자열의 코드는 결국 블록과 다를바가 없다.&lt;/li&gt;
&lt;li&gt;하지만 되도록 블록으로..&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;eval()의 문제&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;꿀이지만 그만큼 위험이 따름&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ide에서 하이라이팅이 잘 안 될 수도 있다.&lt;/li&gt;
&lt;li&gt;정적 분석으로 에러를 찾기가 아려워서 ide에서도 워닝을 못뱉음&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;위의 에러들은 사실 보안 이슈에 비하면 사소하지&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;코드 인젝션&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;explore_array&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  code &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;[&apos;a&apos;, &apos;b&apos;, &apos;c&apos;].&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;method&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
  puts &lt;span class=&quot;token string&quot;&gt;&quot;Evaluating: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;code&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
  eval code
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
loop &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; p explore_array&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;gets&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;마지막 줄의 무한 루프는 표준 입력에서 문자열을 받아다가 expect_array의 메서드로 넣는다.&lt;/li&gt;
&lt;li&gt;code를 eval하고 print&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;➾ find_index&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
❮ &lt;span class=&quot;token constant&quot;&gt;Evaluating&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;b&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;c&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;find_index&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;

➾ map&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;e&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;next&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
❮ &lt;span class=&quot;token constant&quot;&gt;Evaluating&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;b&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;c&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;map&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;e&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;next&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
   &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;b&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;c&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;d&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이 코드를 사용자가 입력한다면&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;➾ object_id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Dir&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;glob&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
❮ &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;b&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;c&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;object_id&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Dir&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;glob&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;*&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;your own &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt; information here&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;악의적인 사용자가 컴퓨터에서 임의 코드를 실행할 수 있다.&lt;/li&gt;
&lt;li&gt;code injection attack&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;코드 인젝션 막기&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;구문을 분석할 수도 있겠지만 악성 코드 작성 방법은 많으니까 효과적이지 않을 수 있다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;사용자가 직접 작성한 문자열만 악성 코드를 포함할 수 있으므로 사용자가 작성한 문자열에 대한 eval을 금지할 수도 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;많이 복잡한 경우는 문자열이 어디서 왔는지 알기 어려울지도... 추적 계속 해야하니&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;이런 어려움 때문에 어떤 프로그래머들은 eval을 전면 금지하자고 하기도 함&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이는 꽤 인기 있는 선택&lt;/li&gt;
&lt;li&gt;잘못될 수 잇는 것에 대해 편집증적인 경향&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;eval을 안쓰면 사례별로 대체 기법을 찾아야 한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;동적 메서드와 동적 디스패치로 대체 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token constant&quot;&gt;POSSIBLE_VERBS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;m&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt; m &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;b&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    r&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;explore_array&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;arguments&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;b&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;c&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;arguments&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;하지만 사용자가 block을 못씀, 임의의 문자열을 코드로 삽입하도록 해야한다..&lt;/li&gt;
&lt;li&gt;eval과 eval을 안쓰는 방식에서 선택이 어렵지....&lt;/li&gt;
&lt;li&gt;이하 eval을 그나마 안전하게 쓰는 기능을 제공&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Tainted Objects and Safe Levels&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;루비는 잠재적으로 안전하지 않은 객체에 대해 - 특히 외부 소스에서 온 객체를 tainted로 자동 표시한다.&lt;/li&gt;
&lt;li&gt;tainted ( 오염된 ) 객체는 프로그램이 web form, file, command line, 혹은 시스템 변수에서 읽는 문자열&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# read user input&lt;/span&gt;
user_input &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;User input: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;gets&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
puts user_input&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tainted&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
➾x&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; ❮ &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;루비는 오염된 객체를 잘 보완해주는 safe level이라는 개념을 제공한다&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$SAFE 전역 변수로 안전 수준을 설정하면, 잠재적인 위험한 작업을 허용하지 않는다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;0 - 3 까지&lt;/li&gt;
&lt;li&gt;1이상이면 tainted 문자열을 eval 못함&lt;/li&gt;
&lt;li&gt;2이면 대부분의 파일 관련 작업을 수행할 수 없음&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$SAFE&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
user_input &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;User input: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;gets&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
eval user_input&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;안전 수준에 의존하여 디스크 액세스 같은 위험한 작업을 허용하지 않도록 할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;ERB 예시&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;ERB는 루비 기본 템플릿 시스템임&lt;/li&gt;
&lt;li&gt;HTML에 ruby code를 내장하여 사용하는 코드 프로세서&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;erb&quot;&gt;&lt;pre class=&quot;language-erb&quot;&gt;&lt;code class=&quot;language-erb&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;strong&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Wake up!&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;strong&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt; It&apos;s a nice sunny &lt;span class=&quot;token erb language-erb&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;&amp;lt;%=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;strftime&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;%A&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token delimiter punctuation&quot;&gt;%&gt;&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;p&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;lt;%= .. %&amp;gt;&lt;/code&gt; 안에 ruby code를 넣어두면 evaluate&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;erb&apos;&lt;/span&gt;
erb &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ERB&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;read&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;template.rhtml&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
erb&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;run
❮ &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;p&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;strong&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Wake&lt;/span&gt; up&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;strong&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;It&lt;/span&gt;&apos;s a nice sunny &lt;span class=&quot;token constant&quot;&gt;Friday&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;p&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ERB&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;result&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;b&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;new_toplevel&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@safe_level&lt;/span&gt;
        proc &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;token variable&quot;&gt;$SAFE&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@safe_level&lt;/span&gt;
          eval&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@filename&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;(erb)&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call
      &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
        eval&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@src&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@filename&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;(erb)&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;new&lt;em&gt;toplevel은 TOPLEVEL&lt;/em&gt;BINDING의 복사본을 반환하는 메서드&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;안전수준이 설정 되어있으면 포함&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;샌드박스를 구축한다.&lt;/li&gt;
&lt;li&gt;별도의 범위에서 코드를 실행하기 위해 clean room을 사용함&lt;/li&gt;
&lt;li&gt;안전 수준은 proc 안에서만 적용이 됨&lt;/li&gt;
&lt;li&gt;-&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;아니면 바로 eval&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;1단계 일단 간단하게 eval로&lt;/h2&gt;
&lt;p&gt;checked_attribute를 만들 계획을 세웠던 대로 진행!&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;eval을 사용하여 add&lt;em&gt;checked&lt;/em&gt;attribute라는 커널 메서드를 작성&lt;/li&gt;
&lt;li&gt;eval을 제거&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;test/unit&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestCheckedAttribute&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Unit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;TestCase&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;setup&lt;/span&gt;&lt;/span&gt;
    add_checked_attribute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:age&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test_accepts_valid_values&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;
    assert_equal &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test_refuses_nil_values&lt;/span&gt;&lt;/span&gt;
    assert_raises &lt;span class=&quot;token constant&quot;&gt;RuntimeError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Invalid attribute&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;nil&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test_refuses_false_values&lt;/span&gt;&lt;/span&gt;
    assert_raises &lt;span class=&quot;token constant&quot;&gt;RuntimeError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Invalid attribute&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Here is the method that you should implement.&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;add_checked_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;klass&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; attribute&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;add_checked_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;klass&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; attribute&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  eval &quot;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#{klass}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#{attribute}=(value)&lt;/span&gt;
          &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Invalid attribute&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; value
          @&lt;span class=&quot;token comment&quot;&gt;#{attribute} = value&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#{attribute}()&lt;/span&gt;
          @&lt;span class=&quot;token comment&quot;&gt;#{attribute}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&quot;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;add_checked_attribute&lt;/code&gt; 를 한 뒤 String클래스&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_attr&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Invalid attribute&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; value
    &lt;span class=&quot;token variable&quot;&gt;@my_attr&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_attr&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@my_attr&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Open Class로 처리가 되고, 두 새로운 메서드를 가지게 된다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;2단계 Eval 빼기&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;eval을 뿌시자&lt;/li&gt;
&lt;li&gt;일반 루비 메서드로 대체!&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;왜 eval을 뿌셔야하는 강박관념이 생겼을까... ?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;팀원들만 사용하는데 코드 인젝션의 표적이 되나? 아니지&lt;/li&gt;
&lt;li&gt;하지만 이 메서드가 나중에 세상에 드러날 수 있으니...?&lt;/li&gt;
&lt;li&gt;Strings of Code를 안 쓰고 만들면 더 명확하고 우아하게 제공 가능하고 하이라이터들이 덜 홀란스러워 할 것이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;플랫 스코프 기억하니?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;add_checked_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;klass&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; attribute&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  klass&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;class_eval &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attribute&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;=&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;value&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Invalid attribute&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; value
      instance_variable_set&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;@&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attribute&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt; attribute &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      instance_variable_get &lt;span class=&quot;token string&quot;&gt;&quot;@&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attribute&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;해단 클래스의 스코프에 들어가야 한다.&lt;/li&gt;
&lt;li&gt;eval을 제거하면 클래스 키워드를 사용할 수 없으므로 class_eval을 사용하여 스코프에 들어간다.&lt;/li&gt;
&lt;li&gt;런타임에서 메서드의 이름을 알 수 없으니 define_method를 사용해야한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;3단계 블록으로 검증&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;블록으로 속성 검증이 가능해야한다, - 유연하게&lt;/li&gt;
&lt;li&gt;하지만 지금은 0혹은 false 할당시 예외&lt;/li&gt;
&lt;li&gt;새로운 테스트 필요함&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;test/unit&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestCheckedAttribute&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Unit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;TestCase&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;setup&lt;/span&gt;&lt;/span&gt;
    add_checked_attribute&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:age&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;v&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; v &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test_accepts_valid_values&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;
    assert_equal &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test_refuses_invalid_values&lt;/span&gt;&lt;/span&gt;
    assert_raises &lt;span class=&quot;token constant&quot;&gt;RuntimeError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Invalid attribute&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;17&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;add_checked_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;klass&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; attribute&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;validation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# ... (The code here doesn&apos;t pass the test. Modify it.)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;add_checked_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;klass&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; attribute&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;validation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  klass&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;class_eval &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attribute&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;=&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;value&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Invalid attribute&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; validation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      instance_variable_set&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;@&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attribute&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt; attribute &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      instance_variable_get &lt;span class=&quot;token string&quot;&gt;&quot;@&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attribute&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;4단계 클래스 매크로!&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;일단 테스트 케이스를 변경&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Person&lt;/span&gt;
  attr_checked &lt;span class=&quot;token symbol&quot;&gt;:age&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;v&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
   v &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestCheckedAttributes&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Unit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;TestCase&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;setup&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test_accepts_valid_values&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;
    assert_equal &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test_refuses_invalid_values&lt;/span&gt;&lt;/span&gt;
    assert_raises &lt;span class=&quot;token constant&quot;&gt;RuntimeError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Invalid attribute&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;17&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Class 클래스에서 정의한다!&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Class&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;attr_checked&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attribute&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;validation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attribute&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;=&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;value&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Invalid attribute&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; validation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      instance_variable_set&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;@&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attribute&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt; attribute &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      instance_variable_get &lt;span class=&quot;token string&quot;&gt;&quot;@&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attribute&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Hook Methods&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;클래스가 상속될 때 코드를 실행 할 수 있다!&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;inherited&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;subclass&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    puts &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; was inherited by &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;subclass&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyString&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt; was inherited by &lt;span class=&quot;token constant&quot;&gt;MyString&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;상속 메서드는 클래스의 인스턴스 메서드&lt;/li&gt;
&lt;li&gt;원래는 아무런 작업도 수행하지 않지만 재정의 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;More Hooks&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;라이프 사이클에 연결이 가능하도록 모듈에서도 제공!&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M1&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;included&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;othermod&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    puts &lt;span class=&quot;token string&quot;&gt;&quot;M1 was included into &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;othermod&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M2&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;prepended&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;othermod&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    puts &lt;span class=&quot;token string&quot;&gt;&quot;M2 was prepended to &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;othermod&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;C&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M1&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;prepend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M2&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
❮ &lt;span class=&quot;token constant&quot;&gt;M1&lt;/span&gt; was included into &lt;span class=&quot;token constant&quot;&gt;C&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M2&lt;/span&gt; was prepended to &lt;span class=&quot;token constant&quot;&gt;C&lt;/span&gt;


&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;method_added&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    puts &lt;span class=&quot;token string&quot;&gt;&quot;New method: M#&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;method&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
❮ &lt;span class=&quot;token constant&quot;&gt;New&lt;/span&gt; method&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;#my_method&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;include/prepend시 실행 가능&lt;/li&gt;
&lt;li&gt;모듈을 재정의하여 객체를 확장할 때 코드 실행 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;이런 훅들은..&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;singleton method에서는 못쓴다&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;C&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;include&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;modules&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    puts &lt;span class=&quot;token string&quot;&gt;&quot;Called: C.include(&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;modules&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;)&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;다른 쪽에서 동일한 이벤트에 연결 가능함!&lt;/li&gt;
&lt;li&gt;Module#included 을 오버라이딩 하는 것과, Module#include를 오버라이딩 하는 것은 차이가 있음&lt;/li&gt;
&lt;li&gt;include에는 실제 작업이 있으므로 super를 포함 꼭 시켜야함&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;VCR 예시&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;VCR 잼은 HTTP 요청을 녹화하고 리플레이하는 잼이다.&lt;/li&gt;
&lt;li&gt;VCR의 Request 클래스에 Normalizers:Body가 포함되어있다.&lt;/li&gt;
&lt;li&gt;Body 모듈은 body_from 같이 http message body를 다루는 클래스 메서드를 추가한다.&lt;/li&gt;
&lt;li&gt;하지만 클래스는 일반적으로 클래스 메서드가 아닌 모듈을 포함해서 인스턴스 메서드를 갖고오지 않는가?&lt;/li&gt;
&lt;li&gt;어떻게 얘는 mixin할까&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;VCR&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Normalizers&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Body&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;included&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;klass&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        klass&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;body_from&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hash_or_string&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;token comment&quot;&gt;#...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;include를 시키면 Body의 included 훅을 호출&lt;/li&gt;
&lt;li&gt;Request을 ClassMethods 모듈로 확장한다.&lt;/li&gt;
&lt;li&gt;확장 메서드는 요청의 싱글톤 클래스에 ClassMethods의 메서드를 포함시킨다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ClassMethods - plus - hook 관용구는 꽤 흔하고 레일즈 코드에서 광범위하게 썼다.&lt;/p&gt;
&lt;p&gt;하지만 다른 매커니즘으로 지금 변경되었고 VCR이나 다른 잼에서 이 예를 찾을 수 있다.&lt;/p&gt;
&lt;h2&gt;5단계 필요한 클래스에서만!&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;checkedAttributes라는 모듈을 포함한 클래스에서만 사용할 수 있도록 변경&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;test/unit&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Person&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;CheckedAttributes&lt;/span&gt;
  attr_checked &lt;span class=&quot;token symbol&quot;&gt;:age&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;v&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    v &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestCheckedAttributes&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Unit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;TestCase&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;setup&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Person&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test_accepts_valid_values&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt;
    assert_equal &lt;span class=&quot;token number&quot;&gt;18&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test_refuses_invalid_values&lt;/span&gt;&lt;/span&gt;
    assert_raises &lt;span class=&quot;token constant&quot;&gt;RuntimeError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Invalid attribute&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;token variable&quot;&gt;@bob&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;age &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;17&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;CheckedAttributes&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;included&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ClassMethods&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;attr_checked&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;attribute&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;validation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attribute&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;=&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;value&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
          &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Invalid attribute&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; validation&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
          instance_variable_set&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;@&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attribute&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt; attribute &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
        instance_variable_get &lt;span class=&quot;token string&quot;&gt;&quot;@&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;attribute&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;굿!&lt;/p&gt;
&lt;h2&gt;정리&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;메타프로그래밍 문제를 풀었다. 그 과정에서 eval과 이에 대한 문제점 및 해결 방안을 배움&lt;/li&gt;
&lt;li&gt;hook methods를 알게되었다.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[M Ruby - 5. Class Definitions]]></title><description><![CDATA[Class Definitions…]]></description><link>https://blog.seongjun.kr/metaprogramming-ruby-5/</link><guid isPermaLink="false">https://blog.seongjun.kr/metaprogramming-ruby-5/</guid><pubDate>Thu, 29 Apr 2021 00:00:00 GMT</pubDate><content:encoded>&lt;h1&gt;Class Definitions&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;일반적인 프로그래밍 언어에서의 클래스는 클래스의 객체를 만든 다음 해당 객체의 메서드를 호출할 때까지 실제로 아무 일도 일어나지 않는다.&lt;/li&gt;
&lt;li&gt;루비에서는 다르다, 객체의 향후 동작 방식만 지시하는 것이 아닌 코드를 실제로 싱행한다.&lt;/li&gt;
&lt;li&gt;클래스 매크로와 별칭에 대한 것을 배울 예정&lt;/li&gt;
&lt;li&gt;싱글톤 클래스에 대해서도 설명&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;클래스 정의 이해하기&lt;/h2&gt;
&lt;h3&gt;클래스 정의 내부&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  puts &lt;span class=&quot;token string&quot;&gt;&apos;Hello&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
❮ &lt;span class=&quot;token constant&quot;&gt;Hello&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;클래스 정의에 원하는 코드를 넣을 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
result &lt;span class=&quot;token comment&quot;&gt;# =&gt; MyClass&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;클래스 정의도 메서드처럼 마지막 라인을 반환한다.&lt;/li&gt;
&lt;li&gt;클래스 정의에서 클래스 자체는 현재 객체로써 역할을 수행함&lt;/li&gt;
&lt;li&gt;클래스와 모듈은 객체일 뿐인데 왜 self가 될 수 없나?&lt;/li&gt;
&lt;li&gt;일단 킵&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;The Current Class&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;알다시피 루비에서는 어디든 self를 갖고있다. 마찬가지로 항상 &lt;strong&gt;current class&lt;/strong&gt;가 있다.&lt;/li&gt;
&lt;li&gt;메서드를 정의하면 해당 메서드가 현재 클래스의 인스턴스 메서드가 된다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;self로 현재 객체에 대한 참조를 가져올 수 있지만 &lt;strong&gt;current class&lt;/strong&gt;에 대한 참조를 갖고 오는 키워드는 없다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;최상위 레벨에서의 current class는 Object이다. 따라서 최상위에서 메서드를 정의하면 Object의 인스턴스 메서드가 된다.&lt;/li&gt;
&lt;li&gt;메서드에서 current class는 오브젝트의 클래스이다.&lt;/li&gt;
&lt;li&gt;클래스 키워드가 있는 클래스를 열면 해당 클래스가 current class가 된다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;클래스 키워드는 클래스 이름이 필요하다는 한계&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;add_method_to&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a_class&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# TODO: define method m() on a_class&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;현재 클래스를 변경하려면 클래스 키워드 이외의 방법이 필요하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;class_eval()&lt;/h4&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Module#class_eval&lt;/code&gt; 은 기존 클래스의 컨텍스트에서 블록은 evaluate한다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;add_method_to&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a_class&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  a_class&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;class_eval &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;m&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Hello!&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
add_method_to &lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;abc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;m   &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;Hello!&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;instance_eval&lt;/code&gt; 하고는 매우 다름 얘는 object만 변경, class_eval은 전부 변경&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;펙트는 아닌데 일단 뒤에서 더 설명&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;class_eval은 current class를 변경하여 클래스 키워드처럼 클래스를 다시 연다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;class 보다 더 유연하다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;class는 상수를 필요하지만 class_eval은 모든 변수에 사용 가능&lt;/li&gt;
&lt;li&gt;class는 current binding을 볼 수 없지만 class eval은 플랫 스코프를 가짐 - 외부 스코프의 변수 참조 가능&lt;/li&gt;
&lt;li&gt;class_exec 메서드도 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Current class Wrap-up&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;루비 인터프리터는 항상 current class에 대한 참조를 유지한다. def로 정의된 메서드는 current class의 인스턴스 메서드가 된다.&lt;/li&gt;
&lt;li&gt;클래스 정의에서 현재 객체 self와 current class는 동일하다.&lt;/li&gt;
&lt;li&gt;클래스에 대한 참조가 있으면 class_eval로 클래스를 열 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;클래스 인스턴스 변수&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;루비 인터프리터는 모든 인스턴스 변수가 현재 객체 self에 속한다고 가정한다, 클래스에서도 마찬가지&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token variable&quot;&gt;@my_var&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;read&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@my_var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@my_var&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;read&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@my_var&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;read &lt;span class=&quot;token comment&quot;&gt;# =&gt; nil&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;write
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;read &lt;span class=&quot;token comment&quot;&gt;# =&gt; 2&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;read &lt;span class=&quot;token comment&quot;&gt;# =&gt; 1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;self는 클래스 자체이니까 인스턴스 변수 &lt;code class=&quot;language-text&quot;&gt;@my_var&lt;/code&gt; 는 클래스에 속한다.&lt;/li&gt;
&lt;li&gt;클래스의 인스턴스 변수는, 클래스 객체의 인스턴스 변수와 다르다&lt;/li&gt;
&lt;li&gt;두 개의 인스턴스 변수를 정의한 것 같은 이름이지만 서로 다른 범위, 서로 다른 객체&lt;/li&gt;
&lt;li&gt;클래스는 단지 객체임을 기억하고, self를 트래킹 해야함&lt;/li&gt;
&lt;li&gt;obj을 self로 두느냐, MyClass를 self로 두느냐.&lt;/li&gt;
&lt;li&gt;static field같은거임&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;C&lt;/span&gt;
  &lt;span class=&quot;token variable&quot;&gt;@@v&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;D&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;C&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@@v&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method &lt;span class=&quot;token comment&quot;&gt;# =&gt; 1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이게 더 스태틱변수같긴한데, 서브 클래스에서 접근 가능함&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;@@v&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token variable&quot;&gt;@@v&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;@@v&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#=&gt;2&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;하지만 쫌 ..&lt;/li&gt;
&lt;li&gt;클래스 변수가 클래스에 속하는 것이 아닌 클래스 계층에 속하기 때문&lt;/li&gt;
&lt;li&gt;@@v는 main context에서 정의가 되므로 Object에 속한다.&lt;/li&gt;
&lt;li&gt;그리고 모든 Object의 후손들에게 ... MyClass는 Object를 상속하므로 동일한 클래스 변수를 공유&lt;/li&gt;
&lt;li&gt;그래서 대부분 클래스 변수를 피함, 최상위에서는 클래스 변수를 못쓰게 함&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;bookworm&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Loan&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;book&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@book&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; book
    &lt;span class=&quot;token variable&quot;&gt;@time&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;now
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;to_s&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@book&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;upcase&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; loaned on &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@time&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Loan은 책 제목과 대출된 시간을 저장&lt;/li&gt;
&lt;li&gt;to_s의 테스트를 작성하려면 객체가 생성된 정확한 시간을 알아야한다.&lt;/li&gt;
&lt;li&gt;하지만 매번 다른 결과이므로 ...&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Loan&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;book&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@book&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; book
    &lt;span class=&quot;token variable&quot;&gt;@time&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Loan&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;time_class&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;now
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;time_class&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@time_class&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Time&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;to_s&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;time_class는 클래스를 반환하고 해당 클래스로 현재 시간을 갖고온다.&lt;/li&gt;
&lt;li&gt;nil gurad로 인해 @time_class가 없으면 Time을 기본값으로 반환&lt;/li&gt;
&lt;li&gt;단위 테스트에선 항상 동일한 값을 반환하는 가짜 시간 클래스에 의존할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;FakeTime&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;now&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Mon Apr 06 12:15:50&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;test/unit&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;TestLoan&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Unit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;TestCase&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test_conversion_to_string&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token constant&quot;&gt;Loan&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_eval &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@time_class&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;FakeTime&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    loan &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Loan&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;War and Peace&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    assert_equal &lt;span class=&quot;token string&quot;&gt;&apos;WAR AND PEACE loaned on Mon Apr 06 12:15:50&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; loan&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_s
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;싱글톤 메서드&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Paragraph 클래스는 문자열을 줄 바꿈한 다음 모든 호출을 줄 바꿈 문자열에 위임한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;title?은 문단이 모두 대문자이면 트루&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Paragraph&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@text&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; text
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;title&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;upcase &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;reverse&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reverse&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;upcase&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;upcase&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;#...&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;index&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;paragraph&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  add_to_index&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;paragraph&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; paragraph&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Paragraph는 한 곳에서 생성되고 title? 메서드는 인덱스라는 메서드에서 한 번만 호출된다&lt;/li&gt;
&lt;li&gt;이게 필요한가? 그냥 스트링 클래스를 몽키패치해서 title? 메서드를 추가?&lt;/li&gt;
&lt;li&gt;하지만 paragraph을 나타내는 문자열에서만 의미가 있고 다른 문자열에서는 의미가 없다.&lt;/li&gt;
&lt;li&gt;하나의 객체에 메서드를 추가하기&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;str &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;just a regular string&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;str&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;title&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;upcase &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
str&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; false&lt;/span&gt;
str&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;methods&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;grep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;/title?/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:title?]&lt;/span&gt;
str&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;singleton_methods&lt;span class=&quot;token comment&quot;&gt;# =&gt; [:title?]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Object#define_singleton_method&lt;/code&gt; 를 통해서 싱글톤 메서드를 정의할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;paragraph &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;any string can be a paragraph&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;paragraph&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;title&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;upcase &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
index&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;paragraph&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;클래스 메서드의 진실&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Object Model에서 배운 내용을 기억하나? 클래스는 객체이고 클래스 이름은 상수이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클래스에서 메서드를 호출하는 것과 객체에서 호출이 같다라는 것을 알 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;an_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a_method
&lt;span class=&quot;token constant&quot;&gt;AClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a_class_method&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;하지만 싱글톤 메서드? 그게 바로 클래스 메서드!! - 클래스의 싱글톤 메서드이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;a_singleton_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;another_class_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;앞의 정의에서 객체는 객체 참조, 상수 클래스 이름, 또는 그 자체일 수 있다. 구문은 다를 수 있지만 기본 메커니즘은 동일하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;클래스 매크로&lt;/h3&gt;
&lt;h4&gt;attr_accessor() example&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_attribute&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@my_attribute&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_attribute&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@my_attribute&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_attribute &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;x&apos;&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_attribute&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;루비의 객체에는 속성이 없다.&lt;/li&gt;
&lt;li&gt;모방 메서드인 reader, writer를 정의 해야한다.&lt;/li&gt;
&lt;li&gt;위와 같은 정의는 금방 지루하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  attr_accessor &lt;span class=&quot;token symbol&quot;&gt;:my_attribute&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;attr_accessor은 w/r&lt;/li&gt;
&lt;li&gt;attr_reader는 r&lt;/li&gt;
&lt;li&gt;attr_writer 는 w를 생성&lt;/li&gt;
&lt;li&gt;attr_*은 모듈 class에 정의되어 있으므로 모듈 또는 클래스일 때 사용 가능하다.&lt;/li&gt;
&lt;li&gt;이러한 메서드를 클래스 매크로라고 한다.&lt;/li&gt;
&lt;li&gt;키워드 처럼 보이지만 클래스 정의에 사용되는 메서드 일 뿐이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Class Macros Applied&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;북 클래스에는 몇가지 메서드가 있다, 이 메서드 이름을 바꾸면 호출자가 끊어지므로...&lt;/li&gt;
&lt;li&gt;GetTitle -&gt; title, LEND&lt;em&gt;TO&lt;/em&gt;USER -&gt; lend_to, title2 -&gt; subtitle&lt;/li&gt;
&lt;li&gt;이전 이름을 deprecate 클래스 매크로로 메서드 이름을 바꿀 수 있다&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Book&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;title&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;subtitle&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;lend_to&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    puts &lt;span class=&quot;token string&quot;&gt;&quot;Lending to &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;user&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;deprecate&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;old_method&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; new_method&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
     &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;old_method&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
      warn &lt;span class=&quot;token string&quot;&gt;&quot;Warning: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;old_method&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;() is deprecated. Use &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;new_method&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;().&quot;&lt;/span&gt;
      send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;new_method&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    deprecate &lt;span class=&quot;token symbol&quot;&gt;:GetTitle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:title&lt;/span&gt;
    deprecate &lt;span class=&quot;token symbol&quot;&gt;:LEND_TO_USER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:lend_to&lt;/span&gt;
    deprecate &lt;span class=&quot;token symbol&quot;&gt;:title2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:subtitle&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
b &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Book&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
b&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;LEND_TO_USER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Bill&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
❮ &lt;span class=&quot;token constant&quot;&gt;Warning&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;LEND_TO_USER&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; is deprecated&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Use&lt;/span&gt; lend_to&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Lending&lt;/span&gt; to &lt;span class=&quot;token constant&quot;&gt;Bill&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이전 이름에 대한 호출을 탐지하는 동적 메서드를 정의&lt;/li&gt;
&lt;li&gt;경고창을 정의&lt;/li&gt;
&lt;li&gt;클래스 매크로를 사용하는 기발한 방법&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;싱글톤 클래스&lt;/h2&gt;
&lt;h3&gt;싱글톤 메서드의 미스테리&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Method Lookup에서 수신자의 클래스로 이동한 다음 클래스 계층 위로 올라가서 메서드를 찾는 방법을 배웠다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;my_singleton_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;싱글톤 메서드에서는?&lt;/li&gt;
&lt;li&gt;obj는 클래스가 아니므로 obj에서 살 수 없다.&lt;/li&gt;
&lt;li&gt;MyClass나 Object에서도 마찬가지, 모든 클래스에 적용이 되어버리므로&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;보이는 클래스 대신 객체는 자신만의 특수한 숨겨진 클래스를 가질 수 있다 -&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;이를 싱글톤 클래스라고 한다 ( 메타클래스 혹은 고유 클래스라고 부르기도 한다.)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; an_object
  &lt;span class=&quot;token comment&quot;&gt;# your code here&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;싱글톤 클래스에 대한 참조를 가져오려면 스코프에서 자체적으로 반환 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
singleton_class &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; obj
  &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
singleton_class&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# =&gt; Class&lt;/span&gt;

&lt;span class=&quot;token string&quot;&gt;&quot;abc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;singleton_class    &lt;span class=&quot;token comment&quot;&gt;# =&gt; #&amp;lt;Class:#&amp;lt;String:0x331df0&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Object#singleton_class&lt;/code&gt; 로도 얻을 수 있다.&lt;/li&gt;
&lt;li&gt;싱글톤 클래스는 &amp;#x3C;&amp;#x3C; 구문 혹은 singleton_class 메서드를 사용 전에는 볼 수 없음&lt;/li&gt;
&lt;li&gt;단일 인스턴스에만 있고 상속될 수 없다.&lt;/li&gt;
&lt;li&gt;싱글톤 클래스는 객체의 싱글톤 메서드가 존재하는 곳이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;my_singleton_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
singleton_class&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_methods&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;grep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;/my_/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:my_singleton_method]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;메서드 조회 다시 보기&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;예전 장에서 메서드 호출 시 발생하는 현상에서는 루비 객체 모델과 메서드 조회에 대해 배웠다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;메서드 조회 리뷰&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;C&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;a_method&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;C#a_method()&apos;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;D&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a_method    &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;C#a_method()&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/960b45e28f8905cc3d8b3e5072a32662/fe9f0/class.jpg&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 92.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAATABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIBBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeZWUQAAD//EABcQAAMBAAAAAAAAAAAAAAAAAAAQQSD/2gAIAQEAAQUCIpj/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/AR//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAUEAEAAAAAAAAAAAAAAAAAAAAw/9oACAEBAAY/Ah//xAAZEAABBQAAAAAAAAAAAAAAAAAAEBEgITH/2gAIAQEAAT8hUxlo/wD/2gAMAwEAAgADAAAAEJPPAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABsQAQACAgMAAAAAAAAAAAAAAAEAESFBECAx/9oACAEBAAE/EIF6Gat4LblKgxfo9f/Z&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;class&apos; title=&apos;class&apos; src=&apos;/static/960b45e28f8905cc3d8b3e5072a32662/a22ce/class.jpg&apos; srcset=&apos;/static/960b45e28f8905cc3d8b3e5072a32662/0b705/class.jpg 170w,
/static/960b45e28f8905cc3d8b3e5072a32662/31389/class.jpg 340w,
/static/960b45e28f8905cc3d8b3e5072a32662/a22ce/class.jpg 680w,
/static/960b45e28f8905cc3d8b3e5072a32662/29373/class.jpg 1020w,
/static/960b45e28f8905cc3d8b3e5072a32662/fe9f0/class.jpg 1078w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h4&gt;싱글톤 클래스와 매서드의 조회&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;singleton_class  &lt;span class=&quot;token comment&quot;&gt;# =&gt; #&amp;lt;Class:#&amp;lt;Object:0x007fd96909b588&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h1&gt;이 붙어있으면 싱글톤 클래스를 의미한다고 해보자&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h1&gt;obj은 obj의 싱글톤 클래스 #C는 C의 싱글톤 클래스&lt;/h1&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; obj
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;a_singleton_method&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;obj#a_singleton_method()&apos;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;싱글톤 클래스도 클래스이니 슈퍼 클래스가 있어야지?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;singleton_class&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;superclass   &lt;span class=&quot;token comment&quot;&gt;# =&gt; D&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/8111a91ee707bfa8c8c80f2819572f67/0a251/single.jpg&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 127.6470588235294%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAaABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAIBAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHzKmiQbfMawf/EABkQAAIDAQAAAAAAAAAAAAAAABBBABEgIf/aAAgBAQABBQKIIcrH/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQAGPwJP/8QAGRAAAwADAAAAAAAAAAAAAAAAAAEgESEx/9oACAEBAAE/ITEuhE+x/9oADAMBAAIAAwAAABCzwwz/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAbEAACAwEBAQAAAAAAAAAAAAABEQAhMRAgof/aAAgBAQABPxCAC1N6T0HJFPRwUv5MDvQzEZY68f/Z&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;single.jpeg&apos; title=&apos;single.jpeg&apos; src=&apos;/static/8111a91ee707bfa8c8c80f2819572f67/a22ce/single.jpg&apos; srcset=&apos;/static/8111a91ee707bfa8c8c80f2819572f67/0b705/single.jpg 170w,
/static/8111a91ee707bfa8c8c80f2819572f67/31389/single.jpg 340w,
/static/8111a91ee707bfa8c8c80f2819572f67/a22ce/single.jpg 680w,
/static/8111a91ee707bfa8c8c80f2819572f67/0a251/single.jpg 1000w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h4&gt;싱글톤 클래스 및 상속&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;C&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;a_class_method&lt;/span&gt;&lt;/span&gt;
      &lt;span class=&quot;token string&quot;&gt;&apos;C.a_class_method()&apos;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;singleton_class&lt;span class=&quot;token comment&quot;&gt;# =&gt; #&amp;lt;Class:C&gt;&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;singleton_class&lt;span class=&quot;token comment&quot;&gt;# =&gt; #&amp;lt;Class:D&gt;&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;singleton_class&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;superclass&lt;span class=&quot;token comment&quot;&gt;# =&gt; #&amp;lt;Class:C&gt;&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;singleton_class&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;superclass&lt;span class=&quot;token comment&quot;&gt;# =&gt; #&amp;lt;Class:Object&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/77839a822a4856dc7f3c15891b1e6f6f/0a251/singleton.jpg&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 144.11764705882354%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAdABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAeZU2QBpFEA//8QAFhAAAwAAAAAAAAAAAAAAAAAAEBEw/9oACAEBAAEFApMf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFRABAQAAAAAAAAAAAAAAAAAAIDH/2gAIAQEABj8CdP8A/8QAGhAAAgMBAQAAAAAAAAAAAAAAARAAETEhUf/aAAgBAQABPyGAPzWD0Y4rhsMX/9oADAMBAAIAAwAAABCjyTz/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/EB//xAAcEAEAAgMAAwAAAAAAAAAAAAABABEQIUExYXH/2gAIAQEAAT8QlDaldncFX0rW/GUEQPRnYU4P0mtoax//2Q==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;single.jpeg&apos; title=&apos;single.jpeg&apos; src=&apos;/static/77839a822a4856dc7f3c15891b1e6f6f/a22ce/singleton.jpg&apos; srcset=&apos;/static/77839a822a4856dc7f3c15891b1e6f6f/0b705/singleton.jpg 170w,
/static/77839a822a4856dc7f3c15891b1e6f6f/31389/singleton.jpg 340w,
/static/77839a822a4856dc7f3c15891b1e6f6f/a22ce/singleton.jpg 680w,
/static/77839a822a4856dc7f3c15891b1e6f6f/0a251/singleton.jpg 1000w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;C는 싱글톤클래스&lt;/li&gt;
&lt;li&gt;S는 슈퍼클래스&lt;/li&gt;
&lt;li&gt;이 다이어그램은 모듈이 포함되어있지 않다. 완전히 그리려면 Object와 BasicObject사이에 Kernel모듈을 그릴 수 있지만 굳이,&lt;/li&gt;
&lt;li&gt;모듈들은 다른 객체들처럼 싱글톤 클래스를 가질 수 있지만 커널의 싱글톤 클래스는 obj나 #D의 상위 체인의 일부가 아니다.&lt;/li&gt;
&lt;li&gt;싱글톤의 슈퍼클래스는 싱글톤클래스&lt;/li&gt;
&lt;li&gt;이런 배열 덕분에 하위 클래스에서 클래스 메서드 호출이 가능한 것&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token constant&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a_class_method &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;C.a_class_method()&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;a&lt;em&gt;class&lt;/em&gt;method 가 C에 정의되어 있더라도 D에도 호출이 가능하다.&lt;/li&gt;
&lt;li&gt;메서드 조회가 #D에서 시작하여 #D의 #C로 올라가서 메서드를 찾기 때문에 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;The Great Unified Theory&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;클래스, 싱글톤 클래스, 모듈이 있다.&lt;/li&gt;
&lt;li&gt;인스턴스 메서드, 클래스 메서드, 싱글톤 메서드가 있다.&lt;/li&gt;
&lt;li&gt;싱글톤 클래스를 클래스와 모듈과 함께 사용하면 루비 객체 모델의 7가지 규칙이 나온다.&lt;/li&gt;
&lt;li&gt;객체는 한 가지 종류만 있다. 일반 객체 혹은 모듈&lt;/li&gt;
&lt;li&gt;모듈은 한가지 종류만 있다. 일반 모듈, 클래스 또는 싱글톤 클래스&lt;/li&gt;
&lt;li&gt;한 가지 종류의 메서드가 있다. - 모듈에서 살고 대부분 클래스 안에 있다.&lt;/li&gt;
&lt;li&gt;모든 객체, 클래스는 실제 클래스를 가진다 - 일반 클래스 혹은 싱글톤 클래스&lt;/li&gt;
&lt;li&gt;BasicObject를 제외한 모든 클래스에는 정확히 하나의 상위 클래스가 있다. - 즉 모든 클래스의 상위 항목부터 BasicObject까지의 체인을 가짐&lt;/li&gt;
&lt;li&gt;객체의 싱글톤 클래스의 슈퍼클래스는 객체의 클래스이다. 한 클래스의 싱글톤 슈퍼클래스는 그 클래스의 싱글톤 클래스이다.&lt;/li&gt;
&lt;li&gt;메서드를 호출하면 오른쪽으로 클래스로, 이동한 다음 조상 체인을 올라간다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Class Methods Syntaxes&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;클래스 메서드는 클래스의 싱글톤 클래스에 있는 싱글톤 메서드이므로 이제 세 가지 방법을 사용 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;a_class_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;another_class_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;yet_another_class_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;첫 번째는 클래스 이름이 중복되어 래팩터링이 어려우므로 ..&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;세 번째는 trickiest , 싱글톤 클래스를 열고 메서드를 정의,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;싱글톤 클래스를 명시적으로 인정하므로 쫌 치는 느낌이 난다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;싱글톤 클래스와 instance_eval()&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;instance&lt;em&gt;eval은 객체만 변화하고 class&lt;/em&gt;eval은 자신과 current class 모두 변화한다고 배웠다.&lt;/li&gt;
&lt;li&gt;하지만 instance_eval은 current class도 변경한다 - 수신자의 싱글톤 클래스도 변경한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;s1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; s2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;abc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;def&quot;&lt;/span&gt;
s1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_eval &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;swoosh&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; reverse&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
s1&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;swoosh&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;                &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;cba&quot;&lt;/span&gt;
s2&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;respond_to&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:swoosh!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# =&gt; false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;클래스 속성&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;attr_*을 기억하는가?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  attr_accessor &lt;span class=&quot;token symbol&quot;&gt;:a&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;대신 클래스에 속성을 정의하려면?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Class&lt;/span&gt;
  attr_accessor &lt;span class=&quot;token symbol&quot;&gt;:b&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;b &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;b      &lt;span class=&quot;token comment&quot;&gt;# =&gt; 42&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;동작이야 하겠지만 모든 클래스에 속성이 추가됨, MyClass에 특화된 속성을 원한다면..&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;
    attr_accessor &lt;span class=&quot;token symbol&quot;&gt;:c&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;c &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;It works!&apos;&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;c&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;attribute는 단지 한쌍의 메서드이다.&lt;/li&gt;
&lt;li&gt;이런 메서드를 정의하면 클래스 메서드가 되는 것&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;c&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token variable&quot;&gt;@c&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;c&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token variable&quot;&gt;@c&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Method Wrappers&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;deserves_a_look&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;book&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  amazon &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Amazon&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
  amazon&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reviews_of&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;book&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;size &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;라이브러리 사용 예시&lt;/li&gt;
&lt;li&gt;대부분 작동하지만 예외 관리가 안된다.&lt;/li&gt;
&lt;li&gt;Amazon이 원격 호출이 실패하면 이 문제를 기록하고 진행해야한다.&lt;/li&gt;
&lt;li&gt;라이브러리를 직접 수정하고 싶지 않다 라는 문제&lt;/li&gt;
&lt;li&gt;모든 클라이언트가 자동으로 추가 기능을 사용할 수 있도록 메서드를 사용하여 추가 기능을 래핑하려고 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Around Aliases&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;별칭 사용이 가능하다&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;my_method()&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  alias_method &lt;span class=&quot;token symbol&quot;&gt;:m&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:my_method&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method   &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;my_method()&quot;&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;m           &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;my_method()&quot;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  alias_method &lt;span class=&quot;token symbol&quot;&gt;:m2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:m&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;m2           &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;my_method()&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;흔한 예시임, String#size, String#length, Integer클래스는 5개 이상의 다른 이름을 가진 메서드를 갖고있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;
  alias_method &lt;span class=&quot;token symbol&quot;&gt;:real_length&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:length&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;length&lt;/span&gt;&lt;/span&gt;
    real_length &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;long&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;short&apos;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;War and Peace&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length      &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;long&quot;&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;War and Peace&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;real_length &lt;span class=&quot;token comment&quot;&gt;# =&gt; 13&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;method를 재정의하지만 별칭은 여전히 원래 메서드를 참조한다.&lt;/li&gt;
&lt;li&gt;재정의 시 메서드는 실제로 변경되지 않는다. 기존 이름을 해당 새 메서드에 연결할 뿐&lt;/li&gt;
&lt;li&gt;흥미로운 예시임&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;The Thor Example&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;cli utilities를 만드는 잼임&lt;/li&gt;
&lt;li&gt;Rake2thor라는 프로그램이 포함되어 있는데 이 프로그램은 빌드 파일을 토르 스크립트로 변환함&lt;/li&gt;
&lt;li&gt;Rake2thor는 레이크 파일을 로드하고 해당 레이크 파일에 필요한 모든 파일의 이름을 저장해야한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;input  &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ARGV&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Rakefile&apos;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$requires&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Kernel&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;require_with_record&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;file&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;$requires&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; file &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; caller&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;token regex&quot;&gt;/rake2thor:/&lt;/span&gt;
    require_without_record file
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  alias_method &lt;span class=&quot;token symbol&quot;&gt;:require_without_record&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:require&lt;/span&gt;
  alias_method &lt;span class=&quot;token symbol&quot;&gt;:require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:require_with_record&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
load input&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;필요한 파일의 이름을 저장할 글로벌 어레이를 준비하고, 커널 모듈을 열고 메서드 별칭으로 몇 가지 트릭을 쓴다.&lt;/li&gt;
&lt;li&gt;그러고 마지막으로 rakefile을 로드한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Kernel&lt;/span&gt;
  alias_method &lt;span class=&quot;token symbol&quot;&gt;:require_without_record&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:require&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;file&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;$requires&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; file &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; caller&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;token regex&quot;&gt;/rake2thor:/&lt;/span&gt;
    require_without_record file
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;단순화된 버전임&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;위의 오픈클래스는 세 가지 일을 함&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Kernel#require 을 다른 이름으로 별칭화&lt;/li&gt;
&lt;li&gt;Monkeypatch는 rakefile에 필요한 require하는 이름들을 저장한다.&lt;/li&gt;
&lt;li&gt;마지막으로 원래 요구사항으로 돌아가고, 걔는 require&lt;em&gt;without&lt;/em&gt;record라고 불리는 메서드로 별칭&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;이 속임수를 around alias로 부름&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Around Alias 작성법&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Alias a method&lt;/li&gt;
&lt;li&gt;Redefine it&lt;/li&gt;
&lt;li&gt;Call the old method from the new method&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;additional method name으로 클래스를 오염시킨다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;구 버전의 메서드를 별칭으로 지정한 후 비공개로 만들면 해결 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;로딩과 관련된 잠재적인 문제, around method를 두 번 로드하면 안된다.&lt;/li&gt;
&lt;li&gt;Monkey patch의 한 형태이다..... 따라서 이런 추가적인 기능을 래핑하는 두 가지 방법을 추가로 도입&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;More Method Wrappers&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;StringRefinement&lt;/span&gt;
  refine &lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;length&lt;/span&gt;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;long&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;short&apos;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
using &lt;span class=&quot;token constant&quot;&gt;StringRefinement&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;War and Peace&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length      &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;long&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;around alias보다는 일반적으로 안전하다.&lt;/li&gt;
&lt;li&gt;파일 끝, 혹은 모듈 정의 까지만 정의됨&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ExplicitString&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;length&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;long&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;short&apos;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;class_eval &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;prepend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ExplicitString&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;War and Peace&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length      &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;long&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;prepend wrapper로 사용 가능함&lt;/li&gt;
&lt;li&gt;로컬적이지는 않지만 refine이나 어라운드 별칭보다 더 깨끗하고 명확하다고 여겨진다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Solving the Amazon Problem&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;AmazonWrapper&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;reviews_of&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;book&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    start &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;now
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;
    time_taken &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;now &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; start
    puts &lt;span class=&quot;token string&quot;&gt;&quot;reviews_of() took more than &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;time_taken&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; seconds&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; time_taken &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
    result
  &lt;span class=&quot;token keyword&quot;&gt;rescue&lt;/span&gt;
    puts &lt;span class=&quot;token string&quot;&gt;&quot;reviews_of() failed&quot;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;Amazon&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;class_eval &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;prepend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;AmazonWrapper&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Wrap-Up&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;클래스 정의에서의 self ( 메서드 호출의 기본 수신기 ) 및 current class ( 정의하는 메서드의 기본 홈 ) 에 미치는 영향&lt;/li&gt;
&lt;li&gt;signle tone method 및 signleton 클래스를 통해 객체 모델 및 메서드 검색에 대한 새로운 인사이트&lt;/li&gt;
&lt;li&gt;클래스 인스턴스 변수, 클래스 매크로 및 래퍼를 포함한 여러가지 트릭&lt;/li&gt;
&lt;li&gt;클래스에 대해 배운 모든 것을 모듈에 적용 가능함 - 클래스 인스턴스 변수는 모듈 인스턴스 변수일 수 있음&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[M Ruby - 4. Blocks]]></title><description><![CDATA[Blocks 블록은 스코프를 제어하기 위한 강력한 도구 블록은 단지 호출 가능한 객체의 큰 구성원 블록을 저장하고 나중에 실행하는 등 이런 객체와 다른 호출 가능한 객체를 최대한 활용하는 방법 설명 예정 The Day of the Blocks…]]></description><link>https://blog.seongjun.kr/metaprogramming-ruby-4/</link><guid isPermaLink="false">https://blog.seongjun.kr/metaprogramming-ruby-4/</guid><pubDate>Thu, 22 Apr 2021 00:00:00 GMT</pubDate><content:encoded>&lt;h1&gt;Blocks&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;블록은 스코프를 제어하기 위한 강력한 도구&lt;/li&gt;
&lt;li&gt;블록은 단지 호출 가능한 객체의 큰 구성원&lt;/li&gt;
&lt;li&gt;블록을 저장하고 나중에 실행하는 등 이런 객체와 다른 호출 가능한 객체를 최대한 활용하는 방법 설명 예정&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;The Day of the Blocks&lt;/h2&gt;
&lt;h3&gt;Roadmap&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;블록 기초&lt;/li&gt;
&lt;li&gt;범위 개요 및 블록 클로져를 사용한 변수의 범위 이동&lt;/li&gt;
&lt;li&gt;블록을 호출 가능한 객체로 변환하여 따로 두는 방법, Procs나 람다처럼 나중에 호출&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;The Basics of Blocks&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;a_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  a &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

a_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;y&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#=&gt; 3&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;중괄호나 &lt;code class=&quot;language-text&quot;&gt;do..end&lt;/code&gt; 로 정의할 수 있다.&lt;/li&gt;
&lt;li&gt;메서드를 호출할 때만 블록을 정의 가능&lt;/li&gt;
&lt;li&gt;블록은 메서드로 바로 전달되며 메소드는 &lt;code class=&quot;language-text&quot;&gt;yield&lt;/code&gt; 키워드로 블록을 다시 호출 가능&lt;/li&gt;
&lt;li&gt;블록은 인수를 가질수도 있다. 예시처럼 인수를 제공 가능&lt;/li&gt;
&lt;li&gt;블록은 메서드처럼 마지막 줄을 반환&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Kernel#block_given?&lt;/code&gt; 으로 블록이 포함되어 있는지 확인 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;a_method&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; block_given&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&apos;no block&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
a_method
a_method &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;here&apos;s a block!&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;no block&quot;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;here&apos;s a block!&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Blocks Are Closures&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;코드가 실행할 때 지역변수, 인스턴스 변수, 셀프등이 필요..&lt;/li&gt;
&lt;li&gt;코드와 바인딩으로 이뤄져서 뭔가 실행되는 것&lt;/li&gt;
&lt;li&gt;이런 엔티티들은 객체에 바인딩된 것이므로 바인딩이라고 부르겠다?&lt;/li&gt;
&lt;li&gt;블록이 어디서 바인딩을 주워오는지....&lt;/li&gt;
&lt;li&gt;블록을 정의하는 순간 바인딩을 잡은 다음 블록을 메서드로 전달할 때... 함께 바인딩을 전달한다..&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
  x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Goodbye&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;cruel&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Hello&quot;&lt;/span&gt;
my_method &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;y&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;x&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;, &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;y&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; world&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;Hello, cruel world&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;블록을 생성할 때 x같은 로컬 바인딩을 캡쳐한다.&lt;/li&gt;
&lt;li&gt;블록을 별도의 바인딩 집합이 있는 메서드로 전달한다.&lt;/li&gt;
&lt;li&gt;여전히 블록의 코드는 블록에서 아예 안보이는 메서드의 x가 아닌 블록이 정의되었을 떄 있었던 x를 본다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;just_yield&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
top_level_variable &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
just_yield &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  top_level_variable &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
  local_to_block &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
top_level_variable  &lt;span class=&quot;token comment&quot;&gt;# =&gt; 2&lt;/span&gt;
local_to_block      &lt;span class=&quot;token comment&quot;&gt;# =&gt; Error!&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;블록 내에서 추가 바인딩 정의도 가능하지만 블록 이후에 사라짐&lt;/li&gt;
&lt;li&gt;이런 특성때문에 블록을 클로져라고 하기도 하는듯&lt;/li&gt;
&lt;li&gt;다른 사람들은 블록이 로컬바인딩을 캡쳐하여 옮긴다고 함&lt;/li&gt;
&lt;li&gt;클로져를 실제로 어떻게 쓸까? 이를 이해하려면 바인딩의 위치, 즉 범위를 자세히 쌀펴야한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Scope&lt;/h3&gt;
&lt;h4&gt;Changing Scope&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Kernel#local_variables&lt;/code&gt; 를 통해 바인딩의 이름을 추적하여 스코프 보는 예시&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;v1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  v2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  local_variables &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:v2]&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
    v3 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
    local_variables
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  local_variables &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:v2]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:v3]&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:v3]&lt;/span&gt;
local_variables &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:v1, :obj]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;루비에서는 자바나 C#처럼 내부의 스코프에서 외부의 스코프를 볼수있게 하지 않음, 즉 뚜력하게 구분됨&lt;/li&gt;
&lt;li&gt;새로운 범위를 들어가자마자 새로운 바인딩으로 대체됨&lt;/li&gt;
&lt;li&gt;클래스 내에서 v1이 다시 표시 안되는 것 처럼&lt;/li&gt;
&lt;li&gt;정의 끝날때까지.... 스코프 닫히고 다시 최상위로...&lt;/li&gt;
&lt;li&gt;만약 my_method를 재정의? 당연히 새 바인딩 세트&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Scope Gates&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;이전 스코프를 버리고 새 스코프를 여는 위치&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Class definitions&lt;/li&gt;
&lt;li&gt;Module definitions&lt;/li&gt;
&lt;li&gt;Methods&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;v1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# SCOPE GATE: entering class&lt;/span&gt;
  v2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  local_variables &lt;span class=&quot;token comment&quot;&gt;# =&gt; [&quot;v2&quot;]&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# SCOPE GATE: entering def&lt;/span&gt;
    v3 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
    local_variables
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;# SCOPE GATE: leaving def&lt;/span&gt;
  local_variables &lt;span class=&quot;token comment&quot;&gt;# =&gt; [&quot;v2&quot;]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# SCOPE GATE: leaving class&lt;/span&gt;
obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:v3]&lt;/span&gt;
local_variables &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:v1, :obj]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;클래스나 모듈은 즉시 코드가 실행 됨&lt;/li&gt;
&lt;li&gt;메서드는 메서드 호출 시 실행됨&lt;/li&gt;
&lt;li&gt;바인딩이 변하는 위치를 알았는데 만약 변수를 하나 넘기고싶다면?&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Flattening the Scope&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;my_var &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Success&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# We want to print my_var here...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# ..and here&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;my_var을 두 개의 장벽을 거쳐서 어떻게 전달하지..?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt; my_var &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Success&quot;&lt;/span&gt;
➤ &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
➤ &lt;span class=&quot;token comment&quot;&gt;# Now we can print my_var here...&lt;/span&gt;
➤ puts &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;my_var&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; in the class definition!&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# ...but how can we print it here?&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Class를 Scope Gate가 아닌 메서드 호출로 바꿔서 전달한다면?&lt;/li&gt;
&lt;li&gt;이제 메서드에 전달하려면..?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;my_var &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Success&quot;&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;my_var&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; in the class definition&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:my_method&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;my_var&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; in the method&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method

require_relative &lt;span class=&quot;token string&quot;&gt;&quot;../test/assertions&quot;&lt;/span&gt;
assert_equals &lt;span class=&quot;token string&quot;&gt;&quot;Success in the method&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method

&lt;span class=&quot;token constant&quot;&gt;Success&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; the &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;definition&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;Success&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; the method&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Scope Gate를 메서드호출로 변경하면 한 스코프가 다른 스코프의 변수를 볼 수 있다.&lt;/li&gt;
&lt;li&gt;엄밀히 말하면 이걸 nested lexical scopes라고 부르고, 루비 코더들은 flattening the scope라고 함&lt;/li&gt;
&lt;li&gt;flat scope&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Sharing the scope&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;저거 알면 이제 스코프로 하고싶은거 다 할 수 있다.&lt;/li&gt;
&lt;li&gt;만약 몇 가지 메서드 간에 변수를 공유, 다른 사람이 해당 변수를 못하도록&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;define_methods&lt;/span&gt;&lt;/span&gt;
  shared &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
  &lt;span class=&quot;token constant&quot;&gt;Kernel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send &lt;span class=&quot;token symbol&quot;&gt;:define_method&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:counter&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    shared
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token constant&quot;&gt;Kernel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send &lt;span class=&quot;token symbol&quot;&gt;:define_method&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:inc&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;x&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    shared &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; x
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

define_methods

counter       &lt;span class=&quot;token comment&quot;&gt;# =&gt; 0&lt;/span&gt;
inc&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
counter       &lt;span class=&quot;token comment&quot;&gt;# =&gt; 4&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;두개의 커널 메서드를 정의함&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Kernel#counter&lt;/code&gt;, inc는 공유변수를 사용 가능&lt;/li&gt;
&lt;li&gt;하지만 다른 메서드에서는 확인 불가능&lt;/li&gt;
&lt;li&gt;이 공유 스코프는 실제로 많이 사용되지 않지만, 강력한 트릭이자 스코프으 ㅣ힘을 보여주는 에시&lt;/li&gt;
&lt;li&gt;스코프게이트, 플랫 스코프 및 공유 스코프를 함께 쓰면 스코프를 비틀거나 구부려서 원하는 위치에서 필요한 변수를 정확하게 확인 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Clousure Wrap Up&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;각 스코프에는 여러 바인딩이 포함, 스코프는 스코프 게이트로 구분 된다 - class module def&lt;/li&gt;
&lt;li&gt;만약 Scope Gate를 통해 바인딩된 변수를 전달하려면 블록을 쓸 수 있다.&lt;/li&gt;
&lt;li&gt;블록은 클로져다, 블록을 정의하면 현재 환경에서 바인딩을 캡쳐하여 이동한다.&lt;/li&gt;
&lt;li&gt;따라서 Scope Gate를 메서드 호출로 바꾸고 클로저의 현재 바인딩을 캡쳐하고 클로져를 메서드로 전달 가능&lt;/li&gt;
&lt;li&gt;Class.new, Module,new def를 Module define_method로 변경 가능&lt;/li&gt;
&lt;li&gt;기본적인 클로저 관련 매쥑 플랫 스코프&lt;/li&gt;
&lt;li&gt;스코프 게이트로 보호되는 동일한 플랫 스코프에서 여러 메서드를 정의하는 경우 이런 메서드가 바인딩 공유 가능 - 공유 스코프&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;instance_eval()&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;컨텍스트에서 블록을 eval하는 &lt;code class=&quot;language-text&quot;&gt;BasicObject#instance_eval&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@v&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_eval &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;        &lt;span class=&quot;token comment&quot;&gt;# =&gt; #&amp;lt;MyClass:0x3340dc @v=1&gt;&lt;/span&gt;
  &lt;span class=&quot;token variable&quot;&gt;@v&lt;/span&gt;          &lt;span class=&quot;token comment&quot;&gt;# =&gt; 1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;블록은 리시버를 self로 해서 같이 evaluated 하므로 private method, instance variables에 접근이 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;v&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_eval &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@v&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; v &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_eval &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@v&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; 2&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;instance_eval로 전달된 블록은 다른 블록처럼 해당 위치에서의 바인딩.&lt;/li&gt;
&lt;li&gt;Flat Scope에서 evaluated되므로 .... v도 접근되고 @v도 접근이 가능&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;instance_eval로 전달되는 블록을 context probe라고 함?!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;코드 조각이 객체 내부에서 동작....하는것...같이...&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Breaking Encapsulation&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Context Probe를 쓰면 캡슐화에 큰 피해&lt;/li&gt;
&lt;li&gt;실용적으로는 캡슐화가 방해되는 상황이 있다...?&lt;/li&gt;
&lt;li&gt;캡슐화를 깨는 또 다른 납든할 수 있는 이유는 거의 테스트!&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;The Padrino Example&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Padrino 는 Logger class를 정의함&lt;/li&gt;
&lt;li&gt;Logger는 설정을 인스턴스 변수에 저장함&lt;/li&gt;
&lt;li&gt;Padrino의 테스트는 응용프로그램의 로거 구성을 변경해야한다.&lt;/li&gt;
&lt;li&gt;새 로거를 만들고 구성하는 문제를 겪지 않고 context probe를 사용하여 구성을 변경한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;describe &lt;span class=&quot;token string&quot;&gt;&quot;PadrinoLogger&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  context &lt;span class=&quot;token string&quot;&gt;&apos;for logger functionality&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    context &lt;span class=&quot;token string&quot;&gt;&quot;static asset logging&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      should &lt;span class=&quot;token string&quot;&gt;&apos;not log static assets by default&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
        get &lt;span class=&quot;token string&quot;&gt;&quot;/images/something.png&quot;&lt;/span&gt;
        assert_equal &lt;span class=&quot;token string&quot;&gt;&quot;Foo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; body
        assert_match &lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Padrino&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;log&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;string
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
      should &lt;span class=&quot;token string&quot;&gt;&apos;allow turning on static assets logging&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
        &lt;span class=&quot;token constant&quot;&gt;Padrino&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_eval&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@log_static&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
        get &lt;span class=&quot;token string&quot;&gt;&quot;/images/something.png&quot;&lt;/span&gt;
        assert_equal &lt;span class=&quot;token string&quot;&gt;&quot;Foo&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; body
        assert_match &lt;span class=&quot;token regex&quot;&gt;/GET/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Padrino&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;log&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;string
        &lt;span class=&quot;token constant&quot;&gt;Padrino&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_eval&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@log_static&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;첫 테스트는 아무것도 기록하지 않는 것을 확인&lt;/li&gt;
&lt;li&gt;두 번째 테스트에서는 instance_eval로 로거의 구성을 변경하고 정적 파일 로깅을 활성화&lt;/li&gt;
&lt;li&gt;기록을 확인하고, 다시 비활성화&lt;/li&gt;
&lt;li&gt;루비의 다른 많은 것들과 마찬가지로 캡슐화는 무시할 수 있는 유연한 도구이며 이러한 위험을 받아들일지... 는 우리에게 달려있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Clean Rooms&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;단지 객체를 생성한다 블록 안을 evaluate하기위해?&lt;/li&gt;
&lt;li&gt;이 객체는 Clean Room이라고 불린다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CleanRoom&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;current_temperature&lt;/span&gt;&lt;/span&gt;
   &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
clean_room &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;CleanRoom&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
clean_room&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_eval &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; current_temperature &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# TODO: wear jacket&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;클린 룸은 클록을 eval 할 수 있는 환경일 뿐&lt;/li&gt;
&lt;li&gt;이상적인 클린룸은 메서드 및 인스턴스 변수가 많지 않음 - 블록과 충돌때문에..?&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;BasicObject의 인스턴스는 Blank Slates이므로 좋은 클린룸을 제공한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;너무 깨끗해서 String같은 표준 루비 상수도 없음. 절대경로 써야함 ::String 처럼&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Callable Objects&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;블록 사용은 두 단계의 과정&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;일부 코드를 따로 두고&lt;/li&gt;
&lt;li&gt;블록을 호출하여 실행&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&quot;코드 패키지 우선, 나중에 호출&quot;은 블록에만 국한된 게 아니다&lt;/li&gt;
&lt;li&gt;proc 블록은 객체로 변경된 블록&lt;/li&gt;
&lt;li&gt;lambda proc을 약간 변형한 것&lt;/li&gt;
&lt;li&gt;methods&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Proc Objects&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;루비의 대부분은 객체지만 블록은 아니다?&lt;/li&gt;
&lt;li&gt;뭔 상관? -&gt; 블록을 저장하고 나중에 쓰려한다. 그러려면 객체가 필요함&lt;/li&gt;
&lt;li&gt;이 문제를 해결하기위해 Proc, 객체로 변환된 블록임&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;inc &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Proc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;x&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# more code...&lt;/span&gt;
inc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; 3&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Deferred Evaluation이라 함&lt;/li&gt;
&lt;li&gt;몇 가지 방법이 더 있음&lt;/li&gt;
&lt;li&gt;lambda 로 만드는 것은 조금 차이가 있지만 대부분 원하는 것을 얻을 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;dec &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; lambda &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;x&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
dec&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; Proc&lt;/span&gt;
dec&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; 1&lt;/span&gt;
p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; x&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#=&gt; called stabby lambda operator&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;The &amp;#x26; Operator&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;메서드로 블록을 넘겨서 사용하는 경우 대부분 yield로 충분하지만, 아닌 경우도 있음&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;블록을 다른 메서드에게 넘기고 싶다거나&lt;/li&gt;
&lt;li&gt;블록을 Rroc로 변환하고싶다거나&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;둘다 모두 블록을 사용하겠다고 말 해줘야함, - 블록을 바인딩하기 위해서는 &quot;&amp;#x26;&quot; 가 필요함&lt;/li&gt;
&lt;li&gt;인수 목록의 마지막이여야 하고 &amp;#x26;기호를 사용해야함&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;math&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;do_math&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;operation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  math&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;operation&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
do_math&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;y&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;x&lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;y&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#=&gt;6&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&amp;#x26; 의 뜻은 &quot;나는 이 메서드로 전달되는 블록을 Proc으로 바꾸고 싶다&quot; 라는 뜻이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;the_proc&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  the_proc
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; my_method &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Hello, &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;!&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
p&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;         &lt;span class=&quot;token comment&quot;&gt;# =&gt; Proc&lt;/span&gt;
p&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Bill&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;Hello, Bill!&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;바로 리턴해보면 Proc임&lt;/li&gt;
&lt;li&gt;다시 Proc을 블록으로 변경하고 싶다면? &amp;#x26;를 또 쓰면 댐?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;greeting&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;greeting&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;, &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;!&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
my_proc &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; proc &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Bill&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
my_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Hello&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;my_proc&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&amp;#x26;는 my_proc을 블록으로 변환하고 그 블록을 메서드로 전달한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;The Higline example&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;콘솔 입력 및 출력을 자동화 하는 잼&lt;/li&gt;
&lt;li&gt;쉼표로 구분된 사용자 입력을 수집하여 배열로 분할 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;highline&apos;&lt;/span&gt;
hl &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;HighLine&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
friends &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; hl&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ask&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Friends?&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; s&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;split&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;,&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
puts &lt;span class=&quot;token string&quot;&gt;&quot;You&apos;re friends with: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;friends&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;inspect&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
❮ &lt;span class=&quot;token constant&quot;&gt;Friends?&lt;/span&gt;
➾ &lt;span class=&quot;token constant&quot;&gt;Ivana&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Roberto&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Olaf&lt;/span&gt;
❮ &lt;span class=&quot;token constant&quot;&gt;You&lt;/span&gt;&apos;re friends with&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Ivana&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot; Roberto&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot; Olaf&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;HighLine#ask&lt;/code&gt; 는 post processing 코드를 Proc으로 받아서 쓴다.&lt;/li&gt;
&lt;li&gt;왜 블록이 아닌 Proc이냐? - 다른 HighLine 메커니즘을 위해 예약되어있음&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt; name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; hl&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ask&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Name?&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; lambda &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;s&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; s&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;capitalize &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
   puts &lt;span class=&quot;token string&quot;&gt;&quot;Hello, &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
❮ &lt;span class=&quot;token constant&quot;&gt;Name?&lt;/span&gt;
➾ bill
❮ &lt;span class=&quot;token constant&quot;&gt;Hello&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Bill&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Procs vs Lambdas&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;미묘하게 다른데 많이 혼란스러울 것 이다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;대략적인 중요한 차이점 두가지&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;반환 키워드와 관련&lt;/li&gt;
&lt;li&gt;인수 확인과 관련&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Procs, Lambdas and return&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;리턴 키워드가 다른 것을 의미한다&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;double&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;callable_object&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  callable_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
l &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; lambda &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
double&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;l&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; 20&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;another_double&lt;/span&gt;&lt;/span&gt;
  p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Proc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; p&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call
  puts result
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; result &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# unreachable code!&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
another_double &lt;span class=&quot;token comment&quot;&gt;# =&gt; 10&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Proc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
double&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;p&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# =&gt; LocalJumpError&lt;/span&gt;
p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Proc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
double&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;p&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# =&gt; 20&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;proc.call 하는 순간 그 리턴코드가 리턴 되어버리네...&lt;/li&gt;
&lt;li&gt;블록이 언랩되는 느낌인가?&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Procs, Lambdas, and Arity&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;두 번째 차이점은 argument를 확인하는 것&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;p &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Proc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
p&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# =&gt; [1, 2]&lt;/span&gt;
p&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;         &lt;span class=&quot;token comment&quot;&gt;# =&gt; [1, nil]&lt;/span&gt;
l &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
l&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; ArgumentError: wrong number of arguments (given 3, expected 2)&lt;/span&gt;
l&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; ArgumentError: wrong number of arguments (given 1, expected 2)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;람다는 에러, Proc은 초과인수 버림&lt;/li&gt;
&lt;li&gt;일반적으로 람다를 많이&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Method Objects&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@x&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; value
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@x&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
m &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;method &lt;span class=&quot;token symbol&quot;&gt;:my_method&lt;/span&gt;
m&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Kernel#method&lt;/code&gt; 로 메서드 자체를 메서드 객체로 얻을 수 있다.&lt;/li&gt;
&lt;li&gt;호출도 가능함.&lt;/li&gt;
&lt;li&gt;ruby 2.1부터는 &lt;code class=&quot;language-text&quot;&gt;Kernel#singleton_method&lt;/code&gt; 라는 것도 있다는데..&lt;/li&gt;
&lt;li&gt;Proc이랑 Lambda랑 유사 하지만... 중요한 차이&lt;/li&gt;
&lt;li&gt;Lambda는 정의된 범위에서 eval&lt;/li&gt;
&lt;li&gt;메서드는 객체의 범위 에서 eval&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Unbound Methods&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;클래스 또는 모듈에서 분리된 메서드&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Metdhod#unbind&lt;/code&gt;를 통해서 메서드를 Unbound 메서드로 만들 수 있음&lt;/li&gt;
&lt;li&gt;instance_method로도 만들 수 있음&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyModule&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
unbound &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyModule&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:my_method&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
unbound&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;              &lt;span class=&quot;token comment&quot;&gt;# =&gt; UnboundMethod&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;unbound method를 호출할 순 없지만 호출할 수 있는 일반 메서드르 생성하는 데 사용 가능하다.&lt;/li&gt;
&lt;li&gt;bind를 사용하여 객체에 바인딩 하면 된다.&lt;/li&gt;
&lt;li&gt;기존에는 클래스에서 가져온 동일한 클래스의 객체에만 바인딩 가능했지만 2.0부터는 다됨.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;class_eval &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:another_method&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; unbound
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;abc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;another_method &lt;span class=&quot;token comment&quot;&gt;# =&gt; 42&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;매우 특이한 케이스에만 사용됨&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;The Active Support Example&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Active Support는 여러 유틸 중에서 해당 파일에 정의된 상수를 사용할 떄 자동으로 Ruby 파일을 로드하는 클래스 및 모듈 세트가 포함되어 있다.&lt;/li&gt;
&lt;li&gt;이 &quot;Autoloading&quot; 시스템은 &lt;code class=&quot;language-text&quot;&gt;Kernel#load&lt;/code&gt; 함수를 재정의 하는 Loadable이라는 모듈을 포함한다.&lt;/li&gt;
&lt;li&gt;클래스에 Loadable이 포함된 경우 Loadable#load는 상위 체인의 Kernel#load보다 낮아진다.&lt;/li&gt;
&lt;li&gt;따라서 Loadable#load가 호출 됨&lt;/li&gt;
&lt;li&gt;경우에 따라 Loadable#load를 제거하고 바닐라 Kernel#load를 사용하기도 하는데&lt;/li&gt;
&lt;li&gt;루비에는 언 인클루드가 없으므로 조상을 제거할 수 없다. 이럴떄..&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Loadable&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;exclude_from&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;base&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    base&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;class_eval &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:load&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Kernel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:load&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;#...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;unboundmethod의 좋은 예고, 구체적인 문제에 대한 솔루션이기도 함&lt;/li&gt;
&lt;li&gt;즉 두 개의 로드 메서드가 동일하고 혼란스럽게 만드는 솔루션..&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Callable Objects Wrap-Up&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;evaluate 가능한 코드 조각, 고유한 스코프를 가짐&lt;/li&gt;
&lt;li&gt;Blocks - (objects는 아니지만 callable함 ) - 정의된 스코프 내에서 evaluated&lt;/li&gt;
&lt;li&gt;Procs - Proc 클래스 객체임 블록과 마찬가지로 정의된 범위 내에서 eval&lt;/li&gt;
&lt;li&gt;Lambdas - 똑같이 Procs의 객체지만 약간 다름, 똑같이 클로저고 정의되는 범위 안에서 eval&lt;/li&gt;
&lt;li&gt;Method - 객체에 바인딩 된 메서드는 해당 객체의 범위 안에서 eval, 리바인드 가능,&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;각 오브젝트 마다 미묘하게 다른 동작이 나타난다.&lt;/p&gt;
&lt;p&gt;메서드와 람다는 callable object로부터 반환하는 반면 Procs와 Block은 호출 가능한 객체의 원래 컨턱스트에서 반환을 한다.&lt;/p&gt;
&lt;p&gt;또한 다른 아리티를 가진 호출에 대해 다르게 반응한다.&lt;/p&gt;
&lt;p&gt;메서드가 더 엄격, 람다가 그만큼 엄격, 프록과 블록이 덜 엄격&lt;/p&gt;
&lt;p&gt;그럼에도 &amp;#x26; 로 각 객체들이 변환 가능&lt;/p&gt;
&lt;h2&gt;Writing a Domain-Specific Language&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;RedFlag라는 영엄부 직원을 위한 모니터링 유틸리티&lt;/li&gt;
&lt;li&gt;주문이 늦을 때 총 매출이 너무 낮을 때 기본적으로 여러 가지 일이 발생할 때마다 메시지&lt;/li&gt;
&lt;li&gt;DSL정도만 작성하면 된다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;event &lt;span class=&quot;token string&quot;&gt;&quot;we&apos;re earning wads of money&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    recent_orders &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# (read from database)&lt;/span&gt;
    recent_orders &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;true 반환 시 메일, false는 패스&lt;/li&gt;
&lt;li&gt;시스템은 몇 분마다 모든 이벤트를 확인&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Your First DSL&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt; &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;event&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;description&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    puts &lt;span class=&quot;token string&quot;&gt;&quot;ALERT: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;description&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
load &lt;span class=&quot;token string&quot;&gt;&apos;events.rb&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;event &lt;span class=&quot;token string&quot;&gt;&quot;an event that always happens&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
event &lt;span class=&quot;token string&quot;&gt;&quot;an event that never happens&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Sharing Among Events&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;이벤트를 작성하는 사람들은 이벤트 간에 데이터를 공유하고 싶어할 것이다...&lt;/li&gt;
&lt;li&gt;DSL로 될까?두 개의 개별 이벤트가 동일한 변수에 액세스할 수 있나?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;monthly_sales&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;110&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# TODO: read the real number from the database&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
target_sales &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
event &lt;span class=&quot;token string&quot;&gt;&quot;monthly sales are suspiciously high&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    monthly_sales &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; target_sales
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  event &lt;span class=&quot;token string&quot;&gt;&quot;monthly sales are abysmally low&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    monthly_sales &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; target_sales
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;flat scope가 있지~&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;❮ &lt;span class=&quot;token constant&quot;&gt;ALERT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; monthly sales are suspiciously high&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;하지만 변수들이 최상위 범위를 혼란스럽게 함.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;setup &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    puts &lt;span class=&quot;token string&quot;&gt;&quot;Setting up sky&quot;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@sky_height&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
setup &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    puts &lt;span class=&quot;token string&quot;&gt;&quot;Setting up mountains&quot;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@mountains_height&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
event &lt;span class=&quot;token string&quot;&gt;&quot;the sky is falling&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@sky_height&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;300&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
event &lt;span class=&quot;token string&quot;&gt;&quot;it&apos;s getting closer&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@sky_height&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@mountains_height&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
event &lt;span class=&quot;token string&quot;&gt;&quot;whoops... too late&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@sky_height&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Setting up sky&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#Setting up mountains&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#ALERT: the sky is falling&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#Setting up sky&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#Setting up mountains&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#ALERT: it&apos;s getting closer&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#Setting up sky&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#Setting up mountains&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;세 이벤트 각각 이전의 모든 설정을 실행한다.&lt;/li&gt;
&lt;li&gt;@변수로 , 이벤트가 변수를 읽을 수 있음&lt;/li&gt;
&lt;li&gt;모든 공유변수는 설정에서 초기화되고 이벤트에서 사용되므로 변수를 쉽게 추적 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;event&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;description&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token variable&quot;&gt;@events&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:description&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; description&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:condition&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; block&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;@events&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
load &lt;span class=&quot;token string&quot;&gt;&apos;events.rb&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;새 이벤트 메서드는 이벤트 조건을 블록해서 Proc으로 변환,&lt;/li&gt;
&lt;li&gt;이벤트의 설명과 proc을 해시에 래핑하고 이벤트 배열에 저장&lt;/li&gt;
&lt;li&gt;배열은 글로벌 변수 및 최상위 인스턴스 변수이므로 이벤트 메서드 외부에서 초기화할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;setup&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token variable&quot;&gt;@setups&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; block
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;event&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;description&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token variable&quot;&gt;@events&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:description&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; description&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:condition&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; block&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;@setups&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;@events&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
load &lt;span class=&quot;token string&quot;&gt;&apos;events.rb&apos;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;@events&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;event&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;token variable&quot;&gt;@setups&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;setup&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    setup&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  puts &lt;span class=&quot;token string&quot;&gt;&quot;ALERT: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; event&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:condition&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;하지만 setups과 events는 글로벌 변수같다..&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Removing the &quot;Global&quot; Varaibles&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Shared scope?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;lambda &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  setups &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  events &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token constant&quot;&gt;Kernel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send &lt;span class=&quot;token symbol&quot;&gt;:define_method&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:setup&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    setups &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; block
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token constant&quot;&gt;Kernel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send &lt;span class=&quot;token symbol&quot;&gt;:define_method&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:event&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;description&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    events &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:description&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; description&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:condition&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; block&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token constant&quot;&gt;Kernel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send &lt;span class=&quot;token symbol&quot;&gt;:define_method&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:each_setup&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    setups&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;setup&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
      block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call setup
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token constant&quot;&gt;Kernel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send &lt;span class=&quot;token symbol&quot;&gt;:define_method&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:each_event&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    events&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;event&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
      block&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call event
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call

load &lt;span class=&quot;token string&quot;&gt;&apos;events.rb&apos;&lt;/span&gt;
each_event &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;event&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  each_setup &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;setup&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
setup&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  puts &lt;span class=&quot;token string&quot;&gt;&quot;ALERT: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; event&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:condition&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;추악한 글로벌 변수들은 사라졌지만...&lt;/li&gt;
&lt;li&gt;예전처럼 간단하진 않다&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Adding a Clean Room&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;event &lt;span class=&quot;token string&quot;&gt;&quot;define a shared variable&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token variable&quot;&gt;@x&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
event &lt;span class=&quot;token string&quot;&gt;&quot;change the variable&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token variable&quot;&gt;@x&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@x&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이벤트가 설정을 통해 변수를 공유하기를 원하지만 이벤트가 서로의 변수를 공유할 필요는 없다.&lt;/li&gt;
&lt;li&gt;기능인지 버그인지는 우리에게 달려있다.&lt;/li&gt;
&lt;li&gt;이벤트가 가능한 독립적으로 동작해야한다면 클린룸에서 실행 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;each_event &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;event&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  env &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
  each_setup &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;setup&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_eval &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;setup
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  puts &lt;span class=&quot;token string&quot;&gt;&quot;ALERT: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:description&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; env&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_eval &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;event&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:condition&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이제 해당 설정은 클린룸 역할을 하는 오브젝트의 컨텍스트에서 eval된다&lt;/li&gt;
&lt;li&gt;설정 및 이벤트의 인스턴스 변수는 최상위 인스턴스 변수가 아니라 클린룸의 인스턴스 변수&lt;/li&gt;
&lt;li&gt;최상위 인스턴스 변수가 아닌 클린룸의 인스턴스 변수이므로 .. 이벤트는 인스턴스 변수를 공유 못함&lt;/li&gt;
&lt;li&gt;BasicObject를 사용할 수도 있지만 일반적인 메서드가 없음.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Wrap Up&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Scope Gate가 무엇인지&lt;/li&gt;
&lt;li&gt;플랫 스코프와 공유 스코프를 사용하여 범위를 통해 바인딩을 표시하는 방법&lt;/li&gt;
&lt;li&gt;객체의 범위 - instance&lt;em&gt;eval, instance&lt;/em&gt;exec 또는 클린룸에서 코드를 실행하는 방법&lt;/li&gt;
&lt;li&gt;블록을 객체(Proc)로 반환하고 돌리는 방법&lt;/li&gt;
&lt;li&gt;메소드를 객체로 (Method, UnboundMethod)로 변환하는 방법 및 되돌리기&lt;/li&gt;
&lt;li&gt;Callable Object 유형간의 차이&lt;/li&gt;
&lt;li&gt;-&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[M Ruby - 3. Methods]]></title><description><![CDATA[Methods 자바나 C…]]></description><link>https://blog.seongjun.kr/metaprogramming-ruby-3/</link><guid isPermaLink="false">https://blog.seongjun.kr/metaprogramming-ruby-3/</guid><pubDate>Thu, 15 Apr 2021 00:00:00 GMT</pubDate><content:encoded>&lt;h1&gt;Methods&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;자바나 C처럼 강타입 언어는 컴파일러가 모든 메서드 호출에 대해 수신 객체가 일치하는 메서드를 갖고있는지 확인한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;정적 유형 검사라고 하며 정적 타입 언어가 이를 채택해서 사용함&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;파이썬이나 루비같은 동적 언어들은 컴파일러가 확인하지 않음&lt;/li&gt;
&lt;li&gt;루비에서는 boilerplate method가 문제가 안되는데 이에 대해 알아보자~&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;중복 문제&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;99$를 이상을 쓰는 컴퓨터 장비를 찾기&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;레거시 시스템&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;DS(Data Source)라는 이름의 클래스 뒤에 레거시 시스템에 데이터들이 저장되어있다&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;DS&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# connect to data source...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;get_cpu_info&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;workstation_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;get_cpu_price&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;workstation_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;get_mouse_info&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;workstation_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;get_mouse_price&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;workstation_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;get_keyboard_info&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;workstation_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;get_keyboard_price&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;workstation_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;get_display_info&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;workstation_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;get_display_price&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;workstation_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# ...and so on&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;DS#initialize&lt;/code&gt; 새 DS object를 만들 때 디비와 연결 된다.&lt;/li&gt;
&lt;li&gt;다른 메서드들(수십 개의)은 워크스테이션 id를 갖고 컴퓨터 부품에 대한 설명과 가격을 반환한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;ds &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;DS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
ds&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_cpu_info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;2.9 Ghz quad-core&quot;&lt;/span&gt;
ds&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_cpu_price&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; 120&lt;/span&gt;
ds&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_mouse_info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;Wireless Touch&quot;&lt;/span&gt;
ds&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_mouse_price&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# =&gt; 60&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Double, Treble,... Trouble&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;각 어플리케이션에 맞는 객체로 DB를 래핑해야한다.&lt;/li&gt;
&lt;li&gt;즉, 각 컴퓨터가 객체여야 한다.&lt;/li&gt;
&lt;li&gt;이 객체는 각 구성요소에 대해 단일 메서드를 갖고있고 해당 구성 요소의 가격을 모두 설명하는 문자열을 반환한다.&lt;/li&gt;
&lt;li&gt;100$이상이면 주의를 끌기위해 별을 붙인다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#methods/computer/duplicated.rb&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Computer&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;computer_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data_source&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; computer_id
    &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data_source
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;mouse&lt;/span&gt;&lt;/span&gt;
    info &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_mouse_info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    price &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_mouse_price&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Mouse: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;info&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; ($&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;price&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;)&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;* &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;result&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; price &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
    result
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;cpu&lt;/span&gt;&lt;/span&gt;
    info &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_cpu_info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    price &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_cpu_price&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Cpu: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;info&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; ($&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;price&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;)&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;* &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;result&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; price &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
    result
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;keyboard&lt;/span&gt;&lt;/span&gt;
    info &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_keyboard_info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    price &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_keyboard_price&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Keyboard: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;info&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; ($&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;price&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;)&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;* &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;result&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; price &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
    result
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;중복이 많다.&lt;/li&gt;
&lt;li&gt;메서드가 많다&lt;/li&gt;
&lt;li&gt;각 메서드에 대한 테스트를 작성해야한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;동적 메서드&lt;/h2&gt;
&lt;p&gt;동적으로 메서드를 호출하고 정의하는 방법과 중복 코드를 제거하는 방법&lt;/p&gt;
&lt;h3&gt;함수 동적으로 호출하기&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;my_arg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    my_arg &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# =&gt; 6&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;다른 방법으로 &lt;code class=&quot;language-text&quot;&gt;MyClass#my_method&lt;/code&gt; 대신 &lt;code class=&quot;language-text&quot;&gt;Object#send&lt;/code&gt; 을 사용할 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:my_method&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;똑같이 my_method를 호출하지만 send를 사용해서 호출된다.&lt;/li&gt;
&lt;li&gt;send를 사용하면 호출할 메서드를 결정하기 위해 마지막까지 기다릴 수 있다.&lt;/li&gt;
&lt;li&gt;이를 동적 디스패치라고 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Pry 예시&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Pry는 irb의 좋은 대안 ( command line interpreter )&lt;/li&gt;
&lt;li&gt;Pry 객체는 인터프리터의 설정을 갖고있음 - memory_size나 quite같은&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;pry&quot;&lt;/span&gt;
pry &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Pry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
pry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;memory_size &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;101&lt;/span&gt;
pry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;memory_size
pry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;quiet &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# =&gt; 101&lt;/span&gt;

&lt;span class=&quot;token constant&quot;&gt;Pry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;memory_size &lt;span class=&quot;token comment&quot;&gt;# 각 속성의 기본값을 반환하는 메서드도 있다.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Pry 인스턴스를 설정하려면 &lt;code class=&quot;language-text&quot;&gt;Pry#refresh&lt;/code&gt; 라는 메서드를 호출하면 된다.&lt;/li&gt;
&lt;li&gt;속성 이름을 새 값에 매핑하는 해시를 사용&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;pry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;refresh&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:memory_size&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;99&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:quiet&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
pry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;memory_size       &lt;span class=&quot;token comment&quot;&gt;# =&gt; 99&lt;/span&gt;
pry&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;quiet             &lt;span class=&quot;token comment&quot;&gt;# =&gt; false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;refresh는 할 일이 많음&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;각 속성을 (self.memory_size 등) 검토하고 기본값으로 초기화해야하며&lt;/li&gt;
&lt;li&gt;해시 인수에 동일한 특성에 대한 새 값이 있나 확인 후 있으면 설정&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;refresh&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;options&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  defaults&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:memory_size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Pry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;memory_size
  &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;memory_size &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; options&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:memory_size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; options&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:memory_size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  defaults&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:quiet&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Pry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;quiet
  &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;quiet &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; options&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:quiet&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; options&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:quiet&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# same for all the other attributes...&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이 두 줄은 각 속성마다 반복되어야 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;refresh&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;options&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  defaults   &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  attributes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:input&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:output&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:commands&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:print&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:quiet&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;token symbol&quot;&gt;:exception_handler&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:hooks&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:custom_completions&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;token symbol&quot;&gt;:prompt&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:memory_size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:extra_sticky_locals&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  attributes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;attribute&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    defaults&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;attribute&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Pry&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send attribute
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  defaults&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;merge&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;options&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;key&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;key&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;=&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; respond_to&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;key&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;=&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;send로 기본 값을 읽는다.&lt;/li&gt;
&lt;li&gt;옵션 해시와 merge한다&lt;/li&gt;
&lt;li&gt;memory_size=value 꼴로 call attribute accessor을 사용&lt;/li&gt;
&lt;li&gt;respond&lt;em&gt;to? 는 Pry#memory&lt;/em&gt;size= 이 있으면 true를 반환&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Privacy Matters&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Object#send&lt;/code&gt; 는 private method를 포함하여 모든 메서드를 쓸수 있다.&lt;/li&gt;
&lt;li&gt;이러한 종류의 캡슐화 위반.... 불편하면 &lt;code class=&quot;language-text&quot;&gt;public_send&lt;/code&gt; 를 사용한다.&lt;/li&gt;
&lt;li&gt;하지만 야생의 루비코드는 이러한 우려를 거의 신경쓰지않음....&lt;/li&gt;
&lt;li&gt;오히려 많은 루비 프로그래머들이 send를 private method쓰려고 씀...&lt;/li&gt;
&lt;li&gt;동적 호출 봤고 동적 정의 보자~&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;메서드를 동적으로 정의하기&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:my_method&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;my_arg&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    my_arg &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# =&gt; 6&lt;/span&gt;

require_relative &lt;span class=&quot;token string&quot;&gt;&apos;../test/assertions&apos;&lt;/span&gt;
assert_equals &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Module#define_method&lt;/code&gt; 를 사용, method name 하고 block만 넘기면 된다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Myclass&lt;/code&gt; 내에서 실행 되므로 MyClass의 인스턴스 메서드로 정의됨&lt;/li&gt;
&lt;li&gt;동적 메서드라고 한다&lt;/li&gt;
&lt;li&gt;define_method 키워드를 쓰면 런타임에 정의된 메서드의 이름을 결정 가능&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Computer 클래스 리팩터링&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Computer&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;computer_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data_source&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; computer_id
    &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data_source
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;mouse&lt;/span&gt;&lt;/span&gt;
    info &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_mouse_info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    price &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_mouse_price&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Mouse: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;info&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; ($&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;price&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;)&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;* &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;result&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; price &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
    result
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;cpu&lt;/span&gt;&lt;/span&gt;
    info &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_cpu_info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    price &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_cpu_price&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Cpu: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;info&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; ($&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;price&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;)&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;* &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;result&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; price &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
    result
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;keyboard&lt;/span&gt;&lt;/span&gt;
    info &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_keyboard_info&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    price &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get_keyboard_price&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Keyboard: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;info&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; ($&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;price&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;)&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;* &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;result&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; price &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
    result
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Step 1: 다이나믹 디스패치 추가&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Computer&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;computer_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data_source&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; computer_id
      &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data_source
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;mouse&lt;/span&gt;&lt;/span&gt;
      component &lt;span class=&quot;token symbol&quot;&gt;:mouse&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;cpu&lt;/span&gt;&lt;/span&gt;
      component &lt;span class=&quot;token symbol&quot;&gt;:cpu&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;keyboard&lt;/span&gt;&lt;/span&gt;
      component &lt;span class=&quot;token symbol&quot;&gt;:keyboard&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;component&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      info &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send &lt;span class=&quot;token string&quot;&gt;&quot;get_&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;_info&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;
      price &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send &lt;span class=&quot;token string&quot;&gt;&quot;get_&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;_price&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;
      result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;capitalize&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;info&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; ($&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;price&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;)&quot;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;* &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;result&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; price &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
      result
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;각 메서드를 component 메서드에 위임한다.&lt;/li&gt;
&lt;li&gt;하지만 아직도 중복이 많다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Step 2: 동적 메서드 정의&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Computer&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;computer_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data_source&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; computer_id
    &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data_source
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;define_component&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      info &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send &lt;span class=&quot;token string&quot;&gt;&quot;get_&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;_info&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;
      price &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send &lt;span class=&quot;token string&quot;&gt;&quot;get_&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;_price&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;
      result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;capitalize&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;info&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; ($&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;price&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;)&quot;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;* &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;result&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; price &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
      result
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  define_component &lt;span class=&quot;token symbol&quot;&gt;:mouse&lt;/span&gt;
  define_component &lt;span class=&quot;token symbol&quot;&gt;:cpu&lt;/span&gt;
  define_component &lt;span class=&quot;token symbol&quot;&gt;:keyboard&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;여기서 self는 Computer임&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;define_component&lt;/code&gt;는 클래스 메서드&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Step 3: 인트로스펙션으로 뿌리기&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;최소한의 중복만 있지만 완전히 제거가 가능하다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;define_component&lt;/code&gt; 에 대한 호출을 다 지운다.&lt;/li&gt;
&lt;li&gt;인트로스펙션으로 모든 컴포넌트의 이름을 추출한다..&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Computer&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;computer_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data_source&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; computer_id
    &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data_source
    data_source&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;methods&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;grep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;/^get_(.*)_info$/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Computer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;define_component $&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;define_component&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;define_method&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;#...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;블록을 grep에 &lt;code class=&quot;language-text&quot;&gt;$1&lt;/code&gt; 에 저장 된다.&lt;/li&gt;
&lt;li&gt;중복 코드가 다 사라졌다.&lt;/li&gt;
&lt;li&gt;요소를 추가하거나 유지 관리할 필요가 없으며 DS에 새 컴포넌트를 추가하면 컴퓨터 클래스에서 자동으로 지원한다&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;method_missing&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Ghost Method와 Dynamic Proxies...&lt;/li&gt;
&lt;li&gt;루비에서는 컴파일러가 메서드 정의를 강제하지 않으니 없는 메서드를 호출할 수도있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Lawyer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
nick &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Lawyer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
nick&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;talk_simple
❮ &lt;span class=&quot;token constant&quot;&gt;NoMethodError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; undefined method `talk_simple&apos; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#&amp;lt;Lawyer:0x007f801aa81938&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;메서드 조회가 어떤식으로 진행되는지 기억하나?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;nick의 클래스로 들어가 인스턴스 메서드를 탐색&lt;/li&gt;
&lt;li&gt;Object로 이동한다음 ... BasicObject로 이동...&lt;/li&gt;
&lt;li&gt;method_missing..&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;nick&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send &lt;span class=&quot;token symbol&quot;&gt;:method_missing&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:my_method&lt;/span&gt;
❮ &lt;span class=&quot;token constant&quot;&gt;NoMethodError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; undefined method `my_method&apos; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#&amp;lt;Lawyer:0x007f801b0f4978&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Overriding method_missing&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;unknown messages를 인터셉트하여 override가 가능하다&lt;/li&gt;
&lt;li&gt;각 메시지는 &lt;code class=&quot;language-text&quot;&gt;method_missing&lt;/code&gt; 에서 함수 이름과 매개변수 그리고 호출시 불러진 블록을 포함한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Lawyer&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;method_missing&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      puts &lt;span class=&quot;token string&quot;&gt;&quot;You called: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;method&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;(&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;join&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;, &apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;)&quot;&lt;/span&gt;
      puts &lt;span class=&quot;token string&quot;&gt;&quot;(You also passed it a block)&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; block_given&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  bob &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Lawyer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
  bob&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;talk_simple&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;b&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# a block&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
❮ &lt;span class=&quot;token constant&quot;&gt;You&lt;/span&gt; called&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; talk_simple&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;You&lt;/span&gt; also passed it a block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;고스트 메서드&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;유사한 메서드를 많이 정의해야 할 경우 method_missing을 통해 직접 정의를 내리고 호출에 응답할 수 있다.&lt;/li&gt;
&lt;li&gt;만약 뭔가를 물었는데 이해 못하면 이렇게 하세요 라고 하는 것과 같다.&lt;/li&gt;
&lt;li&gt;호출자 쪽에선 method_missing에 의해 처리되는 일반 호출처럼 보인다.&lt;/li&gt;
&lt;li&gt;수신자에선 이에 상응하는 메서드가 없다..&lt;/li&gt;
&lt;li&gt;이를 고스트메서드라고 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;The Hashie Example&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Hashie Gem.... Hashie::Mash ..&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Mash는 루비의 더 강력한 버전의 OpenStruct class&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;루비의 변수처럼 동작하는 hash같은 객체&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;만약 새 속성이 필요하면 지정만 하면 사용이 가능함&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;hashie&apos;&lt;/span&gt;
icecream &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Hashie&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Mash&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
icecream&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;flavor &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;strawberry&quot;&lt;/span&gt;
icecream&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;flavor                 &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;strawberry&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Hashie&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Mash&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Hashie&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;Hash&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;method_missing&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;blk&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;blk&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; key&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      match &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; method_name&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_s&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;match&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;/(.*?)([?=!]?)$/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; match&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;=&quot;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;match&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; args&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;first
      &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
        default&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method_name&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;blk&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;method이름이 =으로 끝나면 method_missing은 속성의 값을 갖고오기 위해 &apos;=&apos; 을 잘라낸 다음 값을 저장.&lt;/li&gt;
&lt;li&gt;호출된 메서드의 이름이 일치하지 않으면 기본값만 반환한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;다이나믹 프록시&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;고스트 메서드는 좋긴 한데 어떤 객체들은 거의 전적으로 의존함&lt;/li&gt;
&lt;li&gt;이런 객체들은 다른 언어로 작성된 객체, 웹서비스 의 래퍼이기도 함&lt;/li&gt;
&lt;li&gt;메서드 호출을 method_missing을 통해 수집하여 래핑된 객체에 전달한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h5&gt;The Ghee Example&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;Ghee를 통해 gist에 접근하는 방법&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ghee&quot;&lt;/span&gt;
gh &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Ghee&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;basic_auth&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;usr&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;pwd&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# Your GitHub username and password&lt;/span&gt;
all_gists &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; gh&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;users&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;nusco&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;gists
a_gist &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; all_gists&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

a_gist&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;url            &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;https://api.github.com/gists/535077&quot;&lt;/span&gt;
a_gist&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;description    &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;Spell: Dynamic Proxy&quot;&lt;/span&gt;

a_gist&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;star&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;nusco의 gist를 찾아 측정 gist를 선택&lt;/li&gt;
&lt;li&gt;url, desc를 찍고 star를 남김&lt;/li&gt;
&lt;li&gt;github의 api는 gist 외에도 수십 가지 유형의 객체를 노출한다.&lt;/li&gt;
&lt;li&gt;ghee는 이 모든 객체를 지원해야한다&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Ghee&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ResourceProxy&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;method_missing&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      subject&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;message&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt;args&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;block&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;subject&lt;/span&gt;&lt;/span&gt;
      &lt;span class=&quot;token variable&quot;&gt;@subject&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; connection&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;path_prefix&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;req&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; req&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;merge&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;params &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;body
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;먼저 어떻게 사용하는지를 알아야함&lt;/li&gt;
&lt;li&gt;github의 각 유형에 Ghee는 하위 클래스를 정의한다. ( &lt;code class=&quot;language-text&quot;&gt;Ghee::ResourceProxy&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Ghee&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;API&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Gists&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Proxy&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Ghee&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;ResourceProxy&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;star&lt;/span&gt;&lt;/span&gt;
          connection&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;put&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;path_prefix&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;/star&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;status &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;204&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;만약 객체의 상태를 변경하는 메서드를 호출할 때 ( star처럼 ) Ghee는 해당 github url http 호출을 한다.&lt;/li&gt;
&lt;li&gt;하지만 url이나 desc같이 속성에서 읽기만 하는 호출은 &lt;code class=&quot;language-text&quot;&gt;Ghee::ResourceProxy#method_missing&lt;/code&gt;에서 끝난다.&lt;/li&gt;
&lt;li&gt;missing_method는 메시지를 subject에게 포워드한다.&lt;/li&gt;
&lt;li&gt;subject의 구현을 자세히 보면 이 메서드가 github api http 호출을 한다.&lt;/li&gt;
&lt;li&gt;JSON형식의 github 객체를 받아서 해시 같은 객체로 변환함&lt;/li&gt;
&lt;li&gt;그럼 다시 method_missing에서 url attribute를 반환함&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;음 우아하지만 메타프로그래밍이 너무 많이 들어가 있어서 헷갈린다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Ghee는 github 객체를 동적 해시로 저장한다. 액세스 할 수있다.&lt;/li&gt;
&lt;li&gt;Ghost Method를 호출하여 이러한 해시 특성을 확인할 수 있다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Ghee는 또한 이러한 해시를 프록시 객체 안에 래핑하여 추가적인 메소드를 통해 더욱 풍부하게 한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;프록시는 특정 코드가 필요한 메소드를 구현 ( star 처럼 )&lt;/li&gt;
&lt;li&gt;url과 같이 데이터만 읽는 메서드를 래핑된 해시에 전달&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;이러한 2단계 디자인 덕에 코드를 매우 압축적으로 유지한다.&lt;/p&gt;
&lt;p&gt;github api 의 변화에 자동 적응&lt;/p&gt;
&lt;h4&gt;Refactoring the Computer Class (Again)&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Computer&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt;  &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;computer_id&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data_source&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; computer_id
    &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; data_source
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;method_missing&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;respond_to&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;get_&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;_info&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    info &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;get_&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;_info&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    price &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;send&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;get_&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;_price&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;capitalize&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;: &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;info&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; ($&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;price&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;)&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;* &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;result&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; price &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
    result
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;respond&lt;em&gt;to&lt;/em&gt;missing?&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;만약 컴퓨터에 respond_to? 를 사용하면 ..&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;cmp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Computer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;DS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
cmp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;respond_to&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:mouse&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;       &lt;span class=&quot;token comment&quot;&gt;# =&gt; false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;문제가 될 수 있음&lt;/li&gt;
&lt;li&gt;다행히 이를 위한 메커니즘&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Computer&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;respond_to_missing&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;method&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; include_private &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@data_source&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;respond_to&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;get_&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;method&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;_info&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;const_missing&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Rake에서 충돌 가능성이 높은 클래스 이름을 모듈로 변경했다는 것..&lt;/li&gt;
&lt;li&gt;이름 변경 후 이전 버전, 현재 버전 몽키패치&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Module&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;const_missing&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;const_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; const_name
      &lt;span class=&quot;token keyword&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:Task&lt;/span&gt;
        &lt;span class=&quot;token constant&quot;&gt;Rake&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;application&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;const_warning&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;const_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token constant&quot;&gt;Rake&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Task&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:FileTask&lt;/span&gt;
        &lt;span class=&quot;token constant&quot;&gt;Rake&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;application&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;const_warning&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;const_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token constant&quot;&gt;Rake&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;FileTask&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:FileCreationTask&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;존재하지 않는 상수를 참조할 때 루비는 상수의 이름을 심볼로 전달&lt;/li&gt;
&lt;li&gt;클래스 이름은 상수이므로 ...&lt;/li&gt;
&lt;li&gt;더이상 사용되지 않는 클래스 이름을 사용중임을 경고&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;rake&apos;&lt;/span&gt;
  task_class &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Task&lt;/span&gt;
❮ &lt;span class=&quot;token constant&quot;&gt;WARNING&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Deprecated&lt;/span&gt; reference to top&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;level constant &lt;span class=&quot;token string&quot;&gt;&apos;Task&apos;&lt;/span&gt; found &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Use&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;classic&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;namespace on rake command
&lt;span class=&quot;token keyword&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;require &quot;rake/classic_namespace&quot;&apos;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Rakefile&lt;/span&gt;

task_class &lt;span class=&quot;token comment&quot;&gt;# =&gt; Rake::Task&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;리팩터링 마무리&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;두 가지 다른 방법으로 풀었다.&lt;/li&gt;
&lt;li&gt;동적 메서드와 동적 디스패치를 사용&lt;/li&gt;
&lt;li&gt;고스트 메서드를 사용&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;빈 슬레이트&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;디스플레이가 작동하지 않는다..&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;my_computer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Computer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;DS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;
my_computer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;display &lt;span class=&quot;token comment&quot;&gt;# =&gt; 0&lt;/span&gt;
&lt;span class=&quot;token builtin&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_method&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;grep &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt;d&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#=&gt; [:dup, display, ...]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이미 있으므로 metho_missing에 도달하지 않는다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;BasicObject&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;베이직오브젝트는 소수의 인스턴스 메서드만 있음&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;im &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;BasicObject&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_methods
im &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:==, :equal?, :!, :!=, :instance_eval, :instance_exec, :__send__, :__id__]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;슈퍼 클래스를 지정하지 않으면 Object에서 상속되며&lt;/li&gt;
&lt;li&gt;빈 슬레이트를 원하면 대신 BasicObject에서 직접 상속할 수 있다.&lt;/li&gt;
&lt;li&gt;하지만 특정 메서드를 제거하는게 더 빠를때도&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Removing Methods&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Module#undef_method&lt;/code&gt; 혹은 &lt;code class=&quot;language-text&quot;&gt;Module#remove_method&lt;/code&gt; 를 사용하여 클래스에서 메서드를 제거할 수 있음&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;undef_method&lt;/code&gt; 는 상속된 메서드를 모함한 모든 메서드를 제거함&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;The Builder Example&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Builder gem은 XML 제너레이터&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;builder&apos;&lt;/span&gt;
  xml &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Builder&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;XmlMarkup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:target&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;STDOUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:indent&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  xml&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;coder &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    xml&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token string&quot;&gt;&apos;Matsumoto&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:nickname&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Matz&apos;&lt;/span&gt;
    xml&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;language &lt;span class=&quot;token string&quot;&gt;&apos;Ruby&apos;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#This code produces the following snippet of XML:&lt;/span&gt;
❮ &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;coder&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;name nickname&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Matz&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Matsumoto&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;name&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;language&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Ruby&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;language&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;coder&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;빌더는 중첩된 태그, 속성 등을 지원하기위해 ...&lt;/li&gt;
&lt;li&gt;핵심 아이디어는 이름과 언어와 같은 호출은 모든 호출에 대해 XML태그를 생성하는 &lt;code class=&quot;language-text&quot;&gt;XmlMarkup#method_missing&lt;/code&gt; 에 의해 처리됨&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;xml&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;semester &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  xml&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Egyptology&apos;&lt;/span&gt;
  xml&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Ornithology&apos;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
❮ &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;semester&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Egyptology&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Ornithology&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;semester&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;XmlMarkup이 Object의 하위 클래스인 경우 충돌하지만 메서드를 제거하는 Blank Slate를 상속함&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BlankSlate&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# Hide the method named +name+ in the BlankSlate class.  Don&apos;t&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;# hide +instance_eval+ or any method beginning with &quot;__&quot;.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;hide&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; instance_methods&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;name&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;_blankslate_as_name&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;
          name &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;~&lt;/span&gt; &lt;span class=&quot;token regex&quot;&gt;/^(__|instance_eval$)/&lt;/span&gt;
        undef_method name
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
    instance_methods&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;m&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; hide&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;모든 메서드를 다 제거하진 않는다? instance_eval하고 루비에 의해 예약 메소드를 보관 - send&lt;/li&gt;
&lt;li&gt;제거는 가능하지만 제거 안함&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Computer Class 고치기&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Computer&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;BasicObject&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;BasicObject에는 &lt;code class=&quot;language-text&quot;&gt;response_to?&lt;/code&gt; 가 없음&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;response_to_missing&lt;/code&gt; 다시 제거&lt;/p&gt;
&lt;h2&gt;마무리&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;동적 메서드 및 독적 디스패치로 리팩토링 하였고&lt;/li&gt;
&lt;li&gt;고스트 메서드로도 수정함,&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;고스트 메서드는 위험할 수 있음&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;super를 항상 호출 하고, response&lt;em&gt;to&lt;/em&gt;missing 재정의 를 하면 방지&lt;/li&gt;
&lt;li&gt;가끔 버그를 일으킬 수 있음&lt;/li&gt;
&lt;li&gt;메서드목록에서 반환 안됨&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;하지만 고스트 메서드가 유일한 실행 가능한 선택일수도..&lt;/li&gt;
&lt;li&gt;메서드가 많거나 런타임에 필요한 메서드 호출을 모를때&lt;/li&gt;
&lt;li&gt;Builder - XML 예제처럼&lt;/li&gt;
&lt;li&gt;스타일에 따라 다르긴 하겠지만 의심스러우면 동적 방법, 필요하면 고스트&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[M Ruby - 2. The Object Model]]></title><description><![CDATA[이제 시작이지만 재밌다. The Object Model 클래스, 모듈, 인스턴스 변수 등과 같은 언어의 구성 요소들은 Object Model이라는 시스템 모델에서 살아간다. Object Model…]]></description><link>https://blog.seongjun.kr/metaprogramming-ruby-2/</link><guid isPermaLink="false">https://blog.seongjun.kr/metaprogramming-ruby-2/</guid><pubDate>Thu, 08 Apr 2021 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;이제 시작이지만 재밌다.&lt;/p&gt;
&lt;h1&gt;The Object Model&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;클래스, 모듈, 인스턴스 변수 등과 같은 언어의 구성 요소들은 Object Model이라는 시스템 모델에서 살아간다.&lt;/li&gt;
&lt;li&gt;Object Model에서 우린 &quot;이 메서드는 어떤 클래스의 것 인가요?&quot; 혹은 &quot;이 모듈을 포함하면 어떻게 되나요?&quot; 같은 답을 찾을 수 있다.&lt;/li&gt;
&lt;li&gt;루비의 &lt;strong&gt;핵심&lt;/strong&gt;인 Object Model !&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;오픈 클래스 - Open Classes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;특수문자 및 숫자를 제거하는 메서드와 그의 테스트 코드를 생각해 보자.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;test/unit&lt;/code&gt; 은 &lt;code class=&quot;language-text&quot;&gt;gem install test-unit&lt;/code&gt; 이나 &lt;code class=&quot;language-text&quot;&gt;bundle add test-unit&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;test/unit&apos;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;to_alphanumeric&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  s&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;gsub&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;/[^\w\s]/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ToAlphanumericTest&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Unit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;TestCase&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test_strip_non_alphanumeric&lt;/span&gt;&lt;/span&gt;
    assert_equal &lt;span class=&quot;token string&quot;&gt;&apos;qwer asdf 1234&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; to_alphanumeric&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;qwer !@#a.sdf 1@@23#4&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;to_alphanumeric&lt;/code&gt; 은 객체 지향적이지 않다.&lt;/li&gt;
&lt;li&gt;외부 메서드를 사용하는 것 보다 문자열이 직접 바꿀 수 있다면 더 좋을 것이다.&lt;/li&gt;
&lt;li&gt;하지만 그냥 일반적인 문자열인데... 메서드를 추가하려면 &lt;code class=&quot;language-text&quot;&gt;AlphanumericString&lt;/code&gt; 이런식의 클래스를 새로 작성???&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;간단한 해결책&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;test/unit&apos;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;to_alphanumeric&lt;/span&gt;&lt;/span&gt;
    gsub&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;/[^\w\s]/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;StringExtensionsTest&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Unit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;TestCase&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test_strip_non_alphanumeric&lt;/span&gt;&lt;/span&gt;
    assert_equal &lt;span class=&quot;token string&quot;&gt;&apos;qwer asdf 1234&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;qwer !@#a.sdf 1@@23#4&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_alphanumeric
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Inside Class Definitions&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;루비에서는 클래스를 정의하는 코드와 다른 종류의 코드가 차이가 없다.&lt;/li&gt;
&lt;li&gt;클래스 정의에 아무 코드나 넣을 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# hello.rb&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;3.&lt;/span&gt;times &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Hello&lt;/span&gt;
      puts &lt;span class=&quot;token string&quot;&gt;&quot;Hello&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sh&quot;&gt;&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;ruby hello.rb
Hello
Hello
Hello&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;다른 코드처럼 클래스 내에서 코드가 실행 되었다!&lt;/li&gt;
&lt;li&gt;그럼 위의 코드는 같은 이름으로 서로 다른 세 개의 클래스를 정의한 것일까?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Hello&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;a&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;a&apos;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Hello&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;b&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;b&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

hello &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Hello&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
hello&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;a &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;a&quot;&lt;/span&gt;
hello&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;b &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;b&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;처음 &lt;code class=&quot;language-text&quot;&gt;Hello&lt;/code&gt; 를 정의할 때는 &lt;code class=&quot;language-text&quot;&gt;Hello&lt;/code&gt; 라는 이름의 클래스가 존재하지 않는다.&lt;/li&gt;
&lt;li&gt;따라서 루비는 클래스와 메서드 &lt;code class=&quot;language-text&quot;&gt;a&lt;/code&gt; 를 정의한다.&lt;/li&gt;
&lt;li&gt;두 번째 에서는 클래스 &lt;code class=&quot;language-text&quot;&gt;Hello&lt;/code&gt; 는 이미 존재하기 때문에 정의할 필요가 없다.&lt;/li&gt;
&lt;li&gt;기존 클래스를 열고 y라는 메서드를 정의한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;루비의 클래스 키워드는 클래스를 선언하는 것 보다는 스코프 연산자에 가깝다.&lt;/p&gt;
&lt;p&gt;메서드를 정의할 수 있는 곳이 클래스의 컨텍스트에서 사용자로 이동&lt;/p&gt;
&lt;p&gt;기존 클래스를 언제든지 다시 열고 표준 라이브러리 클래스도 즉시 수정할 수 있다.&lt;/p&gt;
&lt;p&gt;이를 &lt;strong&gt;오픈 클래스&lt;/strong&gt;라고 부른다.&lt;/p&gt;
&lt;p&gt;다른 예시를 한번 보자!&lt;/p&gt;
&lt;h4&gt;The Money Example&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;통화 관련 유틸리티 라이브러리인 &lt;a href=&quot;https://github.com/RubyMoney/monetize&quot;&gt;&lt;strong&gt;Monetize&lt;/strong&gt;&lt;/a&gt; Gem에서 오픈 클래스의 예를 찾을 수 있다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;bundle add monetize&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;monetize&quot;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#I18n.config.available_locales = :en&lt;/span&gt;

price &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Monetize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;from_numeric&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;USD&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
price&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;format &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;$10.00&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이를 &lt;code class=&quot;language-text&quot;&gt;Numeric#to_money&lt;/code&gt; 을 통해서 숫자를 Money 로 만들 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;monetize&quot;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;#I18n.config.available_locales = :en&lt;/span&gt;

price &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10.&lt;/span&gt;to_money
price&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;format&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Numeric은 Ruby의 스탠다드 클래스이다. &lt;code class=&quot;language-text&quot;&gt;Numeric#to_money&lt;/code&gt; 는 어디서 온 걸까?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/RubyMoney/monetize/blob/main/lib/monetize/core_extensions/numeric.rb&quot;&gt;lib/monetize/core_extensions/numeric.rb&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Numeric&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;to_money&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;currency &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token constant&quot;&gt;Monetize&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;from_numeric&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; currency &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Money&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;default_currency&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;라이브러리에서 Open Class를 이런 방식으로 사용하는 것은 매우 일반적이다!&lt;/li&gt;
&lt;li&gt;하지만 나쁜 케이스도 있다...&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;The Problem with Open Classes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;배열의 요소를 바꾸는 메서드를 생각해보자&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;test/unit&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;replace&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;array&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; original&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; replacement&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  array&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;map &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;e&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; e &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; original &lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; replacement &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; e &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# ...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;test_replace&lt;/span&gt;&lt;/span&gt;
    original &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;one&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;two&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;one&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;three&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    replaced &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; replace&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;original&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;one&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;zero&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    assert_equal &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;zero&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;two&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;zero&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;three&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; replaced
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;메서드의 내부 동작보다 유닛 테스트를 통해 어떻게 사용되는지 확인이 가능하다.&lt;/li&gt;
&lt;li&gt;이번에도 &lt;code class=&quot;language-text&quot;&gt;replace&lt;/code&gt;라는 메서드를 Array 클래스에 새로 추가해도 되겠지?&lt;/li&gt;
&lt;li&gt;하지만... &lt;code class=&quot;language-text&quot;&gt;irb&lt;/code&gt; 를 실행하고 Array의 기본 메서드 목록을 받아보면&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sh&quot;&gt;&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;&amp;gt; irb
irb(main):001:0&amp;gt; [].methods.grep /^replace/
=&amp;gt; [:replace]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이미 &lt;code class=&quot;language-text&quot;&gt;Array&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;replace&lt;/code&gt; 라는 메서드를 갖고있다.&lt;/li&gt;
&lt;li&gt;이를 overwrite해버리면 다른 코드에서 문제가 발생할 수 있다.&lt;/li&gt;
&lt;li&gt;이게 바로 &lt;strong&gt;Open Classes의 어두운 면이다&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;이런식으로 클래스를 무모하게 Patching -&gt; MonkeyPatch 라고 불린다..&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Inside the Object Model&lt;/h2&gt;
&lt;p&gt;루비의 클래스, 그리고 object model에 대한 몇몇 진실은 꽤 충격적!&lt;/p&gt;
&lt;p&gt;일단 기본부터 시작해보자.&lt;/p&gt;
&lt;h3&gt;What&apos;s in an Object&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@val&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#=&gt; Myclass&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Instance Variables&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;객체에는 인스턴스 변수가 포함되어있다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Object#instance_variables&lt;/code&gt; 로 확인이 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_variables&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;자바나 다른 정적 언어와 달리 루비에서는 클래스와 인스턴스 변수 사이의 연결이 없다.&lt;/li&gt;
&lt;li&gt;만약 &lt;code class=&quot;language-text&quot;&gt;obj.my_method&lt;/code&gt; 를 호출하지 않았다면 &lt;code class=&quot;language-text&quot;&gt;obj&lt;/code&gt; 는 인스턴스 변수가 없었을 것이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Methods&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Object#methods&lt;/code&gt; 를 통해 메서드의 리스트를 얻을 수 있다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;obj.methods&lt;/code&gt; 를 하면 &lt;code class=&quot;language-text&quot;&gt;Object&lt;/code&gt; 로부터 많은 메서드를 상속하므로 꽤나 길다!&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Array#grep&lt;/code&gt; 으로 필터링해서 봐보면&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;methods&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;grep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;/my/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;#=&gt; [:my_methods]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;pry&lt;/code&gt; 를 열고 &lt;code class=&quot;language-text&quot;&gt;obj&lt;/code&gt; 을 보면 실제로 메서드 목록을 갖고있지 않다는 것을 알 수 있다.&lt;/li&gt;
&lt;li&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 675px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/66be913c61135307b8cd409884a66604/a0bb6/2021-04-08-08-25-03.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 14.705882352941178%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAgklEQVQI133OyQrCMBgE4D5HtoOJ+ZugxC2JkGqRFoTeevD9H2XUHERwOXynYYZpYsoYxhH9ZUApBTlFaL2AlBJKqa+e2a+8WcYr6HRDW2bscoeUjyBqwRiDeJSEEC+c8+p9+GPQpAlmc4b2e6wPHWi1hbEE7x2stZVzrgohVP8e3gES8VY/iZsXfAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2021 04 08 08 25 03&apos; title=&apos;2021 04 08 08 25 03&apos; src=&apos;/static/66be913c61135307b8cd409884a66604/a0bb6/2021-04-08-08-25-03.png&apos; srcset=&apos;/static/66be913c61135307b8cd409884a66604/e7570/2021-04-08-08-25-03.png 170w,
/static/66be913c61135307b8cd409884a66604/f46e7/2021-04-08-08-25-03.png 340w,
/static/66be913c61135307b8cd409884a66604/a0bb6/2021-04-08-08-25-03.png 675w&apos; sizes=&apos;(max-width: 675px) 100vw, 675px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/li&gt;
&lt;li&gt;객체는 해당 인스턴스 변수와 클래스에 대한 참조만 있다.&lt;/li&gt;
&lt;li&gt;동일한 클래스를 공유하는 객체도 동일한 메서드를 공유하므로 메서드는 객체가 아닌 클래스에 저장되어야 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/ecbc1ecacbf79bdaee7f1b82c54d1f66/cc0d8/2021-04-08-09-25-03.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 40%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABNklEQVQoz1VRW5KDMAzj/jfs7EB55QUhECjp/mnlpHTbD2ESx7JkV89kIEinwUnsu8ayjgibynE/NFIquTWqdy5sIx6Pci/xQqUXi8Fb+M3g4IUPI+ZlwERI8RwGBEZpaOcerbqj0y3M1ONgs2Vj/WzROIeZ/5UJ5WAZp9WSoKiwfsjqhLgeG6ipy/eRDkTVFvkmmEwSD6rfi6AqnRq/ibZOnVWIOkMlnsocSUVxIVDQJBVl1vfoTVvIxfZDmuhiWT7HC1IoKprxjobWMuFaZvVMNhPWQ4NbV+PW1qwphF8z/DxIMvGR2HaLQqQt6Z5eg993qvSKTTTHob6I3oR5S9eGOQu1OPSzw+gdl+XwY0vM6qPNOYHn7K5G5/kPKhTvBQcJQ2ThVnD9r9G88ppzK2dZxGfthT9IK1oyUlTrsQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2021 04 08 09 25 03&apos; title=&apos;2021 04 08 09 25 03&apos; src=&apos;/static/ecbc1ecacbf79bdaee7f1b82c54d1f66/ca1dc/2021-04-08-09-25-03.png&apos; srcset=&apos;/static/ecbc1ecacbf79bdaee7f1b82c54d1f66/e7570/2021-04-08-09-25-03.png 170w,
/static/ecbc1ecacbf79bdaee7f1b82c54d1f66/f46e7/2021-04-08-09-25-03.png 340w,
/static/ecbc1ecacbf79bdaee7f1b82c54d1f66/ca1dc/2021-04-08-09-25-03.png 680w,
/static/ecbc1ecacbf79bdaee7f1b82c54d1f66/02d09/2021-04-08-09-25-03.png 1020w,
/static/ecbc1ecacbf79bdaee7f1b82c54d1f66/9d567/2021-04-08-09-25-03.png 1360w,
/static/ecbc1ecacbf79bdaee7f1b82c54d1f66/cc0d8/2021-04-08-09-25-03.png 1647w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;obj 는 my_methods를 갖고있다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;MyClass&lt;/code&gt; 에는 my_method라는 이름의 메서드가 있다 라고 하면 안된다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;MyClass.my_method&lt;/code&gt; 를 클래스 메서드처럼 호출할 수 있다는 의미&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;모호함을 없애기 위해 my_method가 MyClass의 인스턴스 메서드라고 해야한다.&lt;/li&gt;
&lt;li&gt;이 설명을 기억한다면 다음과 같은 introspective code를 작성할 때 혼동하지 않을 것이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_methods &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;methods    &lt;span class=&quot;token comment&quot;&gt;# =&gt; true&lt;/span&gt;
&lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;methods &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;methods             &lt;span class=&quot;token comment&quot;&gt;# =&gt; false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;자 정리해보자, &lt;strong&gt;객체&lt;/strong&gt;의 &lt;strong&gt;인스턴스 변수는 객체&lt;/strong&gt;에 존재하고 객체의 &lt;strong&gt;메서드는 클래스&lt;/strong&gt;에 존재한다. 따라서 같은 클래스의 객체는 메서드는 공유하지만 인스턴스 변수는 공유하지 않는다.&lt;/p&gt;
&lt;h3&gt;Thre Truth About Classes&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;클래스는 오브젝트에 불과하다.&lt;/li&gt;
&lt;li&gt;클래스는 객체이므로 다른 객체에 적용되는 것들이 클래스에도 적용이 된다.&lt;/li&gt;
&lt;li&gt;클래스는 다른 객체와 마찬가지로 클래스라는 자체 클래스가 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# =&gt; String&lt;/span&gt;
&lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;# =&gt; Class&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;다른 객체를 조작하는 것 처럼 조작이 가능하다!&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/metaprogramming-ruby-5&quot;&gt;Chapter 5&lt;/a&gt; 에서 처럼 &lt;code class=&quot;language-text&quot;&gt;Class.new&lt;/code&gt; 를 호출하여 프로그램이 실행되는 동안 새 클래스를 만들 수 있다.&lt;/li&gt;
&lt;li&gt;이런 유연성이 루비의 메타프로그래밍의 전형적인 특징&lt;/li&gt;
&lt;li&gt;클래스의 메서드는 클래스의 인스턴스 메서드!&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token builtin&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_methods&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:allocate, :new, :superclass]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;new&lt;/code&gt;는 항상 객체를 생성할 때 사용하니까 다들 알죠?&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;superclass&lt;/code&gt; 는 상속과 관련있다. 루비의 클래스는 그 슈퍼클래스에서 상속된다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token builtin&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;superclass        &lt;span class=&quot;token comment&quot;&gt;# =&gt; Object&lt;/span&gt;
&lt;span class=&quot;token builtin&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;superclass       &lt;span class=&quot;token comment&quot;&gt;# =&gt; BasicObject&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;BasicObject&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;superclass  &lt;span class=&quot;token comment&quot;&gt;# =&gt; nil&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Array&lt;/code&gt;는 &lt;code class=&quot;language-text&quot;&gt;Object&lt;/code&gt; 를 상속받고 &lt;code class=&quot;language-text&quot;&gt;Object&lt;/code&gt; 에는 &lt;code class=&quot;language-text&quot;&gt;to_s&lt;/code&gt; 같은 객체에 일반적으로 유용한 메서드를 포함한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Object&lt;/code&gt; 는 &lt;code class=&quot;language-text&quot;&gt;BasicObject&lt;/code&gt; 에서 상속된다. 여기엔 몇가지 필수 메서드만 포함&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Class&lt;/code&gt; 의 슈퍼클래스는 무엇일까?&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Modules&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token builtin&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;superclass        &lt;span class=&quot;token comment&quot;&gt;# =&gt; Module&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;클래스의 슈퍼클래스는 모듈이다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;클래스는 객체를 만들거나 클래스를 계층 구조로 정렬할 수 있는 세 가지 인스턴스 메서드가 추가로 포함된 모듈이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;new, allocate, superclass&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;모듈은 보통 어딘가에 포함되려고,&lt;/li&gt;
&lt;li&gt;클래스는 인스턴스화 되거나 상속되려면 클래스&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Constants&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;클래스 및 모듈의 이름을 포함하여 대문자로 시작하는 모든 참조는 상수이다.&lt;/li&gt;
&lt;li&gt;경고를 받긴 하겠지만 상수의 값을 변경할 수 있다.&lt;/li&gt;
&lt;li&gt;그럼 변수랑 상수가 뭐가 다른가? - 스코프가 다르다. 상수의 스코프는 고유한 특수 규칙이 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyModule&lt;/span&gt;
  &lt;span class=&quot;token constant&quot;&gt;MyConstant&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Outer constant&apos;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
    &lt;span class=&quot;token constant&quot;&gt;MyConstant&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Inner constant&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/7e27c1dc5d362721b95ae8f757a71196/a044f/2021-04-08-10-11-34.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 53.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAlElEQVQoz72RuwoEIQxFx3EUH4ggCrvCymBlIVgKVv7/V21w2oHZNHuKgI/k3iTbdgchZPs3x3EYY5xzjDE47vuOcAFpKaVa63uRc1ZKwT3n/KHK9WytDSGAMsTX4rOglD6LCyG89yB7nmeMEWqRxa/modXLQmsNnXx9BatjjN77nLOUgl6hlBK6gJlprXFrw7nF8gXjzgqf1I9YkwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;2021 04 08 10 11 34&apos; title=&apos;2021 04 08 10 11 34&apos; src=&apos;/static/7e27c1dc5d362721b95ae8f757a71196/ca1dc/2021-04-08-10-11-34.png&apos; srcset=&apos;/static/7e27c1dc5d362721b95ae8f757a71196/e7570/2021-04-08-10-11-34.png 170w,
/static/7e27c1dc5d362721b95ae8f757a71196/f46e7/2021-04-08-10-11-34.png 340w,
/static/7e27c1dc5d362721b95ae8f757a71196/ca1dc/2021-04-08-10-11-34.png 680w,
/static/7e27c1dc5d362721b95ae8f757a71196/02d09/2021-04-08-10-11-34.png 1020w,
/static/7e27c1dc5d362721b95ae8f757a71196/9d567/2021-04-08-10-11-34.png 1360w,
/static/7e27c1dc5d362721b95ae8f757a71196/a044f/2021-04-08-10-11-34.png 2527w&apos; sizes=&apos;(max-width: 680px) 100vw, 680px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;모든 상수는 파일 시스템과 유사한 트리에 배열되어 있다&lt;/li&gt;
&lt;li&gt;모듈, 클래스는 디렉터리이고 상수는 파일임&lt;/li&gt;
&lt;li&gt;동일한 이름을 가진 여러 파일을 가질 수 있다&lt;/li&gt;
&lt;li&gt;파일 처럼 상수를 경로로 나타낼 수도 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;The Paths of Constants&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token constant&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;a root-level constant&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;C&lt;/span&gt;
    &lt;span class=&quot;token constant&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;a constant&apos;&lt;/span&gt;
    p &lt;span class=&quot;token constant&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;a constant&quot;&lt;/span&gt;
    p &lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;X&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;a root-level constant&quot;&lt;/span&gt;
    p &lt;span class=&quot;token builtin&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;nesting
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token constant&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;a constant&quot;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;a constant&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;모듈 클래스도 인스턴스 메서드 클래스 메서드를 제공하고 이 둘을 constants라고 부른다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Modules#constants&lt;/code&gt; 는 현재 스코프의 모든 상수를 반환한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Module.constants&lt;/code&gt;는 최상위 상수들을 반환한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token constant&quot;&gt;M&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;constants                        &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:C]&lt;/span&gt;
&lt;span class=&quot;token builtin&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;constants&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:Object&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# =&gt; true&lt;/span&gt;
&lt;span class=&quot;token builtin&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;constants&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:Module&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# =&gt; true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Module.nesting&lt;/code&gt; 으로는 current path를 얻을 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;루비의 상수와 파일 간의 유사성은 더 나아가 파일을 정리할 때 디렉토리를 사용하는 것과 마찬가지로 모듈을 사용하여 상수를 구성할 수 있다.&lt;/p&gt;
&lt;h4&gt;The Rake Example&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;루비의 빌드 시스템 &lt;code class=&quot;language-text&quot;&gt;Rake&lt;/code&gt; 의 초기 버전은 &lt;code class=&quot;language-text&quot;&gt;Task&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;FileTask&lt;/code&gt; 와 같이 명확한 이름의 클래스를 정의했다.&lt;/li&gt;
&lt;li&gt;다른 라이브러리들과 충돌 할 가능성이 높았다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Rake&lt;/code&gt;내의 모듈에서 다음처럼 클래스를 정의하는 것으로 전환하였다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/ruby/rake/blob/master/lib/rake/task.rb&quot;&gt;lib/rake/task.rb&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#...&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Rake&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;#...&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Task&lt;/span&gt;
     &lt;span class=&quot;token comment&quot;&gt;#..&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이제 Task의 이름은 &lt;code class=&quot;language-text&quot;&gt;Rake::Task&lt;/code&gt; 이고 이제 다른 라이브러리와 충돌하지 않을 것이다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Rake&lt;/code&gt; 같은 모듈 중 상수의 구성 요소로만 존재하는 모듈을 &lt;strong&gt;네임스페이스&lt;/strong&gt;라고 한다.&lt;/li&gt;
&lt;li&gt;이전 버전에 대한 대응&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token constant&quot;&gt;Task&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Rake&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Task&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;FileTask&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Rake&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;FileTask&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;FileCreationTask&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Rake&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;FileCreationTask&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;위 처럼 대응하고 사용자가 모두 마이그레이션 했다고 생각 되었을 때 옵션을 나중에 제거&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Objects and Classes Wrap-Up&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;객체란 무엇인가? - 인스턴스 변수와 클래스에 대한 링크이다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;클래스란 무엇인가? - 객체와 인스턴스 메소드 목록 및 슈퍼클래스에 대한 링크이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클래스는 모듈의 하위클래스이므로 클래스도 모듈이다.&lt;/li&gt;
&lt;li&gt;다른 객체들과 마찬가지로 클래스에는 메서드가 있고, 클래스(클래스 이름!)에 대한 상수 참조가 이미 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Using Namespaces&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Text&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;#...&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;# Type Error: Text is not a class&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Action Mailer&lt;/code&gt; 에서 &lt;code class=&quot;language-text&quot;&gt;Text&lt;/code&gt; 라는 모듈 이름을 쓰고있다.&lt;/li&gt;
&lt;li&gt;따라서 다음처럼 변경하여 사용&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Hello&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Text&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;What Happens When You Call a Method?&lt;/h2&gt;
&lt;h3&gt;Method Lookup&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;수신자 ( receiver ) 와 조상 ( ancestors )의 chain&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;수신자는 메서드를 호출하는 객체이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;my_string.reverse()&lt;/code&gt; 라면 &lt;code class=&quot;language-text&quot;&gt;my_string&lt;/code&gt; 이 수신자&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;ancestors chain은 superclass로 타고 올라가는 경로&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;my_method()&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MySubclass&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MySubclass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;       &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;my_method()&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;my_method()&lt;/code&gt;를 호출하면 수신자인 &lt;code class=&quot;language-text&quot;&gt;obj&lt;/code&gt; 에서 &lt;code class=&quot;language-text&quot;&gt;MySubclass&lt;/code&gt; 로 바로 들어간다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;my_method()&lt;/code&gt;를 찾을 수 없으므로 &lt;code class=&quot;language-text&quot;&gt;MyClass&lt;/code&gt; 로 올라가서 찾고 그곳에서 &lt;code class=&quot;language-text&quot;&gt;my_method()&lt;/code&gt; ㄹㅡㄹ 찾을 수 있다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;MyClass&lt;/code&gt; 는 superclass를 지정하지 않으므로 기본 superclass에서 암시적으로 상속된다.&lt;/li&gt;
&lt;li&gt;만약 &lt;code class=&quot;language-text&quot;&gt;MyClass&lt;/code&gt; 에서도 못찾았으면 &lt;code class=&quot;language-text&quot;&gt;Object&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;BasicObject&lt;/code&gt; 로 체인을 올려서 메서드를 찾을 것 이다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token constant&quot;&gt;MySubclass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ancestors &lt;span class=&quot;token comment&quot;&gt;# =&gt; [MySubclass, MyClass, Object, Kernel, BasicObject]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Kernel&lt;/code&gt; 은 모듈이겠지 뭐&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Modules and Lookup&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;include&lt;/code&gt; 를 통해서 클래스를 모듈에 포함시킬 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M1&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&apos;M1#my_method()&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;C&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;D&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ancestors &lt;span class=&quot;token comment&quot;&gt;# =&gt; [D, C, M1, Object, Kernel, BasicObject]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;prepend&lt;/code&gt; 를 통해서 아래에 모듈을 포함 시킬수도 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;C2&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;prepend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M2&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;D2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;C2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;D2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ancestors &lt;span class=&quot;token comment&quot;&gt;# =&gt; [D2, M2, C2, Object, Kernel, BasicObject]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;만약 모듈을 여러 번 동일한 조상 체인에 포함하려고 하면?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M2&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M3&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;prepend&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M1&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;M2&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;M3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ancestors &lt;span class=&quot;token comment&quot;&gt;# =&gt; [M1, M3, M2]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;M3&lt;/code&gt; 에서 prepend를 먼저 하고 이후에 M2를 추가하지만 이미 M1이 조상들의 사슬에 있기 때문에 포함되지 않는다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;The Kernel&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;루비에는 print 같은 메서드가 있어 어느 곳에서나 호출이 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token constant&quot;&gt;Kernel&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;private_instance_methods&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;grep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;/^pr/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:printf, :print, :proc]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Object&lt;/code&gt; 클래스가 &lt;code class=&quot;language-text&quot;&gt;Kernel&lt;/code&gt;을 포함하므로 커널은 모든 오브젝트의 상위 체인에 들어간다.&lt;/li&gt;
&lt;li&gt;따라서 Ruby의 모든 줄은 항상 &lt;code class=&quot;language-text&quot;&gt;Object&lt;/code&gt; 안에서 실행되므로 &lt;code class=&quot;language-text&quot;&gt;Kernel&lt;/code&gt; 의 인스턴스 메서드를 호출할 수 있다.&lt;/li&gt;
&lt;li&gt;므찌다, 이런 커널 메서드가 실제로 유용하다는 것을 증명하기 위해 일부 라이브러리 살펴보자&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;The Awesome Print Example&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;awesome_print&quot;&lt;/span&gt;
  local_time &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:city&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Rome&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:now&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Time&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;now &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  ap local_time&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:indent&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;어디서든 &lt;code class=&quot;language-text&quot;&gt;ap&lt;/code&gt; 를 부를 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/awesome-print/awesome_print/blob/master/lib/awesome_print/core_ext/kernel.rb&quot;&gt;lib/awesome&lt;em&gt;print/core&lt;/em&gt;ext/kernel.rb&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Kernel&lt;/span&gt;
 &lt;span class=&quot;token comment&quot;&gt;#...&lt;/span&gt;
 &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;ap&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;object&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; options&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;token comment&quot;&gt;#...&lt;/span&gt;
 &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Method Execution&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;메서드를 호출하면 루비든 두 가지 일을 한다.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;메서드 찾기&lt;/li&gt;
&lt;li&gt;실행하기&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;my_method를 실행했다고 해보자&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
  temp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@x&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
  my_other_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;temp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;인스턴스 변수 @x가 속한 객체는 뭘까?&lt;/li&gt;
&lt;li&gt;어떤 객체의 my&lt;em&gt;other&lt;/em&gt;method 를 불러야 할까?&lt;/li&gt;
&lt;li&gt;직관적으로 모두 수신자에 속한다는걸 알 수 있다.&lt;/li&gt;
&lt;li&gt;하지만 루비는 직관이 없으므로 수신자에 대한 참조를 넣어둔다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;The Self Keyword&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;루비 코드의 모든 줄은 오브젝트 안에서 실행된다. ( current object 라고 함)&lt;/li&gt;
&lt;li&gt;current object는 또한 &lt;code class=&quot;language-text&quot;&gt;self&lt;/code&gt; 로 불리기도 한다. 우리가 &lt;code class=&quot;language-text&quot;&gt;self&lt;/code&gt; 로 접근이 가능함&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;testing_self&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@var&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# An instance variable of self&lt;/span&gt;
    my_method&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# Same as self.my_method()&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@var&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@var&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
obj&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;testing_self  &lt;span class=&quot;token comment&quot;&gt;# =&gt; #&amp;lt;MyClass:0x007f93ab08a728 @var=11&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;testing_self&lt;/code&gt; 를 호출하는 순간 obj는 self가 된다.&lt;/li&gt;
&lt;li&gt;@var는 obj의 인스턴스 변수이며 my_method는 obj에서 호출 된다.&lt;/li&gt;
&lt;li&gt;마지막으로 self에 대한 참조를 반환한다.&lt;/li&gt;
&lt;li&gt;따라서 루비를 잘 쓰려면 주어진 순간에 어떤 객체가 self인지를 항상 알아야 한다.&lt;/li&gt;
&lt;li&gt;어떤 객체가 마지막 메서드 수신자인지 추적 하기만 하면 된다.&lt;/li&gt;
&lt;li&gt;하지만 두가지 특별한 경우가 있음!&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;The Top Level&lt;/h4&gt;
&lt;p&gt;irb를 열고 다음처럼 쳐보면?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;        &lt;span class=&quot;token comment&quot;&gt;# =&gt; main&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# =&gt; Object&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;루비 프로그램을 시작하자 마자 루비의 인터프리터는 &lt;code class=&quot;language-text&quot;&gt;Main&lt;/code&gt;이라는 이름의 오브젝트 안에 우리를 위치시킨다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;이 오브젝트를 최상위 컨텍스트라고 부른다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;콜 스텍의 최상위 레벨에 있는 오브젝트이므로&lt;/li&gt;
&lt;li&gt;아직 메서드를 호출하지 않았거나 모든 메서드가 반환되었다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Class Definitions and self&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;self&lt;/span&gt;        &lt;span class=&quot;token comment&quot;&gt;# =&gt; MyClass&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;요약하자면&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;메서드를 호출하면 루비가 규칙에 따라 메소드를 조회한 뒤 수신자를 self로 두고 메서드를 실행한다.&lt;/li&gt;
&lt;li&gt;몇 가지 특별한&lt;/li&gt;
&lt;li&gt;경우( 모듈 포함 ) 가 있지만 예외는 없다. (하나를 제외하고)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Refinenments&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;이번 장 초반의 부분을 기억하는가?&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;String&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;to_alphanumeric&lt;/span&gt;&lt;/span&gt;
    gsub&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;/[^\w\s]/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이 변경사항은 전역적이라는 문제가 있다.&lt;/li&gt;
&lt;li&gt;모든 String 이 영향을 받고, 호환이 되지 않는 Monkeypatch라면 - &lt;code class=&quot;language-text&quot;&gt;Array#replace&lt;/code&gt; 과 같은&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Refindement&lt;/code&gt; 를 통해 해결이 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;StringExtensions&lt;/span&gt;
    refine &lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;to_alphanumeric&lt;/span&gt;&lt;/span&gt;
        gsub&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex&quot;&gt;/[^\w\s]/&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;quot;my *1st* refinement!&amp;quot;.to_alphanumeric&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;=&gt; &lt;code class=&quot;language-text&quot;&gt;NoMethodError: undefined method &amp;#39;to_alphanumeric&amp;#39; [...]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;using method를 사용해서 변경을 적용한다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;using StringExtensions&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;StringExtensions&lt;/span&gt;
  refine &lt;span class=&quot;token builtin&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;reverse&lt;/span&gt;&lt;/span&gt;
      &lt;span class=&quot;token string&quot;&gt;&quot;esrever&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;StringStuff&lt;/span&gt;
  using &lt;span class=&quot;token constant&quot;&gt;StringExtensions&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&quot;my_string&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reverse
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;my_string&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;reverse
&lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;esrever&quot;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;gnirts_ym&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Refinement는 Monkeypatches 같지만 전역적이진 않다.&lt;/li&gt;
&lt;li&gt;그러면서 일반적으로 오픈 클래스가 할 수 있는 모든 작업이 가능하다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Refinement Gotchas&lt;/h4&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;MyClass&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token string&quot;&gt;&quot;original my_method()&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;another_method&lt;/span&gt;&lt;/span&gt;
    my_method
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;MyClassRefinement&lt;/span&gt;
  refine &lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;my_method&lt;/span&gt;&lt;/span&gt;
      &lt;span class=&quot;token string&quot;&gt;&quot;refined my_method()&quot;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
using &lt;span class=&quot;token constant&quot;&gt;MyClassRefinement&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;my_method &lt;span class=&quot;token comment&quot;&gt;# =&gt;  &quot;refined my_method()&quot;&lt;/span&gt;
&lt;span class=&quot;token constant&quot;&gt;MyClass&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;another_method  &lt;span class=&quot;token comment&quot;&gt;# =&gt;  &quot;original my_method()&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;MyClass.new.my_method&lt;/code&gt; 의 호출은 using 이후지만&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;MyClass&lt;/code&gt; 의 인스턴스 메서드 &lt;code class=&quot;language-text&quot;&gt;my_method&lt;/code&gt; 의 호출은 using 이전이므로 ...&lt;/li&gt;
&lt;li&gt;직관에 조금 어긋나는 것 같다..&lt;/li&gt;
&lt;li&gt;일반 모듈에서 refine을 사용할 수 있지만 클래스 자체가 모듈인 경우에 클래스에서 이를 호출할 수 없다.&lt;/li&gt;
&lt;li&gt;또한 메서드나 조상을 아예 무시해버린다.&lt;/li&gt;
&lt;li&gt;이런 동작은 타당한 기술적 정당성을 갖고 있지만 꽤나 어렵다..&lt;/li&gt;
&lt;li&gt;refine은 몽키 패치를 제거할 수 있지만 잘 사용하는 방법을 이해하는 것은 시간이 걸린다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Wrap Up!&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;객체는 인스턴스 변수와 클래스에 대한 링크로 구성된다.&lt;/li&gt;
&lt;li&gt;객체의 메서드는 객체의 클래스에 존재한다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;클래스는 Class클래스의 오브젝트일 뿐이다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클래스의 이름은 그냥 상수임&lt;/li&gt;
&lt;li&gt;클래스는 모듈을 상속받는다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;상수는 파일 시스템과 유사하게 트리에 배열되어 있다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;모듈과 클래스의 이름은 디렉터리, 상수는 파일&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;클래스에는 클래스에서 시작하여 BasicObject로 올라가는 조상 체인이 있음&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[M Ruby - 1]]></title><description><![CDATA[회사에서 조만간 루비를 안 쓰게 될 것 같다. 루비를 보내주는 마지막 공부..... 아니면 언젠가 이직하면 레일즈를 쓰는 회사로 이직을 하게될까? Metaprogramming Ruby 아무튼 Metaprogramming Ruby…]]></description><link>https://blog.seongjun.kr/metaprogramming-ruby-1/</link><guid isPermaLink="false">https://blog.seongjun.kr/metaprogramming-ruby-1/</guid><pubDate>Thu, 01 Apr 2021 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;회사에서 조만간 루비를 안 쓰게 될 것 같다.&lt;/p&gt;
&lt;p&gt;&lt;del&gt;루비를 보내주는 마지막 공부.....&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;아니면 언젠가 이직하면 레일즈를 쓰는 회사로 이직을 하게될까?&lt;/p&gt;
&lt;h2&gt;Metaprogramming Ruby&lt;/h2&gt;
&lt;p&gt;아무튼 Metaprogramming Ruby라는 책을 읽어 보려한다. 올리는 글은 챕터별 정리와 사견&lt;/p&gt;
&lt;p&gt;되도록 우리나라에 출판된 번역본 책은 안 올리려고 하는데&lt;/p&gt;
&lt;p&gt;이 책은 번역본도 없고 깃헙에 pdf로 올라와 있어서 한번 해본다.&lt;/p&gt;
&lt;h2&gt;The M Word&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;메타 프로그래밍은 코드를 쓰는 코드이다.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;일단은 이 정도가 제일 간단한 정의이다. 자세한 얘기 이전에 먼저 프로그래밍 언어 자체에 대해 살펴본다.&lt;/p&gt;
&lt;h2&gt;유령 마을 vs 시끌시끌한 시장&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;소스 코드를 변수, 클래스, 메서드 등의 활기찬 시민들로 가득 찬 세상으로 생각해 보자&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;많은 프로그래밍 언어에서 이 시민들은 유령 같다&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;C++를 예로 들면 컴파일러가 작업을 마치면 변수나 메서드 같은 것들은 형태를 잃는다.....!&lt;/li&gt;
&lt;li&gt;런타임에서 다 사라지고 유령 같지&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;루비와 같은 언어에서 런타임은 시끌시끌한 시장 같다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;대부분의 언어 구조들이 여전히 생생하게 살아있고&lt;/li&gt;
&lt;li&gt;심지어 언어 구조까지 걸어갈 수 있고 그것에 관한 질문을 할 수도 있다.&lt;/li&gt;
&lt;li&gt;이를 &lt;code class=&quot;language-text&quot;&gt;Introspection&lt;/code&gt;이라고 한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# the_m_word/introspection.rb&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Greeting&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;text&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@text&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; text
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;welcome&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@text&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;my_object &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Greeting&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Hello&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Greeting&lt;/code&gt; 클래스를 정의하고 객체를 만들었다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;my_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;                             &lt;span class=&quot;token comment&quot;&gt;# =&gt; Greeting&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;my_object&lt;/code&gt; 에게 클래스가 뭐냐고 물어보면 확실하게 &lt;code class=&quot;language-text&quot;&gt;Greeting 이다~~~&lt;/code&gt; 라고 답해줌&lt;/li&gt;
&lt;li&gt;그럼 이제 그 클래스로부터 인스턴스 메서드의 리스트를 물어볼 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;my_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_methods&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;     &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:welcome]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;클래스는 메서드 이름을 포함하는 배열로 답을 해준다. &lt;code class=&quot;language-text&quot;&gt;[:welcome]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;false 인수는 상속받은 메서드는 나열하지 않는다는 뜻&lt;/li&gt;
&lt;li&gt;그럼 객체를 보면서 인스턴스 변수에 대해 물어보자&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;my_object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;instance_variables                &lt;span class=&quot;token comment&quot;&gt;# =&gt; [:@text]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;잘~ 답해준다.&lt;/li&gt;
&lt;li&gt;루비에서 객체와 클래스는 일급 시민( FIrst-class citizens )이기 때문에 우리는 많은 정보들을 얻을 수 있다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;-&lt;/h3&gt;
&lt;p&gt;우리는 루비에서 런타임에 언어의 구조를 읽을 수 있다 !&lt;/p&gt;
&lt;p&gt;하지만 작성하는 것은??? 프로그램이 실행되는 동안 Greeting에 새 인스턴스 메서드를 추가하려면???&lt;/p&gt;
&lt;h2&gt;메타프로그래머 이야기&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;데이터베이스에 객체를 저장하기 위한 간단한 라이브러리를 구축해보자&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;첫 번째 시도&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;각 클래스를 데이터베이스 테이블에 매핑하고 각 객체를 레코드에 매핑한다.&lt;/li&gt;
&lt;li&gt;객체를 생성하거나 그 속성에 액세스 할 때 객체는 SQL 문자열을 생성하여 데이터베이스로 보낸다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;#the_m_word/orm.rb&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Entity&lt;/span&gt;
  attr_reader &lt;span class=&quot;token symbol&quot;&gt;:table&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:ident&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;table&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ident&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@table&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; table
    &lt;span class=&quot;token variable&quot;&gt;@ident&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; ident
    &lt;span class=&quot;token constant&quot;&gt;Database&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sql &lt;span class=&quot;token string&quot;&gt;&quot;INSERT INTO &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@table&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; (id) VALUES (&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@ident&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;)&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;set&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;col&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; val&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token constant&quot;&gt;Database&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sql &lt;span class=&quot;token string&quot;&gt;&quot;UPDATE &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@table&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; SET &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;col&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;=&apos;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;val&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&apos; WHERE id=&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@ident&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;get&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;col&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token constant&quot;&gt;Database&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sql &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;SELECT &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;col&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; FROM &lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@table&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt; WHERE id=&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@ident&lt;/span&gt;&lt;span class=&quot;token delimiter tag&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;SQL을 알고있다면 읽을 만 할 듯&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Entity&lt;/code&gt;에서 id값, 테이블 이름을 갖고있고 &lt;code class=&quot;language-text&quot;&gt;Entity&lt;/code&gt;를 생성하고 나면 데이터베이스에 저장된다&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Entity#set&lt;/code&gt;은 컬럼의 값을 업데이트, &lt;code class=&quot;language-text&quot;&gt;Entity#get&lt;/code&gt;은 컬럼의 값을 갖고 온다&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Movie&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Entity&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ident&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;movies&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; ident
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;title&lt;/span&gt;&lt;/span&gt;
    get &lt;span class=&quot;token string&quot;&gt;&quot;title&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;title&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    set &lt;span class=&quot;token string&quot;&gt;&quot;title&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;director&lt;/span&gt;&lt;/span&gt;
    get &lt;span class=&quot;token string&quot;&gt;&quot;director&quot;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;director&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    set &lt;span class=&quot;token string&quot;&gt;&quot;director&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; value
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Entity&lt;/code&gt;클래스로 &lt;code class=&quot;language-text&quot;&gt;Movie&lt;/code&gt;를 정의해봤다.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Movie&lt;/code&gt; 클래스는 &lt;code class=&quot;language-text&quot;&gt;title&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;director&lt;/code&gt; 에 대한 reader , writer를 갖고있다.&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;다음과 같은 코드로 새 영화를 데이터베이스에 넣을 수 있다!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;movie &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Movie&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
movie&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Doctor Strangelove&quot;&lt;/span&gt;
movie&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;director &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Stanley Kubrick&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;이제 데이터베이스에 id가 1인 영화가 생겼다!&lt;/li&gt;
&lt;li&gt;( &lt;code class=&quot;language-text&quot;&gt;director = &amp;quot;~~~&amp;quot;&lt;/code&gt; 이 꼴은 &lt;code class=&quot;language-text&quot;&gt;director=(&amp;quot;~~~&amp;quot;)&lt;/code&gt; 이거랑 동일 )&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;하지만 중복이 많다.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;데이터베이스의 컬럼에도 &lt;code class=&quot;language-text&quot;&gt;title&lt;/code&gt;을 갖고있고, &lt;code class=&quot;language-text&quot;&gt;Movie&lt;/code&gt;클래스에도 &lt;code class=&quot;language-text&quot;&gt;@title&lt;/code&gt; 필드를 갖고있다.&lt;/p&gt;
&lt;p&gt;그리고 &lt;code class=&quot;language-text&quot;&gt;title&lt;/code&gt; 메서드를 갖고있고 두개의 &lt;code class=&quot;language-text&quot;&gt;&amp;quot;title&amp;quot;&lt;/code&gt; 문자열 상수도 있다.&lt;/p&gt;
&lt;h2&gt;메타프로그래밍 시작&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;메타프로그래밍 기반의 솔루션을 찾아보자&lt;/li&gt;
&lt;li&gt;객체를 데이터베이스 테이블에 매핑하는 ActiveRecord 라이브러리를 사용해본다.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Movie&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;Base&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;movie &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;Movie&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create
movie&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Doctor Strangelove&quot;&lt;/span&gt;
movie&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;title  &lt;span class=&quot;token comment&quot;&gt;# =&gt; &quot;Doctor Strangelove&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;이전 코드는 Movie에서 레코드를 매핑하는 객체를 만든 뒤 Movie의 title을 호출하여 접근했다.&lt;/li&gt;
&lt;li&gt;테이블에 대한 이름도 필요했다.&lt;/li&gt;
&lt;li&gt;하지만 이번 코드에선 이런 과정이 소스코드에 전혀 없다.&lt;/li&gt;
&lt;li&gt;정의하지 않은 &lt;code class=&quot;language-text&quot;&gt;title&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;title=&lt;/code&gt; 이 어떻게 존재하는 것일까?&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;ActiveRecord의 기본 작동 방식&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;테이블 이름은 간단하게 클래스의 &lt;code class=&quot;language-text&quot;&gt;introspection&lt;/code&gt; 을 통해서 규칙을 정한다.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;클래스의 이름이 &lt;code class=&quot;language-text&quot;&gt;Movie&lt;/code&gt;이므로 &lt;code class=&quot;language-text&quot;&gt;ActiveRecord&lt;/code&gt;는 이를 &lt;code class=&quot;language-text&quot;&gt;Movie&lt;/code&gt;라는 테이블에 매핑한다&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;그렇다면 객체의 속성에 접근하는 &lt;code class=&quot;language-text&quot;&gt;title=&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;title&lt;/code&gt; 같은 메서드는?? - &lt;strong&gt;여기서 메타 프로그래밍!&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;데이터베이스 스키마에서 이름을 유추하고 자동으로 정의한다.&lt;/li&gt;
&lt;li&gt;런타임에 스키마를 읽고 &lt;code class=&quot;language-text&quot;&gt;Movie&lt;/code&gt;테이블에 &lt;code class=&quot;language-text&quot;&gt;title&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;director&lt;/code&gt;라는 두 개의 컬럼을 발견&lt;/li&gt;
&lt;li&gt;동일한 이름의 두 속성에 대한 접근자 메소드를 정의한다.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;이게 바로 introspection의 음 양!! 단순히 언어의 구조를 읽는 것이 아니라 쓰기까지 하는 것&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;메타 프로그래밍은 런타임에 언어 구조를 조작하는 코드를 작성하는 것이다&lt;/li&gt;
&lt;li&gt;ActiveRecord는 이 컨셉을 적용했다.&lt;/li&gt;
&lt;li&gt;각 클래스의 특성에 대한 접근자 메소드를 작성하는 대신&lt;/li&gt;
&lt;li&gt;상속받는 클래스에 대해 런타임에 이런 메소드를 정의하는 코드를 작성했다.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;메타프로그래밍과 루비&lt;/h2&gt;
&lt;p&gt;맨 처음 유령 마을과 시끌시끌한 시장에 대해 얘기했던 게 기억나는가?&lt;/p&gt;
&lt;p&gt;언어의 구문을 조작하려면 해당 구문이 런타임에 있어야한다.&lt;/p&gt;
&lt;p&gt;몇 가지 언어들은 런타임에서 제어기능을 제공하는데 이에대해 간략히 살펴보자.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Code Generators and Compilers&lt;/p&gt;
&lt;p&gt;메타프로그래밍에서는 코드를 작성하는 코드를 작성한다. 하지만 그게 code generator와 컴파일러가 해주는 것 아닌가?&lt;/p&gt;
&lt;p&gt;예를들어 Java code를 작성하고 코드 제너레이터로 XML 설정 파일을 만들 수 있다.
넓은 의미에서 이 XML 생성은 메타프로그래밍의 한 예이다.&lt;/p&gt;
&lt;p&gt;메타프로그래밍의 또 다른 의미로, 프로그램을 사용하여 두 번째 고유 프로그램을 생성하거나 조작한 다음 두 번째 프로그램을 실행한다는 것도 있다!
( C++의 템플릿 )&lt;/p&gt;
&lt;p&gt;하지만 이 책에서는 메타프로그래밍의 다른 의미, 런타임에 스스로 조작하는 코드에 초점을 맞춘다.
Code Generator 및 Compiler의 정적 메타 프로그래밍과 구별되는 동적 메타 프로그래밍이라고 생각하면 된다.&lt;/p&gt;
&lt;p&gt;또한 많은 언어에서 동적 메타프로그래밍을 할 수 있지만 루비에서는 더 우아하고 원활하게 할 수 있다!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;C로 작성된 프로그램은 런타임에 대부분의 정보가 손실되기 때문에 메타프로그래밍이나 Introspection을 지원하지 않는다.&lt;/li&gt;
&lt;li&gt;C++에서 몇몇 언어들의 구문들은 컴파일에서 살아남기 때문에 객체와 클래스에서 사용이 가능&lt;/li&gt;
&lt;li&gt;Java에서 컴파일과 런타임은 더 모호하다. 클래스 메서드를 나열하거나 슈퍼클래스까지 올라갈 수 있는 충분한 Introspection을 제공!&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;루비는 매우 메타프로그래밍 친화적인 언어다. 컴파일 타임이 없으며 대부분의 언어 문법을 런타임에 사용 가능하다.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;작성하는 코드와 런타임의 경계가 없다.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;루비의 메타프로그래밍은 그저 전문가를 위한 모호한 예술이 아니고, ActiveRecord처럼 정교한 것을 만드는 데만 유용한 기능도 아니다&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;만약 고급 루비 코딩의 길을 가고싶다면 .... !&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;사견&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;아직까진 쉬운 내용&lt;/li&gt;
&lt;li&gt;다른 orm들도 메타프로그래밍을 쓰는 것으로 알고 있다.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[PG:ConnectionBad - could not connect to server: Connection refused]]></title><description><![CDATA[레일즈 - postgres를 사용할떄 자주 본 에러이다. 맥북 사용 시 다른 맥북 유저에 비해 맥북을 잘 꺼두는 편이였는데, 끌 때 정상적으로 종료시키지 않아서 발생하는 문제 같았다. 프로세스를 제대로 종료하지 않고 노트북이 꺼지는 바람에 pid…]]></description><link>https://blog.seongjun.kr/4-pgconnectbad/</link><guid isPermaLink="false">https://blog.seongjun.kr/4-pgconnectbad/</guid><pubDate>Wed, 24 Mar 2021 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;레일즈 - postgres를 사용할떄 자주 본 에러이다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;PG::ConnectionBad - could not connect to server: Connection refused&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.
Started GET &lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;127.0&lt;/span&gt;.0.1 at &lt;span class=&quot;token number&quot;&gt;2020&lt;/span&gt;-01-06 03:12:32 +0900

PG::ConnectionBad - could not connect to server: Connection refused
Is the server running on &lt;span class=&quot;token function&quot;&gt;host&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;localhost&quot;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;::1&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; and accepting
&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;맥북 사용 시 다른 맥북 유저에 비해 맥북을 잘 꺼두는 편이였는데, 끌 때 정상적으로 종료시키지 않아서 발생하는 문제 같았다.&lt;/p&gt;
&lt;p&gt;프로세스를 제대로 종료하지 않고 노트북이 꺼지는 바람에 pid 파일을 제대로 지우지 못한 탓이다.&lt;/p&gt;
&lt;p&gt;이미 pid파일이 있다면 postgres은 제대로 실행되지 못한다.&lt;/p&gt;
&lt;h3&gt;해결 방법&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;/usr/local/var/postgres&lt;/code&gt; 혹은 &lt;code class=&quot;language-text&quot;&gt;/usr/var/postgres&lt;/code&gt; 에서 &lt;code class=&quot;language-text&quot;&gt;postmaster.pid&lt;/code&gt; 가 존재하는지 확인
있다면 지운다
&lt;br/&gt;
&lt;code class=&quot;language-text&quot;&gt;rm postmaster.pid&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;postgresql을 재 실행 한다.
mac : &lt;code class=&quot;language-text&quot;&gt;brew services restart postgresql&lt;/code&gt;
linux : &lt;code class=&quot;language-text&quot;&gt;sudo service postgresql restart&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;</content:encoded></item><item><title><![CDATA[Ubuntu 에서 (외장) 하드디스크 사용하기 ]]></title><description><![CDATA[요즘 회사가 바빠 일하느라.. 운동하느라... 따라서 quiver…]]></description><link>https://blog.seongjun.kr/3-mount/</link><guid isPermaLink="false">https://blog.seongjun.kr/3-mount/</guid><pubDate>Tue, 23 Mar 2021 00:00:00 GMT</pubDate><content:encoded>&lt;h4&gt;요즘 회사가 바빠 일하느라.. 운동하느라...&lt;/h4&gt;
&lt;h4&gt;따라서 quiver에 몇년 간 작성해놨던 팁 노트중 짧은걸 하나 옮겨야겠다..&lt;/h4&gt;
&lt;br/&gt;
&lt;p&gt;나는 따로 남는 노트북을 서버로 사용하고있다.&lt;/p&gt;
&lt;p&gt;동영상 스트리밍 서버가 필요했고, 노트북의 용량은 그리 넉넉하지 못하며, 우분투에서 바로 동영상을 받기보단 윈도우에서 옮기는 경우가 더 많기에&lt;/p&gt;
&lt;p&gt;외장하드를 노트북에 연결해서 스트리밍서버의 저장소로 사용하기로 했다.&lt;/p&gt;
&lt;p&gt;스트리밍서버는 따로 plex라는 서비스를 사용했는데 이건 나중에 시간이 나면 글을 작성하고 ...&lt;/p&gt;
&lt;p&gt;어쩃든 외장하드를 그냥 꽂는 것 만으로는 서버에서 바로 사용할 수 있는건 아니라서 디스크를 마운트 해줬어야 했다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;fdisk&lt;/span&gt; -l&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;으로 먼저 외장하드가 마운트된 주소를 확인해본다.
&lt;span class=&apos;gatsby-resp-image-wrapper&apos; style=&apos;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 513px; margin-bottom: 16px;&apos;&gt;
      &lt;a class=&apos;gatsby-resp-image-link&apos; href=&apos;/static/c3352dde0bce7bc89bd7f58e53992daf/7fe11/1.png&apos; style=&apos;display: block&apos; target=&apos;_blank&apos; rel=&apos;noopener&apos;&gt;
    &lt;span class=&apos;gatsby-resp-image-background-image&apos; style=&quot;padding-bottom: 71.76470588235294%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACU0lEQVQ4y2VU2XLaQBDUryQEn5ziBknoRBKgCwG2wbj84ErykF9Ifr2zPYCSSh6mtnZm1Lvd0yvN9RPEqy3CuESxOWKdPmFqhIiWWyyiDbLigE35Kj29gY3JbIHxNIBhxXhsTnB7P8Ddw7AKzXHXyNVHQZgjzV9Qbk+ybvdvSBR4EBZYrnfIVM71U8ydFVbJHjMzrMD+BtUarQnaXVOFgY5uyi0Y/aGNZnsm+W7PQqM1RaszU3lHcrV6F19u9P9ANV01d3RLGvtDF4ORKwC9gXMBdkSC4diTPXu5Z57U/6WtLaICudKONA/HDxRKL8dLRDvqyTi8fkiPOY/lQNZJ3VZyNdtT3Nz1/wBaqokasSlalgJMkKI8yt5f5OChSzUUAVERqQFOjUVF+f5xVNHWeAIpUkdSGo5docObUCtqd9WQe2qr9+f4VGsLIIN6Vhryw8HIU1OLRBPqOJr4ohlr8WoHP8jVhDPpYY71MCph2UvJkfpVS81TViDlWPmOutF/rpeK70hto2y0e3pHkj3LgQSjFx03uVzgPJyHxvgMSA3pK55CEIJypR+5ssagJx1vLfVyd5J+ale70K4ou2oYfAlp9iID4U0IQNFJ72wnRzzKuOauFK8DqabcG88xMjyYbgTTjmQohhUpWoFQo+Dn0PH5snJfv+3JzbjSNgyhnNgnHMIfMJoZbCuV50UdeQuezjdOYL5repTDYp12yvKDDIWvrdUxREft6/wXkvUzvoU/UXS/o97Qlef26oOs0pB6lbs30Y5eZI3U/SATj1I2/gsoyW/K2+WqB4CFiQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;&gt;&lt;/span&gt;
  &lt;img class=&apos;gatsby-resp-image-image&apos; alt=&apos;image-20210324021023597&apos; title=&apos;image-20210324021023597&apos; src=&apos;/static/c3352dde0bce7bc89bd7f58e53992daf/7fe11/1.png&apos; srcset=&apos;/static/c3352dde0bce7bc89bd7f58e53992daf/e7570/1.png 170w,
/static/c3352dde0bce7bc89bd7f58e53992daf/f46e7/1.png 340w,
/static/c3352dde0bce7bc89bd7f58e53992daf/7fe11/1.png 513w&apos; sizes=&apos;(max-width: 513px) 100vw, 513px&apos; style=&apos;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&apos; loading=&apos;lazy&apos;&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;아래 표시된 부분의 위치를 기억하고 ,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mount&lt;/span&gt; -t ntfs-3g /dev/sdc1 ~/hdd&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;하면 끝!&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;-t ntfs-3g&lt;/code&gt; 은 &lt;code class=&quot;language-text&quot;&gt;--types&lt;/code&gt; 인데 파일시스템 타입 관련한 옵션같다. 보통 mount 커멘드는 filesystem을 감지가 가능하다고 하니 .. 필요없는거같긴하다.&lt;/p&gt;
&lt;p&gt;ext2, ext3, ext4, xfs등 여러 옵션이 있다.&lt;/p&gt;
&lt;p&gt;또한, 파일시스템에 접근하는 것은 루트퍼미션이 필요하다&lt;/p&gt;
&lt;p&gt;자세한건 &lt;code class=&quot;language-text&quot;&gt;man mount&lt;/code&gt; ㄲ&lt;/p&gt;
&lt;p&gt;마운트 된걸 언마운트 하는건 더 쉽다.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;shell&quot;&gt;&lt;pre class=&quot;language-shell&quot;&gt;&lt;code class=&quot;language-shell&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;umount&lt;/span&gt; hdd&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item></channel></rss>